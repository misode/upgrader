import{a,J as e,l as r,y as t,b as n,N as o}from"./vendor.ff4f6c89.js";const s={alert:a("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:"16",height:"16"},a("path",{"fill-rule":"evenodd",d:"M8.22 1.754a.25.25 0 00-.44 0L1.698 13.132a.25.25 0 00.22.368h12.164a.25.25 0 00.22-.368L8.22 1.754zm-1.763-.707c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0114.082 15H1.918a1.75 1.75 0 01-1.543-2.575L6.457 1.047zM9 11a1 1 0 11-2 0 1 1 0 012 0zm-.25-5.25a.75.75 0 00-1.5 0v2.5a.75.75 0 001.5 0v-2.5z"})),download:a("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:"16",height:"16"},a("path",{"fill-rule":"evenodd",d:"M7.47 10.78a.75.75 0 001.06 0l3.75-3.75a.75.75 0 00-1.06-1.06L8.75 8.44V1.75a.75.75 0 00-1.5 0v6.69L4.78 5.97a.75.75 0 00-1.06 1.06l3.75 3.75zM3.75 13a.75.75 0 000 1.5h8.5a.75.75 0 000-1.5h-8.5z"})),sync:a("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:"16",height:"16"},a("path",{"fill-rule":"evenodd",d:"M8 2.5a5.487 5.487 0 00-4.131 1.869l1.204 1.204A.25.25 0 014.896 6H1.25A.25.25 0 011 5.75V2.104a.25.25 0 01.427-.177l1.38 1.38A7.001 7.001 0 0114.95 7.16a.75.75 0 11-1.49.178A5.501 5.501 0 008 2.5zM1.705 8.005a.75.75 0 01.834.656 5.501 5.501 0 009.592 2.97l-1.204-1.204a.25.25 0 01.177-.427h3.646a.25.25 0 01.25.25v3.646a.25.25 0 01-.427.177l-1.38-1.38A7.001 7.001 0 011.05 8.84a.75.75 0 01.656-.834z"})),x:a("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:"16",height:"16"},a("path",{"fill-rule":"evenodd",d:"M3.72 3.72a.75.75 0 011.06 0L8 6.94l3.22-3.22a.75.75 0 111.06 1.06L9.06 8l3.22 3.22a.75.75 0 11-1.06 1.06L8 9.06l-3.22 3.22a.75.75 0 01-1.06-1.06L6.94 8 3.72 4.78a.75.75 0 010-1.06z"}))};var c;(c||(c={})).create=function(a,e){return{type:a,fix:e}};const l=[c.create("meta",(a=>{a.pack.pack_format=7}))],i=["dimension","dimension_type","worldgen/biome","worldgen/configured_carver","worldgen/configured_feature","worldgen/configured_structure_feature","worldgen/configured_surface_builder","worldgen/noise_settings","worldgen/processor_list","worldgen/template_pool"];var d;function p({pack:e,onError:n}){const[o,c]=r(null),[l,i]=r(null),p=`${e.name.replace(/\.zip$/,"")}_1_17.zip`;return t((()=>{(async()=>{try{await d.upgrade(e);const a=await d.toZip(e);c(a)}catch(a){n(a),i(["Error during upgrading"])}})()}),[e]),a("div",{class:"pack"},o&&a("a",{class:"pack-status download",href:o,download:p},s.download),l&&a("div",{class:"pack-status alert"},s.alert),!o&&!l&&a("div",{class:"pack-status loading"},s.sync),a("span",null,e.name.replace(/\.zip$/,"")))}function u(){const[e,t]=r([]),[o,c]=r([]),l=a=>{c([...o,{process:"upgrading",error:a}])};return a("main",{onDrop:async a=>{if(a.preventDefault(),!a.dataTransfer)return;const r=[];for(let e=0;e<a.dataTransfer.files.length;e++){const t=a.dataTransfer.files[e];t.type.match(/^application\/(x-)?zip(-compressed)?$/)&&r.push(d.fromZip(t))}if(r.length>0){const a=await Promise.all(r.map((async a=>{try{return await a}catch(e){return c([...o,{process:"loading",error:e}]),void console.error(e)}})));t([...e,...a.filter((a=>void 0!==a))])}},onDragOver:a=>a.preventDefault()},0===e.length?a(n,null,a("div",{class:"drop"},a("h1",null,"Drop data pack here"),a("p",null,"Converts from 1.16.5 to 1.17"))):a(n,null,a("div",{class:"packs"},e.map((e=>a(p,{pack:e,onError:l})))),a("div",{class:"footer"},a("p",null,"Developed by Misode"),a("p",null,"Source code on ",a("a",{href:"https://github.com/misode/upgrader",target:"_blank"},"GitHub")))),o.map((e=>{const r=`${e.error.name}: ${e.error.message}`,t=`An error occurred while ${e.process} a data pack.\nData Pack: \x3c!-- ATTACH YOUR DATAPACK HERE --\x3e\n\n\`\`\`\n${e.error.stack}\n\`\`\`\n`,n=`https://github.com/misode/upgrader/issues/new?title=${encodeURIComponent(r)}&body=${encodeURIComponent(t)}\n`;return a("div",{class:"error"},a("p",null,"Something went wrong ",e.process," the data pack:"),a("p",{class:"error-message"},e.error.message),a("p",null,"You can report this as a bug ",a("a",{href:n,target:"_blank"},"on GitHub")," and upload the data pack"),a("div",{class:"error-close",onClick:()=>c(o.filter((a=>a.error.message!==e.error.message||a.process!==e.process)))},s.x))})))}!function(a){async function r(a,e){const r=a.files[e];if(!r)throw new Error(`Cannot find "${e}"`);const t=await r.async("text");return JSON.parse(t)}function t(a,e,r){const t=JSON.stringify(r,null,2)+"\n";a.file(e,t)}a.fromZip=async function(a){const t=await a.arrayBuffer(),n=await e.loadAsync(t),o={name:a.name,data:{}};return await Promise.all(i.map((async a=>{o.data[a]=await async function(a,e){const t=new RegExp(`^data/([^/]+)/${e}/(.*).json$`);return Object.fromEntries(await Promise.all(Object.keys(a.files).map((a=>a.match(t))).filter((a=>a)).map((async e=>[`${e[1]}:${e[2]}`,await r(a,e[0])]))))}(n,a)}))),o.meta=await r(n,"pack.mcmeta"),o},a.toZip=async function(a){const r=new e;i.forEach((e=>{!function(a,e,r){Object.entries(r).forEach((([r,n])=>{const[o,s]=r.split(":");t(a,`data/${o}/${e}/${s}.json`,n)}))}(r,e,a.data[e])})),t(r,"pack.mcmeta",a.meta);const n=await r.generateAsync({type:"blob"});return URL.createObjectURL(n)},a.upgrade=async function(a){for(const e of l)"meta"===e.type?e.fix(a.meta,"pack"):Object.entries(a.data[e.type]).forEach((([a,r])=>e.fix(a,r)))}}(d||(d={}));o(a(u,null),document.body);
