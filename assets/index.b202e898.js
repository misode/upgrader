var on=Object.defineProperty,cn=Object.defineProperties;var sn=Object.getOwnPropertyDescriptors;var Ee=Object.getOwnPropertySymbols;var an=Object.prototype.hasOwnProperty,fn=Object.prototype.propertyIsEnumerable;var je=(e,n,r)=>n in e?on(e,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[n]=r,v=(e,n)=>{for(var r in n||(n={}))an.call(n,r)&&je(e,r,n[r]);if(Ee)for(var r of Ee(n))fn.call(n,r)&&je(e,r,n[r]);return e},z=(e,n)=>cn(e,sn(n));import{a as u,J as ln,d as un,s as pn,l as S,b as ge,y as Ae,c as Ne,e as _n,N as mn}from"./vendor.65c42646.js";const gn=function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))o(t);new MutationObserver(t=>{for(const f of t)if(f.type==="childList")for(const c of f.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&o(c)}).observe(document,{childList:!0,subtree:!0});function r(t){const f={};return t.integrity&&(f.integrity=t.integrity),t.referrerpolicy&&(f.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?f.credentials="include":t.crossorigin==="anonymous"?f.credentials="omit":f.credentials="same-origin",f}function o(t){if(t.ep)return;t.ep=!0;const f=r(t);fetch(t.href,f)}};gn();function G({name:e,value:n,onChange:r}){return u("label",{class:"config"},u("input",{type:"checkbox",checked:n,onChange:o=>r(o.target.checked)}),e)}const H={alert:u("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:"16",height:"16"},u("path",{"fill-rule":"evenodd",d:"M8.22 1.754a.25.25 0 00-.44 0L1.698 13.132a.25.25 0 00.22.368h12.164a.25.25 0 00.22-.368L8.22 1.754zm-1.763-.707c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0114.082 15H1.918a1.75 1.75 0 01-1.543-2.575L6.457 1.047zM9 11a1 1 0 11-2 0 1 1 0 012 0zm-.25-5.25a.75.75 0 00-1.5 0v2.5a.75.75 0 001.5 0v-2.5z"})),download:u("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:"16",height:"16"},u("path",{"fill-rule":"evenodd",d:"M7.47 10.78a.75.75 0 001.06 0l3.75-3.75a.75.75 0 00-1.06-1.06L8.75 8.44V1.75a.75.75 0 00-1.5 0v6.69L4.78 5.97a.75.75 0 00-1.06 1.06l3.75 3.75zM3.75 13a.75.75 0 000 1.5h8.5a.75.75 0 000-1.5h-8.5z"})),report:u("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:"16",height:"16"},u("path",{"fill-rule":"evenodd",d:"M1.75 1.5a.25.25 0 00-.25.25v9.5c0 .138.112.25.25.25h2a.75.75 0 01.75.75v2.19l2.72-2.72a.75.75 0 01.53-.22h6.5a.25.25 0 00.25-.25v-9.5a.25.25 0 00-.25-.25H1.75zM0 1.75C0 .784.784 0 1.75 0h12.5C15.216 0 16 .784 16 1.75v9.5A1.75 1.75 0 0114.25 13H8.06l-2.573 2.573A1.457 1.457 0 013 14.543V13H1.75A1.75 1.75 0 010 11.25v-9.5zM9 9a1 1 0 11-2 0 1 1 0 012 0zm-.25-5.25a.75.75 0 00-1.5 0v2.5a.75.75 0 001.5 0v-2.5z"})),sync:u("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:"16",height:"16"},u("path",{"fill-rule":"evenodd",d:"M8 2.5a5.487 5.487 0 00-4.131 1.869l1.204 1.204A.25.25 0 014.896 6H1.25A.25.25 0 011 5.75V2.104a.25.25 0 01.427-.177l1.38 1.38A7.001 7.001 0 0114.95 7.16a.75.75 0 11-1.49.178A5.501 5.501 0 008 2.5zM1.705 8.005a.75.75 0 01.834.656 5.501 5.501 0 009.592 2.97l-1.204-1.204a.25.25 0 01.177-.427h3.646a.25.25 0 01.25.25v3.646a.25.25 0 01-.427.177l-1.38-1.38A7.001 7.001 0 011.05 8.84a.75.75 0 01.656-.834z"})),x:u("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:"16",height:"16"},u("path",{"fill-rule":"evenodd",d:"M3.72 3.72a.75.75 0 011.06 0L8 6.94l3.22-3.22a.75.75 0 111.06 1.06L9.06 8l3.22 3.22a.75.75 0 11-1.06 1.06L8 9.06l-3.22 3.22a.75.75 0 01-1.06-1.06L6.94 8 3.72 4.78a.75.75 0 010-1.06z"}))},J=["1.16.5","1.17.1","21w44a","1.18.1","1.18.2","1.19"];var O;(e=>{e.DEFAULT_SOURCE="1.17.1",e.DEFAULT_TARGET="1.18.1";function n(c){return J.indexOf(c)}e.ord=n;function r(c,b){return n(c)<n(b)}e.order=r;function o(c,b,p,y){return n(c)<n(y)&&n(b)>n(p)}e.includes=o;function t(c,b,p,y){return n(c)<=n(y)&&n(b)>=n(p)}e.includesInclusive=t;function f(c,b){return e.includes(c,b,"1.18.2","1.19")}e.isWorkInProgress=f})(O||(O={}));var i;(e=>{function n(...m){return async(h,d)=>{for(const l of m)await l(h,d)}}e.all=n;function r(m,h){return async(d,l)=>{for(const s of d.data[m]){if(s.error||s.deleted)continue;const _=z(v({},l),{warn:g=>l.warn(g,[s.name])});try{await h(s,_)}catch(g){throw g.message=`Error fixing ${m.replace(/^worldgen\//,"").replaceAll("_"," ")} ${s.name}: ${g.message}`,g}}}}e.onFile=r;function o(...m){return async(h,d)=>{const l={},s=z(v({},d),{warn:(_,g)=>{g===void 0?l[_]=[]:g.forEach(w=>{var a;((a=l[_])!=null?a:l[_]=[]).push(w)})}});await e.all(...m)(h,s),Object.entries(l).forEach(([_,g])=>d.warn(_,[...new Set(g)]))}}e.groupProblems=o;function t(m,...h){return async(d,l)=>{l.config(m)&&await e.all(...h)(d,l)}}e.when=t;function f(m,h){return async(d,l)=>{if(!m(d,l))throw new Error(h)}}e.assert=f;function c(m,h,...d){return async(l,s)=>{O.includes(s.source(),s.target(),m,h)&&await e.all(...d)(l,s)}}e.version=c;function b(m,h,...d){return async(l,s)=>{O.includesInclusive(s.source(),s.target(),m,h)&&await e.all(...d)(l,s)}}e.versionInclusive=b;function p(m){return async()=>{console.debug(m)}}e.debug=p;function y(m){return e.all(e.assert(h=>h.meta.data.pack.pack_format<m,`This pack already has pack_format ${m} or higher and cannot be upgraded.`),e.when("packFormat",async h=>h.meta.data.pack.pack_format=m))}e.packFormat=y})(i||(i={}));const hn=i.all(i.onFile("worldgen/configured_carver",({data:e})=>me(e)),i.onFile("worldgen/biome",({data:e})=>{var n,r;typeof e.carvers=="object"&&((n=e.carvers.air)==null||n.forEach(me),(r=e.carvers.liquid)==null||r.forEach(me))}));function me(e){if(typeof e!="object")return;const n=e.type.replace(/^minecraft:/,"");e.config.lava_level={above_bottom:10},e.config.aquifers_enabled=!1,n==="cave"||n==="underwater_cave"||n==="nether_cave"?(n==="nether_cave"?e.config.y={type:"minecraft:uniform",min_inclusive:{absolute:0},max_inclusive:{below_top:1}}:e.config.y={type:"minecraft:biased_to_bottom",min_inclusive:{absolute:0},max_inclusive:{absolute:127},inner:8},e.config.yScale=.5,e.config.horizontal_radius_multiplier=1,e.config.vertical_radius_multiplier=1,e.config.floor_level=-.7):(e.config.y={type:"minecraft:biased_to_bottom",min_inclusive:{absolute:20},max_inclusive:{absolute:67},inner:8},e.config.yScale=3,e.config.vertical_rotation={type:"minecraft:uniform",value:{min_inclusive:-.125,max_exclusive:.125}},e.config.shape={distance_factor:{type:"minecraft:uniform",value:{min_inclusive:.75,max_exclusive:1}},thickness:{type:"minecraft:trapezoid",value:{min:0,max:6,plateau:2}},width_smoothness:3,horizontal_radius_factor:{type:"minecraft:uniform",value:{min_inclusive:.75,max_exclusive:1}},vertical_radius_default_factor:1,vertical_radius_center_factor:0})}const yn=i.all(i.onFile("dimension_type",({data:e})=>Ce(e)),i.onFile("dimension",({data:e})=>{typeof e.type=="object"&&Ce(e.type)}));function Ce(e){e.min_y=0,e.height=256}const dn=i.all(i.onFile("worldgen/configured_feature",({data:e},n)=>q(e,n)),i.onFile("worldgen/biome",({data:e})=>{Array.isArray(e.starts)&&e.starts.forEach(q)}));function q(e,n){if(typeof e!="object")return;switch(e.type.replace(/^minecraft:/,"")){case"basalt_columns":W(e.config,"reach"),W(e.config,"height");break;case"decorated":he(e.config.decorator,n),q(e.config.feature,n);break;case"delta_feature":W(e.config,"size"),W(e.config,"rim_size");break;case"disk":case"ice_patch":W(e.config,"radius");break;case"emerald_ore":e.type="minecraft:replace_single_block",e.config={targets:[{target:{predicate_type:"minecraft:blockstate_match",block_state:e.config.target},state:e.config.state}]};break;case"flower":case"no_bonemeal_flower":case"random_patch":const o=e.config.block_placer;o.type.replace(/^minecraft:/,"")==="column_placer"&&(o.size={type:"minecraft:uniform",value:{min_inclusive:o.min_size,max_inclusive:o.min_size+o.extra_size}},delete o.min_size,delete o.extra_size);break;case"fossil":e.config={max_empty_corners_allowed:4,fossil_processors:"minecraft:fossil_rot",overlay_processors:"minecraft:fossil_coal",fossil_structures:["minecraft:fossil/spine_1","minecraft:fossil/spine_2","minecraft:fossil/spine_3","minecraft:fossil/spine_4","minecraft:fossil/skull_1","minecraft:fossil/skull_2","minecraft:fossil/skull_3","minecraft:fossil/skull_4"],overlay_structures:["minecraft:fossil/spine_1_coal","minecraft:fossil/spine_2_coal","minecraft:fossil/spine_3_coal","minecraft:fossil/spine_4_coal","minecraft:fossil/skull_1_coal","minecraft:fossil/skull_2_coal","minecraft:fossil/skull_3_coal","minecraft:fossil/skull_4_coal"]};break;case"netherrack_replace_blobs":const t=e.config.radius;let f=typeof t=="number"?t:t.base,c=typeof t=="number"?t:t.base+t.spread;if(c>12&&(n.warn('Feature "netherrack_replace_blobs" no longer allows values above 12. Consider increasing the count of this feature.'),f=Math.min(12,f),c=Math.min(12,c)),f===c){e.config.radius=f;break}e.config.radius={type:"minecraft:uniform",value:{min_inclusive:f,max_inclusive:c}};break;case"no_surface_ore":ze(e),e.type="minecraft:ore",e.config.discard_chance_on_air_exposure=1;break;case"ore":ze(e);break;case"random_boolean_selector":q(e.config.feature_false,n),q(e.config.feature_true,n);break;case"random_selector":e.config.features.forEach(b=>q(b.feature,n)),q(e.config.default,n);break;case"sea_pickle":W(e.config,"count");break;case"simple_block":e.config.to_place={type:"minecraft:simple_state_provider",state:e.config.to_place};break;case"simple_random_selector":e.config.features.forEach(b=>q(b,n));break;case"tree":["radius","offset","crown_height","height","trunk_height"].forEach(b=>W(e.config.foliage_placer,b)),e.config.foliage_provider=e.config.leaves_provider,delete e.config.leaves_provider,e.config.force_dirt=!1,e.config.dirt_provider={type:"minecraft:simple_state_provider",state:{Name:"minecraft:dirt"}},e.config.sapling_provider={type:"minecraft:simple_state_provider",state:{Name:bn(e.config.foliage_provider),Properties:{stage:"0"}}},e.type="minecraft:decorated",e.config={decorator:{type:"decorated",config:D({type:"minecraft:water_depth_threshold",config:{max_water_depth:e.config.max_water_depth}},{type:"minecraft:heightmap",config:{heightmap:e.config.heightmap}})},feature:{type:"minecraft:tree",config:e.config}},delete e.config.feature.config.max_water_depth,delete e.config.feature.config.heightmap;break}}function W(e,n){typeof(e==null?void 0:e[n])=="object"&&(e[n]={type:"minecraft:uniform",value:{min_inclusive:e[n].base,max_inclusive:e[n].base+e[n].spread}})}function ze(e){e.config.discard_chance_on_air_exposure=0,e.config.targets=[{target:e.config.target,state:e.config.state}],delete e.config.target,delete e.config.state}function bn(e){if(e.type.replace(/^minecraft:/,"")==="simple_state_provider"){const n=e.state.Name.match(/^(?:minecraft:)?([a-z_]+)_leaves/);if(n)return`minecraft:${n[1]}_sapling`}return"minecraft:oak_sapling"}function he(e,n){if(typeof e!="object")return;const r=e.type.replace(/^minecraft:/,"");switch(r){case"carving_mask":if(e.config.probability===0){e.type="minecraft:nope",e.config={};break}const o=1/e.config.probability;e.type="minecraft:decorated",e.config=D({type:"minecraft:carving_mask",config:{step:e.config.step}},...Number.isInteger(o)?[{type:"minecraft:chance",config:{chance:o}}]:[{type:"minecraft:count_extra",config:{count:0,extra_count:1,extra_chance:e.config.probability}}]),delete e.config.probability;break;case"count":case"count_multilayer":const t=e.config.count;let f=typeof t=="number"?t:t.base,c=typeof t=="number"?t:t.base+t.spread;if(f<0&&(n.warn(`Decorator "${r}" no longer allows negative values.`),f=Math.max(0,f),c=Math.max(0,c)),f===c){e.config.count=f;break}e.config.count={type:"minecraft:uniform",value:{min_inclusive:f,max_inclusive:c}};break;case"decorated":he(e.config.outer,n),he(e.config.inner,n);break;case"heightmap_world_surface":e.type="minecraft:heightmap",e.config={heightmap:"WORLD_SURFACE_WG"};break;case"top_solid_heightmap":e.type="minecraft:heightmap",e.config={heightmap:"OCEAN_FLOOR_WG"};break;case"heightmap":case"heightmap_spread_double":e.config={heightmap:"MOTION_BLOCKING"};break;case"water_lake":e.type="minecraft:decorated",e.config=D({type:"minecraft:chance",config:{chance:e.config.chance}},{type:"minecraft:square",config:{}},{type:"minecraft:range",config:{height:{type:"minecraft:biased_to_bottom",min_inclusive:{absolute:0},max_inclusive:{absolute:256},inner:8}}});break;case"lava_lake":const b=e.config.chance/10;e.type="minecraft:decorated",e.config=D(...Number.isInteger(b)?[{type:"minecraft:chance",config:{chance:b}}]:[{type:"minecraft:count_extra",config:{count:0,extra_count:1,extra_chance:1/b}}],{type:"minecraft:square",config:{}},{type:"minecraft:range",config:{height:{type:"minecraft:biased_to_bottom",min_inclusive:{absolute:0},max_inclusive:{absolute:256},inner:8}}},{type:"minecraft:lava_lake",config:{chance:10}});break;case"fire":const p=typeof e.config.count=="number"?e.config.count:e.config.count.base+e.config.count.spread/2;e.type="minecraft:decorated",e.config=D({type:"minecraft:count",config:{count:{type:"minecraft:biased_to_bottom",value:{min_inclusive:0,max_inclusive:Math.ceil(p/2)}}}},{type:"minecraft:square",config:{}},{type:"minecraft:range",config:{height:{type:"minecraft:uniform",min_inclusive:{absolute:4},max_inclusive:{absolute:252}}}});break;case"glowstone":const y=typeof e.config.count=="number"?e.config.count:e.config.count.base+e.config.count.spread/2;e.type="minecraft:decorated",e.config=D({type:"minecraft:count",config:{count:{type:"minecraft:biased_to_bottom",value:{min_inclusive:0,max_inclusive:Math.ceil(y-1)}}}},{type:"minecraft:square",config:{}},{type:"minecraft:range",config:{height:{type:"minecraft:uniform",min_inclusive:{absolute:4},max_inclusive:{absolute:252}}}});break;case"range":const m=e.config.bottom_offset,h=e.config.bottom_offset+e.config.maximum-e.config.top_offset-1;if(m===h){e.config={height:{absolute:m}};break}e.config={height:{type:"minecraft:uniform",min_inclusive:{absolute:m},max_inclusive:{absolute:h}}};break;case"range_biased":const d=e.config.bottom_offset,l=e.config.bottom_offset+e.config.maximum-e.config.top_offset-1;e.type="minecraft:range",e.config={height:{type:"minecraft:biased_to_bottom",min_inclusive:{absolute:d},max_inclusive:{absolute:l},cutoff:d}};break;case"range_very_biased":const s=e.config.bottom_offset,_=e.config.bottom_offset+e.config.maximum-e.config.top_offset-1;e.type="minecraft:range",e.config={height:{type:"minecraft:very_biased_to_bottom",min_inclusive:{absolute:s},max_inclusive:{absolute:_},cutoff:s}};break;case"depth_average":e.type="minecraft:range",e.config={height:{type:"minecraft:trapezoid",min_inclusive:{absolute:e.config.baseline},max_inclusive:{absolute:e.config.baseline+e.config.spread}}};break;case"emerald_ore":e.type="minecraft:decorated",e.config=D({type:"minecraft:count",config:{count:{type:"minecraft:uniform",value:{min_inclusive:3,max_inclusive:8}}}},{type:"minecraft:square",config:{}},{type:"minecraft:range",config:{height:{type:"minecraft:uniform",min_inclusive:{absolute:4},max_inclusive:{absolute:31}}}});break;case"end_island":e.type="minecraft:decorated",e.config=D({type:"minecraft:chance",config:{chance:14}},{type:"minecraft:count_extra",config:{count:1,extra_count:1,extra_chance:.25}},{type:"minecraft:square",config:{}},{type:"minecraft:range",config:{height:{type:"minecraft:uniform",min_inclusive:{absolute:55},max_inclusive:{absolute:70}}}});break;case"magma":n.warn('Removed decorator "magma" previously used the sea level. Assumed sea level is 32 and replaced with a range decorator between 27 and 36.'),e.type="minecraft:range",e.config={height:{type:"minecraft:uniform",min_inclusive:{absolute:27},max_inclusive:{absolute:36}}};break}}function D(...e){return{outer:e[0],inner:e.length===2?e[1]:{type:"minecraft:decorated",config:D(...e.slice(1))}}}const vn=/replaceitem ((?:entity @[parse](\[.*\]*)?|block( [^ ]+){3}) [a-z0-9.]+) /,wn=/scoreboard objectives add ([^ ]+) (minecraft.)?custom:(minecraft.)?play_one_minute/,kn=i.onFile("functions",({data:e})=>{e.forEach((n,r)=>{(n.startsWith("replaceitem ")||n.startsWith("execute "))&&(e[r]=e[r].replace(vn,"item replace $1 with ")),(n.startsWith("scoreboard")||n.startsWith("execute"))&&(e[r]=e[r].replace(wn,"scoreboard objectives add $1 $2custom:$3play_time"))})}),xn=i.all(i.onFile("tags/blocks",({data:e})=>Se(e)),i.onFile("tags/items",({data:e})=>Se(e)));function Se(e){var n;(n=e.values)==null||n.forEach((r,o)=>$n(e.values,o))}function $n(e,n){e[n].replace(/^minecraft:/,"")==="grass_path"&&(e[n]="minecraft:dirt_path")}const Fn=i.all(i.onFile("worldgen/noise_settings",({data:e})=>Pe(e)),i.onFile("dimension",({data:e})=>{var n,r;((r=(n=e.generator)==null?void 0:n.type)==null?void 0:r.replace(/^minecraft:/,""))==="noise"&&Pe(e.generator.settings)}));function Pe(e){typeof e=="object"&&(e.bedrock_roof_position<=-10&&(e.bedrock_roof_position=-2147483648),e.bedrock_floor_position<=-10&&(e.bedrock_floor_position=-2147483648),e.min_surface_level=0,e.noise_caves_enabled=!1,e.noodle_caves_enabled=!1,e.aquifers_enabled=!1,e.deepslate_enabled=!1,e.ore_veins_enabled=!1,e.noise.min_y=0)}const En=i.all(i.onFile("predicates",({data:e})=>{Array.isArray(e)?e.forEach(te):te(e)}),i.onFile("advancements",({data:e})=>{Object.values(e.criteria).forEach(jn)}),i.onFile("loot_tables",({data:e})=>{var n;(n=e.pools)==null||n.forEach(An)}));function jn(e){var n,r;typeof e.conditions=="object"&&(E(e.conditions.entity),E(e.conditions.player),E(e.conditions.parent),E(e.conditions.partner),E(e.conditions.child),E(e.conditions.villager),E(e.conditions.zombie),E(e.conditions.projectile),E(e.conditions.shooter),(n=e.conditions.victims)==null||n.forEach(E),fe(e.conditions.item),(r=e.conditions.items)==null||r.forEach(fe),ae(e.conditions.damage),ae(e.conditions.killing_blow),ee(e.conditions.location),ee(e.conditions.entered),ee(e.conditions.exited))}function An(e){var n,r;(n=e.entries)==null||n.forEach(Ue),(r=e.conditions)==null||r.forEach(te)}function Ue(e){var n,r;(n=e.children)==null||n.forEach(Ue),(r=e.conditions)==null||r.forEach(te)}function te(e){switch(e.condition.replace(/^minecraft:/,"")){case"match_tool":fe(e.predicate);break;case"entity_properties":E(e.predicate);break;case"damage_source_properties":ae(e.predicate);break;case"location_check":ee(e.predicate);break}}function ae(e){typeof e=="object"&&(E(e.source_entity),E(e.direct_entity),ae(e.type))}function E(e){if(typeof e=="object"){if(Array.isArray(e)){e.forEach(te);return}e.equipment&&Object.values(e.equipment).forEach(fe),E(e.vehicle),E(e.targeted_entity),ee(e.location)}}function ee(e){typeof e=="object"&&Cn(e.block)}function fe(e){typeof e=="object"&&e.item&&(e.items=[e.item],delete e.item)}function Cn(e){typeof e=="object"&&e.block&&(e.blocks=[e.block],delete e.block)}const zn=i.all(i.onFile("worldgen/configured_structure_feature",({data:e})=>Te(e)),i.onFile("worldgen/biome",({data:e})=>{Array.isArray(e.starts)&&e.starts.forEach(Te)}));function Te(e){if(typeof e!="object")return;e.type.replace(/^minecraft:/,"")==="nether_fossil"&&(e.config||(e.config={}),e.config.height={type:"minecraft:uniform",min_inclusive:{absolute:32},max_inclusive:{below_top:2}})}const Sn=i.version("1.16.5","1.17.1",i.groupProblems(i.debug("1.17 fixes"),i.when("ids",xn),i.when("predicates",En),i.when("functions",kn),i.when("worldgen",yn,Fn,zn,hn,dn),i.packFormat(7))),Pn=i.all(i.onFile("worldgen/configured_feature",Rn),i.onFile("worldgen/biome",({data:e},n)=>{e.player_spawn_friendly=void 0,["air","liquid"].forEach(r=>{Array.isArray(e.carvers[r])&&(e.carvers[r]=e.carvers[r].filter(o=>!Ln.has(o.replace(/^minecraft:/,""))))}),!!Array.isArray(e.features)&&(e.features=e.features.map(r=>Array.isArray(r)?r.flatMap(o=>{if(typeof o!="string")return o;const t=Tn(o,n);return t.forEach(f=>{const c=n.read("worldgen/placed_feature",f);!c||c.data.placement.find(b=>b.type==="minecraft:biome")||c.data.placement.push({type:"minecraft:biome"})}),t}):r))}));function Tn(e,n){var o;const r=e.replace(/^minecraft:/,"");return Re.has(r)?Re.get(r).map(t=>`minecraft:${t}`):I.has(r)||Y.has(r)?[`minecraft:${(o=I.get(r))!=null?o:Y.get(r)}`]:Ge.has(r)&&n.read("worldgen/placed_feature",r)===void 0?[]:He.has(r)?[]:[e]}function Rn(e,n){if(typeof e.data!="object")return;const r=$e(e.data,n);typeof r.feature=="string"?e.data=le(We(r.feature,n)):(e.data={type:r==null?void 0:r.feature.type,config:r==null?void 0:r.feature.config},r.feature=e.name),n.create("worldgen/placed_feature",e.name,{feature:r.feature,placement:r==null?void 0:r.placement})}function le(e){return{type:"minecraft:random_selector",config:{features:[],default:e}}}function $e(e,n){var t;if(typeof e=="string"){const f=e.replace(/^minecraft:/,"");if(He.has(f))e={type:"minecraft:no_op",config:{}};else if(Je.has(f))e=le(e);else if(I.has(f)||ue.has(f)){const c=(t=ue.get(f))!=null?t:I.get(f);console.log(`Rename ${f} -> configured: ${c}`),e=`minecraft:${c}`}else if(Y.has(f)){const c=Y.get(f);console.log(`Redirect ${f} -> placed: ${c}`),e=le(c)}return{feature:e,placement:[]}}if(typeof e!="object")throw new Error("Feature is not an object nor a string");const r=e.type.replace(/^minecraft:/,""),o=[];switch(r){case"decorated":const f=Be(e,o,n);e=Dn(f,n);break;case"glow_lichen":e.config.can_be_placed_on=[...new Set(e.config.can_be_placed_on.map(c=>c.Name))];break;case"lake":e.config={fluid:{type:"minecraft:simple_state_provider",state:e.config.state},barrier:{type:"minecraft:simple_state_provider",state:{Name:"minecraft:stone"}}};break;case"nether_forest_vegetation":e.config.spread_width=8,e.config.spread_height=4;break;case"random_boolean_selector":e.config.feature_false=B(e.config.feature_false,n),e.config.feature_true=B(e.config.feature_true,n);break;case"root_system":e.config.allowed_tree_position={type:"minecraft:true"};case"random_patch":case"flower":case"no_bonemeal_flower":e.config.feature=B(e.config.feature,n);break;case"random_selector":e.config.features.forEach(c=>{c.feature=B(c.feature,n)}),e.config.default=B(e.config.default,n);break;case"simple_random_selector":e.config.features=e.config.features.map(c=>B(c,n));break;case"twisting_vines":e.config={spread_width:8,spread_height:4,max_height:8};break;case"vegetation_patch":case"waterlogged_vegetation_patch":e.config.vegetation_feature=B(e.config.vegetation_feature,n)}return{feature:e,placement:o}}function B(e,n){const r=$e(e,n);return typeof r.feature=="string"&&r.placement.length===0?We(r.feature,n):r}function We(e,n){var o;const r=e.replace(/^minecraft:/,"");if(I.has(r)||Y.has(r)){const t=(o=Y.get(r))!=null?o:I.get(r);return console.log(`Rename placement: ${r} -> ${t}`),`minecraft:${t}`}return!Ge.has(r)&&n.read("worldgen/configured_feature",r)===void 0?(console.log(`No placement: ${r}`),e):{feature:e,placement:[]}}function Dn(e,n){var o;const r=$e(e,n);if(typeof r.feature=="string"&&r.placement.length===0){const t=r.feature.replace(/^minecraft:/,"");if(I.has(t)||ue.has(t)){const f=(o=ue.get(t))!=null?o:I.get(t);return console.log(`Rename config: ${t} -> ${f}`),`minecraft:${f}`}if(Je.has(t))return le(r.feature)}return r.feature}function ye(e,n){if(typeof e!="object")return[];const r=e.type.replace(/^minecraft:/,"");switch(r){case"block_filter":return[v({type:"minecraft:block_predicate_filter"},e.config)];case"cave_surface":const o=e.config.floor_to_ceiling_search_range;o>32&&n.warn('Converting cave_surface decorator into environment_scan: "max_steps" is limited to 32.');const t={direction_of_search:e.config.surface==="ceiling"?"up":"down",target_condition:{type:"minecraft:solid"},allowed_search_condition:{type:"minecraft:matching_blocks",blocks:["minecraft:air",...e.config.allow_water?["minecraft:water"]:[]]},max_steps:Math.min(32,o)};return[v({type:"minecraft:environment_scan"},t)];case"count_multilayer":return[v({type:"minecraft:count_on_every_layer"},e.config)];case"chance":return[v({type:"minecraft:rarity_filter"},e.config)];case"count_extra":let f=e.config.count+e.config.extra_count;if(f>256){let m=[f];for(f-=1;m.some(h=>h>256);)f+=1,m=Mn(f);for(let h=2;h<=5;h+=1){const d=Array(h).fill(1),l=[...m];e:for(;l.length>0;){const s=l.pop();for(let _=0;_<h;_+=1)if(d[_]*s<=256){d[_]*=s;continue e}break}if(l.length===0&&d.every(s=>s<=256))return d.map(s=>({type:"minecraft:count",count:s}))}throw new Error(`Extremely high count: ${e.config.count+e.config.extra_count}`)}const c={type:"minecraft:weighted_list",distribution:[{weight:Math.round(100*(1-e.config.extra_chance)),data:Math.min(256,e.config.count)},{weight:Math.round(100*e.config.extra_chance),data:Math.min(256,f)}]};return[{type:"minecraft:count",count:c}];case"count_noise":return[v({type:"minecraft:noise_threshold_count"},e.config)];case"count_noise_biased":return[v({type:"minecraft:noise_based_count"},e.config)];case"dark_oak_tree":return[{type:"minecraft:count",count:16},{type:"minecraft:in_square"}];case"decorated":const b=ye(e.config.outer,n),p=ye(e.config.inner,n);return[...b,...p];case"end_gateway":return[{type:"minecraft:random_offset",xz_spread:0,y_spread:{type:"minecraft:uniform",value:{min_inclusive:3,max_inclusive:9}}}];case"iceberg":return[{type:"minecraft:in_square"}];case"lava_lake":return[{type:"minecraft:rarity_filter",chance:10}];case"nope":return[];case"range":return[v({type:"minecraft:height_range"},e.config)];case"scatter":return[v({type:"minecraft:random_offset"},e.config)];case"square":return[v({type:"minecraft:in_square"},e.config)];case"surface_relative_threshold":return[v({type:"minecraft:surface_relative_threshold_filter"},e.config)];case"water_depth_threshold":return[v({type:"minecraft:surface_water_depth_filter"},e.config)];default:return[v({type:r},e.config)]}}function Be(e,n,r){return typeof e!="object"?e:e.type.replace(/^minecraft:/,"")==="decorated"?(n.push(...ye(e.config.decorator,r)),Be(e.config.feature,n,r)):e}function Mn(e){const n=[];let r=2;for(;e>=2;)e%r==0?(n.push(r),e=e/r):r+=1;return n}const Re=new Map(Object.entries({birch_other:["forest_flowers","trees_birch_and_oak"],fossil:["fossil_upper","fossil_lower"],lake_lava:["lake_lava_surface","lake_lava_underground"],monster_room:["monster_room","monster_room_deep"],ore_granite:["ore_granite_upper","ore_granite_lower"],ore_diorite:["ore_diorite_upper","ore_diorite_lower"],ore_andesite:["ore_andesite_upper","ore_andesite_lower"],ore_coal:["ore_coal_upper","ore_coal_lower"],ore_iron:["ore_iron_upper","ore_iron_middle","ore_iron_small"],ore_gold:["ore_gold","ore_gold_lower"],ore_redstone:["ore_redstone","ore_redstone_lower"],ore_diamond:["ore_diamond","ore_diamond_large","ore_diamond_buried"],ore_lapis:["ore_lapis","ore_lapis_buried"]})),He=new Set(["lake_water","rare_dripstone_cluster","rare_small_dripstone","ore_deepslate"]),Ge=new Set(["azalea_tree","birch_bees_005","bonus_chest","cave_vine_in_moss","clay_pool_with_dripleaves","clay_with_dripleaves","dripleaf","end_gateway_delayed","huge_brown_mushroom","huge_red_mushroom","jungle_tree_no_vine","moss_patch","moss_patch_bonemeal","moss_patch_ceiling","moss_vegetation","oak_bees_005","patch_brown_mushroom","patch_red_mushroom","spring_lava_double","swamp_oak"]),Je=new Set(["patch_dead_bush_2"]),I=new Map(Object.entries({birch_other:"trees_birch_and_oak",end_gateway:"end_gateway_return",fancy_oak_bees_005:"fancy_oak_bees",flower_forest:"flower_flower_forest",forest_flower_trees:"trees_flower_forest",forest_flower_vegetation:"forest_flowers",forest_flower_vegetation_common:"flower_forest_flowers",grove_vegetation:"trees_grove",mushroom_field_vegetation:"mushroom_island_vegetation",ore_debris_large:"ore_ancient_debris_large",patch_waterlilly:"patch_waterlily",pine:"pine_checked",plain_vegetation:"trees_plains",rooted_azalea_trees:"rooted_azalea_tree",taiga_vegetation:"trees_taiga",trees_giant:"trees_old_growth_pine_taiga",trees_giant_spruce:"trees_old_growth_spruce_taiga",trees_jungle_edge:"trees_sparse_jungle",trees_mountain:"trees_windswept_hills"})),Y=new Map(Object.entries({acacia:"acacia_checked",birch:"birch_checked",brown_mushroom_giant:"brown_mushroom_old_growth",cave_vine:"cave_vines",dark_oak:"dark_oak_checked",end_island:"end_island_decorated",fancy_oak:"fancy_oak_checked",flower_plain_decorated:"flower_plains",meadow_trees:"trees_meadow",mega_jungle_tree:"mega_jungle_tree_checked",mega_pine:"mega_pine_checked",red_mushroom_giant:"red_mushroom_old_growth",patch_cactus:"patch_cactus_decorated",mega_spruce:"mega_spruce_checked",spruce:"spruce_checked",trees_mountain_edge:"trees_windswept_forest",trees_shattered_savanna:"trees_windswept_savanna"})),ue=new Map(Object.entries({mega_spruce:"mega_spruce",cave_vine:"cave_vine",crimson_fungi_planted:"crimson_fungus_planted",warped_fungi_planted:"warped_fungus_planted"})),Ln=new Set(["ocean_cave","prototype_canyon","prototype_cave","prototype_crevice","underwater_canyon","underwater_cave"]),De=["raw_generation","lakes","local_modifications","underground_structures","surface_structures","strongholds","underground_ores","underground_decoration","fluid_springs","vegetal_decoration","top_layer_modification"];async function qn(e,n){var t;const r=e.data["worldgen/biome"].filter(f=>!f.error),o=new Set;for(let f=0;f<De.length;f+=1){const c=[];for(const y of r){const m=(t=y.data.features[f])!=null?t:[];for(let h=0;h<m.length;h+=1){const d=m[h];if(c.some(s=>s.biome===y.name&&s.id===d)){o.add(y.name);continue}const l=new Set(m.slice(0,h));c.push({id:d,biome:y.name,depends:l})}}const b=[],p=c.filter(y=>c.filter(m=>y.id===m.id).every(m=>m.depends.size===0));for(;p.length>0;){const y=p.pop();if(!b.some(m=>m.id===y.id)){b.push(y);for(const m of c.filter(h=>h.depends.has(y.id)))m.depends.delete(y.id),c.filter(h=>m.id===h.id).every(h=>h.depends.size===0)&&p.push(m)}}if(c.some(y=>y.depends.size>0)){let y=function(s,_,g){if(g<=0)return!1;m.add(s.biome),h.add(s.id);for(const w of s.depends){if(w===_.id)return[_];if(!h.has(w))for(const a of c.filter(k=>k.id===w&&!m.has(k.biome))){const k=y(a,_,g-1);if(k)return[a,...k]}}return m.delete(s.biome),!1};const m=new Set,h=new Set;let d=!1;const l=c.filter(s=>s.depends.size>0);e:for(let s=2;s<10;s+=1)for(const _ of l)if(m.clear(),h.clear(),d=y(_,_,s),d)break e;if(d){const s=[`Cycle in step ${f} (${De[f]}):`];for(let _=d.length-1;_>=0;_-=1){const g=d[_],w=d[(_+1+d.length)%d.length];s.push(`\u2022 Biome ${g.biome}: '${w.id}' -> '${g.id}'`)}n.warn("!Feature order cycle found. Needs manual fixing.",[],s)}}}o.size>0&&n.warn("!Detected duplicate features. They are no longer allowed.",[...o])}const On=i.all(i.onFile("worldgen/noise_settings",({data:e})=>Me(e)),i.onFile("dimension",({data:e})=>{var n,r;((r=(n=e.generator)==null?void 0:n.type)==null?void 0:r.replace(/^minecraft:/,""))==="noise"&&Me(e.generator.settings)}));function Me(e){de(e.surface_rule)}function de(e){if(typeof e!="object")return;switch(e.type.replace(/^minecraft:/,"")){case"sequence":e.sequence.forEach(r=>de(r));break;case"condition":Ze(e.if_true),de(e.then_run)}}function Ze(e){if(typeof e!="object")return;switch(e.type.replace(/^minecraft:/,"")){case"not":Ze(e.invert);break;case"stone_depth":e.offset=0,e.add_surface_depth=e.add_run_depth,e.add_surface_secondary_depth=!1,delete e.add_run_depth;break;case"water":case"y_above":e.surface_depth_multiplier=e.run_depth_multiplier,delete e.run_depth_multiplier}}const In=i.all(i.version("21w44a","1.18.1",i.groupProblems(i.debug("1.18 fixes"),i.when("worldgen",Pn,On))),i.versionInclusive("1.18.1","1.18.1",i.when("featureCycles",i.debug("Checking feature order cycle"),qn))),Nn=i.all(i.onFile("dimension",({data:e})=>Un(e.generator)));function Un(e){if(typeof e!="object")return;switch(e.type.replace(/^minecraft:/,"")){case"flat":if(typeof e.settings!="object")return;e.settings.structure_overrides=[],delete e.settings.structures}}const Wn=i.all(i.onFile("dimension_type",({data:e})=>Le(e)),i.onFile("dimension",({data:e})=>{typeof e.type=="object"&&Le(e.type)}));function Le(e){e.infiniburn="#"+e.infiniburn}const Bn=i.all(i.onFile("worldgen/configured_feature",({data:e})=>Ye(e)),i.onFile("worldgen/placed_feature",({data:e})=>L(e)));function L(e){typeof e=="object"&&Ye(e.feature)}function Ye(e){var r;if(typeof e!="object")return;switch(e.type.replace(/^minecraft:/,"")){case"random_boolean_selector":L(e.config.feature_false),L(e.config.feature_true);break;case"random_patch":case"flower":case"no_bonemeal_flower":L(e.config.feature);break;case"random_selector":e.config.features.forEach(o=>{L(o.feature)}),L(e.config.default);break;case"simple_random_selector":e.config.features.forEach(o=>{L(o)});break;case"vegetation_patch":case"waterlogged_vegetation_patch":L(e.config.vegetation_feature),typeof e.config=="object"&&(e.config.replaceable="#"+e.config.replaceable);break;case"geode":typeof((r=e.config)==null?void 0:r.blocks)=="object"&&(e.config.blocks.cannot_replace="#"+e.config.blocks.cannot_replace,e.config.blocks.invalid_blocks="#"+e.config.blocks.invalid_blocks);break;case"root_system":typeof e.config=="object"&&(e.config.root_replaceable="#"+e.config.root_replaceable)}}const Hn=/locate (minecraft:)?(mineshaft|ocean_ruin|ruined_portal|shipwreck|village)/,Gn=i.onFile("functions",({data:e})=>{e.forEach((n,r)=>{(n.startsWith("locate ")||n.startsWith("execute "))&&(e[r]=e[r].replace(Hn,"locate #$1$2"))})}),Jn=i.all(i.onFile("worldgen/noise_settings",({data:e})=>qe(e)),i.onFile("dimension",({data:e})=>{var n,r;((r=(n=e.generator)==null?void 0:n.type)==null?void 0:r.replace(/^minecraft:/,""))==="noise"&&qe(e.generator.settings)}));function qe(e){typeof e=="object"&&(be(e.surface_rule),e.noise_router=Yn(e.aquifers_enabled,e.ore_veins_enabled,e.noise_caves_enabled,e.noodle_caves_enabled,e.noise.island_noise_override,e.noise.large_biomes),delete e.noise_caves_enabled,delete e.noodle_caves_enabled,delete e.noise.island_noise_override,delete e.noise.amplified,delete e.noise.large_biomes,delete e.structures)}function be(e){if(typeof e!="object")return;switch(e.type.replace(/^minecraft:/,"")){case"sequence":e.sequence.forEach(r=>be(r));break;case"condition":Zn(e.if_true),be(e.then_run)}}function Zn(e){if(typeof e!="object")return;switch(e.type.replace(/^minecraft:/,"")){case"stone_depth":e.secondary_depth_range=e.add_surface_secondary_depth?6:0,delete e.add_surface_secondary_depth}}function Yn(e,n,r,o,t,f){const c=t?"end":f?"overworld_large_biomes":"overworld",b=r?{max_exclusive:1.5625,when_in_range:{argument1:`minecraft:${c}/sloped_cheese`,argument2:{argument1:5,argument2:"minecraft:overworld/caves/entrances",type:"minecraft:mul"},type:"minecraft:min"},when_out_of_range:{argument1:{argument1:{argument1:{argument1:{argument1:4,argument2:{argument:{noise:"minecraft:cave_layer",xz_scale:1,y_scale:8,type:"minecraft:noise"},type:"minecraft:square"},type:"minecraft:mul"},argument2:{argument1:{input:{argument1:.27,argument2:{noise:"minecraft:cave_cheese",xz_scale:1,y_scale:.6666666666666666,type:"minecraft:noise"},type:"minecraft:add"},min:-1,max:1,type:"minecraft:clamp"},argument2:{input:{argument1:1.5,argument2:{argument1:-.64,argument2:`minecraft:${c}/sloped_cheese`,type:"minecraft:mul"},type:"minecraft:add"},min:0,max:.5,type:"minecraft:clamp"},type:"minecraft:add"},type:"minecraft:add"},argument2:"minecraft:overworld/caves/entrances",type:"minecraft:min"},argument2:{argument1:"minecraft:overworld/caves/spaghetti_2d",argument2:"minecraft:overworld/caves/spaghetti_roughness_function",type:"minecraft:add"},type:"minecraft:min"},argument2:{max_exclusive:.03,when_in_range:-1e6,when_out_of_range:"minecraft:overworld/caves/pillars",input:"minecraft:overworld/caves/pillars",min_inclusive:-1e6,type:"minecraft:range_choice"},type:"minecraft:max"},input:`minecraft:${c}/sloped_cheese`,min_inclusive:-1e6,type:"minecraft:range_choice"}:`minecraft:${c}/sloped_cheese`,p={argument:{argument1:.64,argument2:{argument:{argument:{argument:b,type:"minecraft:slide"},type:"minecraft:blend_density"},type:"minecraft:interpolated"},type:"minecraft:mul"},type:"minecraft:squeeze"};return{final_density:o?{argument1:p,argument2:"minecraft:overworld/caves/noodle",type:"minecraft:min"}:p,vein_toggle:!n||t?0:{argument:{max_exclusive:51,when_in_range:{noise:"minecraft:ore_veininess",xz_scale:1.5,y_scale:1.5,type:"minecraft:noise"},when_out_of_range:0,input:"minecraft:y",min_inclusive:-60,type:"minecraft:range_choice"},type:"minecraft:interpolated"},vein_ridged:!n||t?0:{argument1:-.07999999821186066,argument2:{argument1:{argument:{argument:{max_exclusive:51,when_in_range:{noise:"minecraft:ore_vein_a",xz_scale:4,y_scale:4,type:"minecraft:noise"},when_out_of_range:0,input:"minecraft:y",min_inclusive:-60,type:"minecraft:range_choice"},type:"minecraft:interpolated"},type:"minecraft:abs"},argument2:{argument:{argument:{max_exclusive:51,when_in_range:{noise:"minecraft:ore_vein_b",xz_scale:4,y_scale:4,type:"minecraft:noise"},when_out_of_range:0,input:"minecraft:y",min_inclusive:-60,type:"minecraft:range_choice"},type:"minecraft:interpolated"},type:"minecraft:abs"},type:"minecraft:max"},type:"minecraft:add"},vein_gap:!n||t?0:{noise:"minecraft:ore_gap",xz_scale:1,y_scale:1,type:"minecraft:noise"},erosion:t?0:`minecraft:${c}/erosion`,depth:t?0:`minecraft:${c}/depth`,ridges:t?0:"minecraft:overworld/ridges",initial_density_without_jaggedness:t?{argument:{type:"minecraft:end_islands"},type:"minecraft:cache_2d"}:{argument1:4,argument2:{argument:{argument1:`minecraft:${c}/depth`,argument2:{argument:`minecraft:${c}/factor`,type:"minecraft:cache_2d"},type:"minecraft:mul"},type:"minecraft:quarter_negative"},type:"minecraft:mul"},lava:!e||t?0:{noise:"minecraft:aquifer_lava",xz_scale:1,y_scale:1,type:"minecraft:noise"},temperature:t?0:{xz_scale:.25,y_scale:0,noise:f?"minecraft:temperature_large":"minecraft:temperature",shift_x:"minecraft:shift_x",shift_y:0,shift_z:"minecraft:shift_z",type:"minecraft:shifted_noise"},vegetation:t?0:{xz_scale:.25,y_scale:0,noise:f?"minecraft:vegetation_large":"minecraft:vegetation",shift_x:"minecraft:shift_x",shift_y:0,shift_z:"minecraft:shift_z",type:"minecraft:shifted_noise"},continents:t?0:`minecraft:${c}/continents`,barrier:!e||t?0:{noise:"minecraft:aquifer_barrier",xz_scale:1,y_scale:.5,type:"minecraft:noise"},fluid_level_floodedness:!e||t?0:{noise:"minecraft:aquifer_fluid_level_floodedness",xz_scale:1,y_scale:.67,type:"minecraft:noise"},fluid_level_spread:!e||t?0:{noise:"minecraft:aquifer_fluid_level_spread",xz_scale:1,y_scale:.7142857142857143,type:"minecraft:noise"}}}const Kn=i.all(i.onFile("predicates",({data:e})=>{Array.isArray(e)?e.forEach(ie):ie(e)}),i.onFile("advancements",({data:e})=>{Object.values(e.criteria).forEach(Xn)}),i.onFile("loot_tables",({data:e})=>{var n;(n=e.pools)==null||n.forEach(Qn)}));function Xn(e){var n;typeof e.conditions=="object"&&(j(e.conditions.entity),j(e.conditions.player),j(e.conditions.parent),j(e.conditions.partner),j(e.conditions.child),j(e.conditions.villager),j(e.conditions.zombie),j(e.conditions.projectile),j(e.conditions.shooter),(n=e.conditions.victims)==null||n.forEach(j),pe(e.conditions.damage),pe(e.conditions.killing_blow),ne(e.conditions.location),ne(e.conditions.entered),ne(e.conditions.exited))}function Qn(e){var n,r;(n=e.entries)==null||n.forEach(Ke),(r=e.conditions)==null||r.forEach(ie)}function Ke(e){var n,r;(n=e.children)==null||n.forEach(Ke),(r=e.conditions)==null||r.forEach(ie)}function ie(e){switch(e.condition.replace(/^minecraft:/,"")){case"entity_properties":j(e.predicate);break;case"damage_source_properties":pe(e.predicate);break;case"location_check":ne(e.predicate);break}}function pe(e){typeof e=="object"&&(j(e.source_entity),j(e.direct_entity),pe(e.type))}function j(e){if(typeof e=="object"){if(Array.isArray(e)){e.forEach(ie);return}j(e.vehicle),j(e.targeted_entity),ne(e.location)}}function ne(e){if(typeof e=="object"&&typeof e.feature=="string")switch(e.feature){case"endcity":e.feature="minecraft:end_city";break;default:e.feature="minecraft:"+e.feature}}const Vn=i.all(i.onFile("worldgen/processor_list",({data:e})=>Xe(e)),i.onFile("worldgen/template_pool",({data:e})=>nr(e)));function Xe(e){typeof e=="object"&&(!Array.isArray(e.processors)||e.processors.forEach(er))}function er(e){if(typeof e!="object")return;switch(e.processor_type.replace(/^minecraft:/,"")){case"protected_blocks":e.value="#"+e.value}}function nr(e){typeof e=="object"&&(!Array.isArray(e.elements)||e.elements.forEach(n=>{typeof n=="object"&&rr(n.element)}))}function rr(e){typeof e=="object"&&typeof e.processors=="object"&&Xe(e.processors)}const tr=i.all(i.onFile("worldgen/configured_structure_feature",({data:e},n)=>ir(e,n)));function ir(e,n){if(typeof e!="object")return;switch(e.type.replace(/^minecraft:/,"")){case"pillager_outpost":case"village":e.adapt_noise=!0}n.warn("Cannot upgrade configured structure features, set biomes to empty list."),e.biomes=[],e.spawn_overrides={}}const or=i.version("1.18.1","1.18.2",i.groupProblems(i.debug("1.18.2 fixes"),i.when("worldgen",Wn,Jn,Nn,tr,Vn,Bn),i.when("predicates",Kn),i.when("functions",Gn),i.packFormat(9))),cr=i.all(i.onFile("worldgen/biome",sr));function sr({data:e}){delete e.category}const ar=i.all(i.onFile("worldgen/noise_settings",({data:e})=>Oe(e)),i.onFile("dimension",({data:e})=>{var n,r;((r=(n=e.generator)==null?void 0:n.type)==null?void 0:r.replace(/^minecraft:/,""))==="noise"&&Oe(e.generator.settings)}),i.onFile("worldgen/density_function",({data:e})=>Qe(e)));function Oe(e){typeof e=="object"&&Object.values(e.noise_router).forEach(Qe)}function Qe(e){if(typeof e!="object")return;switch(e.type.replace(/^minecraft:/,"")){case"spline":delete e.min_value,delete e.max_value;break;case"terrain_shaper_spline":e.type="minecraft:spline";break}}const fr=i.all(i.onFile("dimension",({data:e})=>lr(e.generator)));function lr(e){if(typeof e!="object")return;switch(e.type.replace(/^minecraft:/,"")){case"noise":delete e.seed,ur(e.biome_source)}}function ur(e){if(typeof e!="object")return;switch(e.type.replace(/^minecraft:/,"")){case"end":delete e.seed}}const pr=i.all(i.onFile("predicates",({data:e})=>{Array.isArray(e)?e.forEach(oe):oe(e)}),i.onFile("advancements",({data:e})=>{Object.values(e.criteria).forEach(_r)}),i.onFile("loot_tables",({data:e})=>{var n;(n=e.pools)==null||n.forEach(mr)}));function _r(e){var r;if(typeof e.conditions!="object")return;switch(A(e.conditions.entity),A(e.conditions.player),A(e.conditions.parent),A(e.conditions.partner),A(e.conditions.child),A(e.conditions.villager),A(e.conditions.zombie),A(e.conditions.projectile),A(e.conditions.shooter),(r=e.conditions.victims)==null||r.forEach(A),_e(e.conditions.damage),_e(e.conditions.killing_blow),re(e.conditions.location),re(e.conditions.entered),re(e.conditions.exited),e.trigger.replace(/^minecraft:/,"")){case"location":case"slept_in_bed":case"hero_of_the_village":case"voluntary_exile":if(typeof e.conditions!="object")break;const{player:o,location:t}=e.conditions;e.conditions={player:gr(o,t)};break}}function mr(e){var n,r;(n=e.entries)==null||n.forEach(Ve),(r=e.conditions)==null||r.forEach(oe)}function Ve(e){var n,r;(n=e.children)==null||n.forEach(Ve),(r=e.conditions)==null||r.forEach(oe)}function oe(e){switch(e.condition.replace(/^minecraft:/,"")){case"entity_properties":A(e.predicate);break;case"damage_source_properties":_e(e.predicate);break;case"location_check":re(e.predicate);break}}function _e(e){typeof e=="object"&&(A(e.source_entity),A(e.direct_entity),_e(e.type))}function A(e){if(typeof e=="object"){if(Array.isArray(e)){e.forEach(oe);return}if(A(e.vehicle),A(e.targeted_entity),re(e.location),e.player)e.type_specific={type:"player",player:e.player},delete e.player;else if(e.fishing_hook)e.type_specific=v({type:"fishing_hook"},e.fishing_hook),delete e.fishing_hook;else if(e.lightning_bolt)e.type_specific=v({type:"lightning"},e.lightning_bolt),delete e.lightning_bolt;else if(e.catType){let n=e.catType.replace(/^textures\/entity\/cat\/([a-z_]+).png/,"$1");n==="british_shorthair"&&(n="british"),e.type_specific={type:"cat",variant:n},delete e.catType}}}function re(e){typeof e=="object"&&typeof e.feature=="string"&&(e.structure=e.feature,delete e.feature)}function gr(e,n){return e===void 0?{location:n}:Array.isArray(e)&&e.length>=1?[e,{type:"minecraft:entity_properties",predicate:{location:n}}]:z(v({},e),{location:v(v({},e.location),n)})}const hr=i.all(async e=>{e.data["worldgen/structure"]=e.data["worldgen/configured_structure_feature"],e.data["worldgen/configured_structure_feature"].forEach(n=>n.deleted=!0)},i.onFile("worldgen/structure_set",({data:e,name:n},r)=>dr(e,n,r)),i.onFile("worldgen/structure",({data:e})=>yr(e)));function yr(e){var r,o;if(typeof e!="object")return;const n=(r=e.type)==null?void 0:r.replace(/^minecraft:/,"");switch(n==="mineshaft"&&(e.mineshaft_type=e.config.type),Object.assign(e,e.config),delete e.config,e.step="surface_structures",delete e.probability,e.adapt_noise&&(e.terrain_adaptation=n==="stronghold"?"bury":"beard_thin",delete e.adapt_noise),n){case"bastion_remnant":e.type="minecraft:jigsaw",e.start_height={absolute:33},e.use_expansion_hack=!1;break;case"pillager_outpost":case"village":e.type="minecraft:jigsaw",e.start_height={absolute:0},e.project_start_to_heightmap="WORLD_SURFACE_WG",e.use_expansion_hack=!0;break;case"ruined_portal":const t={standard:[T({weight:.5,can_be_cold:!0,air_pocket_probability:1,mossiness:.2}),T({weight:.5,can_be_cold:!0,air_pocket_probability:.5,mossiness:.2,placement:"on_land_surface"})],desert:[T({placement:"partly_buried"})],jungle:[T({vines:!0,overgrown:!0,air_pocket_probability:.5,mossiness:.8,placement:"on_land_surface"})],mountain:[T({weight:.5,can_be_cold:!0,air_pocket_probability:.1,mossiness:.2,placement:"in_mountain"}),T({weight:.5,can_be_cold:!0,air_pocket_probability:.5,mossiness:.2,placement:"on_land_surface"})],nether:[T({replace_with_blackstone:!0,air_pocket_probability:.5,placement:"in_nether"})],ocean:[T({can_be_cold:!0,mossiness:.8,placement:"on_ocean_floor"})],swamp:[T({vines:!0,mossiness:.5,placement:"on_ocean_floor"})]};e.setups=(o=t[e.portal_type])!=null?o:[],delete e.portal_type}}function T(e={}){return v({weight:1,vines:!1,can_be_cold:!1,replace_with_blackstone:!1,placement:"underground",air_pocket_probability:0,mossiness:0,overgrown:!1},e)}function dr(e,n,r){var c,b,p;if(typeof e!="object")return;const o=(c=r.read("worldgen/structure",e.structures[0].structure))==null?void 0:c.data;if(!o)return;switch((b=o.type)==null?void 0:b.replace(/^minecraft:/,"")){case"mineshaft":e.placement.frequency_reduction_method="legacy_type_3",e.placement.frequency=o.config.probability;break}switch(n==="minecraft:pillager_outposts"&&(e.placement.exclusion_zone={other_set:"minecraft:villages",chunk_count:10},e.placement.frequency_reduction_method="legacy_type_1",e.placement.frequency=.2),(p=e.placement.type)==null?void 0:p.replace(/^minecraft:/,"")){case"concentric_rings":e.placement.salt=0,e.placement.preferred_biomes="#minecraft:stronghold_biased_to";break}}const br=i.version("1.18.2","1.19",i.groupProblems(i.debug("1.19 fixes"),i.when("worldgen",cr,fr,ar,hr),i.when("predicates",pr),i.packFormat(10))),vr=i.all(i.onFile("advancements",({data:e})=>{Object.values(e.criteria).forEach(wr)}));function wr(e){switch(e.trigger.replace(/^minecraft:/,"")){case"nether_travel":if(typeof e.conditions!="object")break;const{distance:r,entered:o,exited:t,player:f}=e.conditions;e.conditions={player:kr(f,t),start_position:o,distance:r};break}}function kr(e,n){return e===void 0?{location:n}:Array.isArray(e)&&e.length>=1?[e,{type:"minecraft:entity_properties",predicate:{location:n}}]:z(v({},e),{location:v(v({},e.location),n)})}const xr=i.all(i.onFile("worldgen/biome",$r));function $r({data:e},n){var o,t;n.warn('Biome "depth" and "scale" were removed and replaced with a more powerful terrain shaper option in noise settings. No automatic upgrade possible.'),e.depth=void 0,e.scale=void 0,n.warn('Biome "surface_builder" was removed and replaced with a more powerful surface_rule option in noise settings. No automatic upgrade possible.'),e.surface_builder=void 0,Array.isArray(e.starts)&&e.starts.length>0&&n.warn('Biome "starts" was removed, custom structures are not supported in 1.18.'),e.starts=void 0,Array.isArray(e.features)&&e.features.length>=9&&e.features.splice(8,0,[]);const r=(o=e.effects.particle)==null?void 0:o.options;((t=r==null?void 0:r.type)==null?void 0:t.replace(/minecraft:/,""))==="dust"&&r.r&&(e.effects.particle.options={type:"minecraft:dust",color:[r.r,r.g,r.b],scale:r.scale})}const Fr=i.all(i.onFile("dimension",({data:e},n)=>{var r,o;if(((o=(r=e.generator)==null?void 0:r.type)==null?void 0:o.replace(/^minecraft:/,""))==="noise"){const t=Er(e.generator.biome_source,n);ve(e.generator.settings,n,t)}}),i.onFile("worldgen/noise_settings",({data:e},n)=>{ve(e,n)}));function Er(e,n){var o;if(typeof e!="object")return[];switch(e.type.replace(/^minecraft:/,"")){case"fixed":return[e.biome];case"checkerboard":return[...new Set(e.biomes)];case"multi_noise":return e.seed=void 0,((o=e.preset)==null?void 0:o.replace(/^minecraft:/,""))==="nether"?["nether_wastes","soul_sand_valley","crimson_forest","warped_forest","basalt_deltas"]:(e.altitude_noise=void 0,e.temperature_noise=void 0,e.humidity_noise=void 0,e.weirdness_noise=void 0,e.biomes.forEach(t=>{t.parameters={temperature:t.parameters.temperature,humidity:t.parameters.humidity,continentalness:t.parameters.altitude,erosion:0,weirdness:t.parameters.weirdness,depth:0,offset:t.parameters.offset}}),[...new Set(e.biomes.map(t=>t.biome))]);case"vanilla_layered":return n.warn('Removed biome source "vanilla_layered", replaced with the multi noise overworld preset.'),e.type="multi_noise",e.preset="minecraft:overworld",[]}return[]}function ve(e,n,r=[]){if(typeof e=="string"){const t=n.read("worldgen/noise_settings",e);t&&ve(t.data,n,r);return}if(typeof e!="object"||e.surface_rule!==void 0)return;e.legacy_random_source=!1,e.noise.top_slide.target/=128,e.noise.bottom_slide.target/=128,e.min_surface_level=void 0,e.noise.simplex_surface_noise=void 0,e.noise.random_density_offset=void 0,e.noise.terrain_shaper={offset:0,factor:0,jaggedness:0},e.noise.density_offset=void 0,e.noise.density_factor=void 0;const o=[];e.bedrock_floor_position>-10&&o.push(we("vertical_gradient",{random_name:"minecraft:bedrock_floor",true_at_and_below:{above_bottom:e.bedrock_floor_position+5},false_at_and_above:{above_bottom:e.bedrock_floor_position}}).thenRun("block",{result_state:{Name:"minecraft:bedrock"}})),e.bedrock_roof_position>-10&&o.push(jr("vertical_gradient",{random_name:"minecraft:bedrock_roof",true_at_and_below:{below_top:e.bedrock_roof_position+5},false_at_and_above:{below_top:e.bedrock_roof_position}}).thenRun("block",{result_state:{Name:"minecraft:bedrock"}})),e.deepslate_enabled&&o.push(we("vertical_gradient",{random_name:"minecraft:deepslate",true_at_and_below:{absolute:0},false_at_and_above:{absolute:8}}).thenRun("block",{result_state:{Name:"minecraft:deepslate",Properties:{axis:"y"}}})),e.surface_rule={type:"minecraft:sequence",sequence:o}}function we(e,n){return{thenRun:(r,o)=>({type:"minecraft:condition",if_true:v({type:`minecraft:${e}`},n),then_run:v({type:`minecraft:${r}`},o)})}}function jr(e,n){return we("not",{invert:v({type:`minecraft:${e}`},n)})}const Ar=i.all(i.onFile("worldgen/configured_feature",({data:e},n)=>R(e,n)));function R(e,n){if(typeof e!="object")return;switch(e.type.replace(/^minecraft:/,"")){case"decorated":ke(e.config.decorator,n),R(e.config.feature,n);break;case"random_boolean_selector":R(e.config.feature_false,n),R(e.config.feature_true,n);break;case"random_selector":e.config.features.forEach(p=>R(p.feature,n)),R(e.config.default,n);break;case"simple_random_selector":e.config.features.forEach(p=>R(p,n));break;case"flower":case"no_bonemeal_flower":case"random_patch":e.config.xspread!==e.config.zspread&&n.warn("Random patch xspread and zspread can no longer be different. Using xspread.");const o=[];e.config.can_replace!==!0&&o.push({type:"minecraft:matching_blocks",blocks:["minecraft:air"]}),Q(e.config.whitelist)&&o.push({type:"minecraft:matching_blocks",offset:[0,-1,0],blocks:V(e.config.whitelist)}),Q(e.config.blacklist)&&o.push({type:"minecraft:not",predicate:{type:"minecraft:matching_blocks",offset:[0,-1,0],blocks:V(e.config.blacklist)}});const f=e.config.block_placer.type.replace(/^minecraft:/,"")==="column_placer"?{type:"minecraft:block_column",config:{direction:"up",allowed_placement:e.config.can_replace!==!0?{type:"minecraft:matching_blocks",blocks:["minecraft:air"]}:{type:"minecraft:true"},prioritize_tip:!1,layers:[{height:e.config.block_placer.size,provider:e.config.state_provider}]}}:{type:"minecraft:simple_block",config:{to_place:e.config.state_provider}};e.config={tries:e.config.tries,xz_spread:e.config.xspread,y_spread:e.config.yspread,feature:se(f,[{type:"minecraft:block_filter",config:{predicate:{type:"minecraft:all_of",predicates:o}}}])},e.config.project===!0&&(e.config={decorator:{type:"heightmap",config:{heightmap:"OCEAN_FLOOR"}},feature:{type:e.type,config:e.config}},e.type="minecraft:decorated");break;case"growing_plant":e.type="minecraft:block_column",e.config={direction:e.config.direction,allowed_placement:e.config.allow_water!==!0?{type:"minecraft:matching_blocks",blocks:["minecraft:air"]}:{type:"minecraft:true"},prioritize_tip:!0,layers:[{height:{type:"minecraft:weighted_list",distribution:e.config.height_distribution.map(p=>({weight:p.weight,data:en(p.data,-1,0,1/0)}))},provider:e.config.body_provider},{height:1,provider:e.config.head_provider}]};break;case"root_system":R(e.config.feature,n);break;case"simple_block":const c=[];Q(e.config.place_on)&&c.push({type:"minecraft:matching_blocks",offset:[0,-1,0],blocks:V(e.config.place_on)}),Q(e.config.place_in)&&c.push({type:"minecraft:matching_blocks",blocks:V(e.config.place_in)}),Q(e.config.place_under)&&c.push({type:"minecraft:matching_blocks",offset:[0,1,0],blocks:V(e.config.place_under)}),e.config.place_on=void 0,e.config.place_in=void 0,e.config.place_under=void 0,c.length>0&&(e.type="minecraft:decorated",e.config={decorator:{type:"minecraft:block_filter",config:{predicate:c.length==1?c[0]:{type:"minecraft:all_of",predicates:c}}},feature:{type:"minecraft:simple_block",config:e.config}});break;case"small_dripstone":const b=p=>se({type:"minecraft:pointed_dripstone",config:{chance_of_taller_dripstone:e.config.chance_of_taller_dripstone,chance_of_directional_spread:.7,chance_of_spread_radius2:.5,chance_of_spread_radius3:.5}},[{type:"minecraft:cave_surface",config:{surface:p,floor_to_ceiling_search_range:12,allow_water:!0}}]);e.type="minecraft:decorated",e.config=se({type:"minecraft:simple_random_selector",config:{features:[b("floor"),b("ceiling")]}},[{type:"count",config:{count:{type:"minecraft:uniform",value:{min_inclusive:1,max_inclusive:e.config.max_placements}}}},{type:"minecraft:scatter",config:{xz_spread:{type:"minecraft:clamped_normal",value:{mean:0,deviation:3,min_inclusive:-10,max_inclusive:10}},y_spread:{type:"minecraft:clamped_normal",value:{mean:0,deviation:.6,min_inclusive:-2,max_inclusive:2}}}}]).config;break;case"vegetation_patch":case"waterlogged_vegetation_patch":R(e.config.vegetation_feature,n)}}function en(e,n,r,o){if(typeof e=="number")return e+n;const t=e.type.replace(/^minecraft:/,"");switch(t){case"constant":return{type:e.type,value:Math.max(r,Math.min(o,e.value+n))};case"uniform":case"biased_to_bottom":return{type:e.type,value:{min_inclusive:Math.max(r,Math.min(o,e.value.min_inclusive+n)),max_inclusive:Math.max(r,Math.min(o,e.value.max_inclusive+n))}};case"clamped":return{type:e.type,value:{min_inclusive:Math.max(r,Math.min(o,e.value.min_inclusive+n)),max_inclusive:Math.max(r,Math.min(o,e.value.max_inclusive+n)),source:en(e.value.source,n,r,o)}}}throw new Error(`Unknown int provider "${t}"`)}function ke(e,n){if(typeof e!="object")return;switch(e.type.replace(/^minecraft:/,"")){case"decorated":ke(e.config.outer,n),ke(e.config.inner,n);break;case"cave_surface":e.config.allow_water=!1;break;case"heightmap_spread_double":n.warn('Removed decorator "heightmap_spread_double" was replaced with "heightmap". You likely need to make this feature rarer.'),e.type="minecraft:heightmap";break;case"spread_32_above":n.warn('Removed decorator "spread_32_above". You likely need to make this feature rarer.'),e.type="minecraft:nope";break}}function se(e,n=[]){return n.length==0?e:{type:"minecraft:decorated",config:{decorator:n[0],feature:se(e,n.slice(1))}}}function Q(e){return Array.isArray(e)&&e.length>0}function V(e){return[...new Set(e.map(n=>n.Name))]}const Cr=i.version("1.17.1","21w44a",i.groupProblems(i.debug("21w44a fixes"),i.when("predicates",vr),i.when("worldgen",Fr,Ar,xr),i.packFormat(8))),zr=async(e,n)=>{xe.forEach(r=>{e.data[r].filter(o=>o.error).forEach(o=>{n.warn(`!${o.error}`)})})},Sr=i.all(zr,Sn,Cr,In,or,br),xe=["advancements","dimension","dimension_type","loot_tables","predicates","tags/blocks","tags/items","tags/worldgen/biome","tags/worldgen/configured_structure_feature","worldgen/biome","worldgen/configured_carver","worldgen/configured_feature","worldgen/configured_structure_feature","worldgen/configured_surface_builder","worldgen/density_function","worldgen/noise_settings","worldgen/noise","worldgen/placed_feature","worldgen/processor_list","worldgen/structure","worldgen/structure_set","worldgen/template_pool"];var ce;(e=>{async function n(l){const s=await l.arrayBuffer(),_=await ln.loadAsync(s),g=_.filter(w=>w.endsWith("pack.mcmeta")&&!w.startsWith("__MACOSX/"));if(g.length===0)throw new Error('Cannot find any "pack.mcmeta" files.');return Promise.all(g.map(w=>{const a=w.name.replace(/\/?pack.mcmeta$/,""),k=a.length===0?l.name.replace(/\.zip$/,""):a.split("/").pop();return r(k,_.folder(a))}))}e.fromZip=n;async function r(l,s){const _={id:nn(),name:l,root:s,status:"loaded",data:{},meta:v({name:"pack"},await t(s.file("pack.mcmeta")))};return await Promise.all(xe.map(async g=>{_.data[g]=await o(s.folder("data"),g)})),_.data.functions=await f(s.folder("data")),console.log(_),_}async function o(l,s){const _=new RegExp(`([^/]+)/${s}/(.*).json$`);return Promise.all(l.filter(g=>g.match(_)!==null).map(async g=>{const w=g.name.match(_),a=`${w[1]}:${w[2]}`;try{const k=await t(g);return v({name:a},k)}catch(k){return{name:a,data:void 0,error:k.message}}}))}async function t(l){let s=await c(l);const _=un(s).indent;try{return s=s.replaceAll("\u200B","").replaceAll("\u200C","").replaceAll("\u200D","").replaceAll("\uFEFF",""),s=s.split(`
`).map(g=>g.replace(/^([^"\/]+)\/\/.*/,"$1")).join(`
`),{data:JSON.parse(pn(s)),indent:_}}catch(g){throw new Error(`Cannot parse file "${l.name}": ${g.message}.`)}}async function f(l){const s=/([^\/]+)\/functions\/(.*)\.mcfunction$/;return Promise.all(l.filter(_=>_.match(s)!==null).map(async _=>{const g=_.name.match(s);return{name:`${g[1]}:${g[2]}`,data:(await c(_)).split(`
`)}}))}async function c(l){return await l.async("text")}async function b(l){var g;if(l.status!=="upgraded")throw new Error(`Cannot download pack with status ${l.status}.`);xe.forEach(w=>{var a;p(l.root.folder("data"),w,(a=l.data[w])!=null?a:[])}),y(l.root.folder("data"),(g=l.data.functions)!=null?g:[]),m(l.root,"pack.mcmeta",l.meta.data,l.meta.indent);const s=await l.root.generateAsync({type:"blob",compression:"DEFLATE"}),_=URL.createObjectURL(s);return l.status="done",_}e.toZip=b;function p(l,s,_){_.forEach(({name:g,data:w,indent:a,error:k,deleted:x})=>{const[$,C]=g.split(":"),M=`${$}/${s}/${C}.json`;x?l.remove(M):k||m(l,M,w,a)})}function y(l,s){s.forEach(({name:_,data:g,error:w,deleted:a})=>{const[k,x]=_.split(":"),$=`${k}/functions/${x}.mcfunction`;a?l.remove($):w||h(l,$,g.join(`
`))})}function m(l,s,_,g){const w=JSON.stringify(_,null,g)+`
`;h(l,s,w)}function h(l,s,_){l.file(s,_)}async function d(l,s){if(l.status!=="loaded")throw new Error(`Cannot upgrade pack with status '${l.status}'.`);const _={warn:s.onWarning,prompt:s.onPrompt,source:()=>s.source,target:()=>s.target,config:g=>s.features[g],read:(g,w)=>l.data[g].find(a=>a.error!==void 0&&a.name.replace(/^minecraft:/,"")===w.replace(/^minecraft:/,"")),create:(g,w,a)=>{l.data[g].push({name:w,indent:l.meta.indent,data:a})}};await Sr(l,_),l.status="upgraded"}e.upgrade=d})(ce||(ce={}));const Pr=e=>("0"+e.toString(16)).substr(-2);function nn(e=12){var n=new Uint8Array(e/2);return window.crypto.getRandomValues(n),Array.from(n,Pr).join("")}function Tr({pack:e,config:n,source:r,target:o,onError:t,onRemove:f,onDone:c,doDownload:b}){var Fe;const[p,y]=S("Loading..."),[m,h]=S(null),[d,l]=S([]),[s,_]=S(null),[g,w]=S(!1),[a,k]=S(null),x=ge(null),$=ge(()=>{}),C=`${e.name}_${o}.zip`,M=(F,N,P,U)=>(k({title:F,message:N,actions:P!=null?P:["Confirm"],info:U}),new Promise(rn=>{$.current=tn=>{k(null),rn(tn)}})),K=(F,N,P)=>{setTimeout(()=>l(U=>[...U,{message:F,files:N,info:P}]))};Ae(()=>{(async()=>{try{y("Upgrading..."),await ce.upgrade(e,{features:n,source:r,target:o,onPrompt:M,onWarning:K}),y("Zipping...");const F=await ce.toZip(e);h(F),c()}catch(F){t(F),_("Error during upgrading")}})()},[e]);const X=()=>{w(!g)};return Ae(()=>{b&&x.current.click()},[b]),u("div",{class:"pack"},u("div",{class:"pack-head"},m&&u("a",{class:"pack-status download",ref:x,href:m,download:C,"data-hover":`Download data pack for ${o}`},H.download),!m&&!s&&!a&&u("div",{class:"pack-status loading","data-hover":p},H.sync),!m&&!s&&a&&u("div",{class:"pack-status prompt","data-hover":"Manual action required"},H.report),(d.length>0||s)&&u("div",{class:`pack-status alert${s?" error":""}`,onClick:X,"data-hover":s!=null?s:"There were issues upgrading"},H.alert),u("span",{class:"pack-name"},e.name.replace(/\.zip$/,"")),u("div",{class:"pack-status remove",onClick:f},H.x)),(a||d.length>0&&!g)&&u("div",{class:"pack-body"},a&&u("div",{class:"pack-prompt"},u("p",{class:"prompt-title"},a.title),a.message&&u("p",{class:"prompt-message"},a.message),u("p",null,a.actions.map(F=>u("button",{onClick:()=>$.current(F)},F))),(Fe=a.info)==null?void 0:Fe.map(F=>u("p",{class:"prompt-info"},F))),d.length>0&&!g&&d.map(({message:F,files:N,info:P})=>u("div",{class:"pack-alert"},u("div",{class:`alert-message ${F.startsWith("!")?"alert-error":""}`},F.replace(/\!/,"")),N&&N.length>0&&u(Ne,null,u("p",null,"Affected files:"),u("div",{class:"alert-files"},N.map(U=>u("p",null,U)))),P==null?void 0:P.map(U=>u("p",{class:"alert-info"},U))))))}function Ie({value:e,onChange:n}){const r=ge(null);return u("select",{class:"version-picker",ref:r,value:e,onChange:()=>{n(r.current.value)}},J.map(t=>u("option",{value:t},t)))}var Z;(e=>{const n="misode_upgrader_config";function r(){var p;return JSON.parse((p=localStorage.getItem(n))!=null?p:"{}")}function o(p){const y=v(v({},r()),p);localStorage.setItem(n,JSON.stringify(y))}function t(){const p=new URLSearchParams(location.search).get("from");if(p&&J.includes(p))return p;const y=r().source;return y&&J.includes(y)?y:O.DEFAULT_SOURCE}e.getSource=t;function f(p){o({source:p})}e.setSource=f;function c(){const p=new URLSearchParams(location.search).get("to");if(p&&J.includes(p))return p;const y=r().target;return y&&J.includes(y)?y:O.DEFAULT_TARGET}e.getTarget=c;function b(p){o({target:p})}e.setTarget=b})(Z||(Z={}));function Rr(){const[e,n]=S([]),[r,o]=S([]),[t,f]=S(Z.getSource()),[c,b]=S(Z.getTarget()),[p,y]=S({functions:!0,ids:!0,predicates:!0,worldgen:!0,packFormat:!0,featureCycles:!0}),m=a=>{Z.setSource(a),f(a)},h=a=>{Z.setTarget(a),b(a)},d=(a,k)=>{const x=nn(),$=k.stack.split(`
`).map(C=>C.replace(/^(\s+)at (?:async )?(https?:.*)/,"$1at ($2)"));_n.exports.mapStackTrace($.join(`
`),C=>{const M=$[0]+`
`+C.map(K=>K.replace(/..\/..\/src\//,"src/")).join(`
`);o(K=>K.map(X=>X.id===x?z(v({},X),{stacktrace:M}):X))}),o([...r,{id:x,process:a,error:k}])},l=async a=>{if(a.preventDefault(),!a.dataTransfer)return;const k=[];for(let x=0;x<a.dataTransfer.files.length;x++){const $=a.dataTransfer.files[x];$.type.match(/^application\/(x-)?zip(-compressed)?$/)&&k.push(ce.fromZip($))}if(k.length===0)d("loading",new Error("The dropped files contain no zip files. Please zip the data pack first."));else{const x=await Promise.all(k.map(async $=>{try{return await $}catch(C){d("loading",C),console.error(C);return}}));n([...e,...x.flat().filter($=>$!==void 0)])}},s=a=>{console.error(a),d("upgrading",a)},_=a=>{n(k=>k.filter(x=>x.id!==a))},[g,w]=S(0);return u("main",{onDrop:l,onDragOver:a=>a.preventDefault()},e.length>0&&u(Ne,null,u("div",{class:"packs"},e.map(a=>u(Tr,{key:a.id,pack:a,config:p,source:t,target:c,doDownload:g,onError:s,onRemove:()=>_(a.id),onDone:()=>n([...e])})),e.filter(a=>a.status==="done").length>1&&u("button",{class:"download-all",onClick:()=>w(g+1)},H.download,u("span",null,"Download all")))),u("div",{class:"drop"},u("h1",null,"Drop data pack here"),u("p",null,"Convert from ",u(Ie,{value:t,onChange:m})," to ",u(Ie,{value:c,onChange:h})),O.order(c,t)?u("p",{class:"error-message"},"Invalid version range"):O.isWorkInProgress(t,c)?u("p",{class:"warning-message"},"This upgrade is still being worked on"):null),u("div",{class:"configs"},u(G,{name:"Upgrade functions",value:p.functions,onChange:a=>y(z(v({},p),{functions:a}))}),u(G,{name:"Upgrade IDs",value:p.ids,onChange:a=>y(z(v({},p),{ids:a}))}),u(G,{name:"Upgrade JSON files",value:p.predicates,onChange:a=>y(z(v({},p),{predicates:a}))}),u(G,{name:"Upgrade worldgen",value:p.worldgen,onChange:a=>y(z(v({},p),{worldgen:a}))}),u(G,{name:"Upgrade pack_format",value:p.packFormat,onChange:a=>y(z(v({},p),{packFormat:a}))}),u(G,{name:"Detect feature cycles",value:p.featureCycles,onChange:a=>y(z(v({},p),{featureCycles:a}))})),u("div",{class:"footer"},u("p",null,"Developed by Misode"),u("p",null,"Source code on ",u("a",{href:"https://github.com/misode/upgrader",target:"_blank"},"GitHub"))),u("div",{class:"main-errors"},r.map(a=>{var C;const k=`${a.error.name}: ${a.error.message}`,x=`An error occurred while ${a.process} a data pack.
Data Pack: <!-- ATTACH YOUR DATAPACK HERE -->

\`\`\`
${(C=a.stacktrace)!=null?C:a.error.stack}
\`\`\`
`,$=`https://github.com/misode/upgrader/issues/new?title=${encodeURIComponent(k)}&body=${encodeURIComponent(x)}
`;return u("div",{class:"main-error"},u("p",null,"Something went wrong ",a.process," the data pack:"),u("p",{class:"error-message"},a.error.message),u("p",null,"You can report this as a bug ",u("a",{href:$,target:"_blank"},"on GitHub")," and upload the data pack"),u("div",{class:"error-close",onClick:()=>o(r.filter(M=>M.id!==a.id))},H.x))})))}mn(u(Rr,null),document.body);
//# sourceMappingURL=index.b202e898.js.map
