var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,n=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,i=(t,a,n)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[a]=n,c=(e,t)=>{for(var a in t||(t={}))r.call(t,a)&&i(e,a,t[a]);if(n)for(var a of n(t))o.call(t,a)&&i(e,a,t[a]);return e},s=(e,n)=>t(e,a(n));import{a as l,J as f,d as u,s as d,l as _,b as p,y as m,c as g,e as h,N as v}from"./vendor.f0c15f77.js";function b({name:e,value:t,onChange:a}){return l("label",{class:"config"},l("input",{type:"checkbox",checked:t,onChange:e=>a(e.target.checked)}),e)}const y={alert:l("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:"16",height:"16"},l("path",{"fill-rule":"evenodd",d:"M8.22 1.754a.25.25 0 00-.44 0L1.698 13.132a.25.25 0 00.22.368h12.164a.25.25 0 00.22-.368L8.22 1.754zm-1.763-.707c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0114.082 15H1.918a1.75 1.75 0 01-1.543-2.575L6.457 1.047zM9 11a1 1 0 11-2 0 1 1 0 012 0zm-.25-5.25a.75.75 0 00-1.5 0v2.5a.75.75 0 001.5 0v-2.5z"})),download:l("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:"16",height:"16"},l("path",{"fill-rule":"evenodd",d:"M7.47 10.78a.75.75 0 001.06 0l3.75-3.75a.75.75 0 00-1.06-1.06L8.75 8.44V1.75a.75.75 0 00-1.5 0v6.69L4.78 5.97a.75.75 0 00-1.06 1.06l3.75 3.75zM3.75 13a.75.75 0 000 1.5h8.5a.75.75 0 000-1.5h-8.5z"})),report:l("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:"16",height:"16"},l("path",{"fill-rule":"evenodd",d:"M1.75 1.5a.25.25 0 00-.25.25v9.5c0 .138.112.25.25.25h2a.75.75 0 01.75.75v2.19l2.72-2.72a.75.75 0 01.53-.22h6.5a.25.25 0 00.25-.25v-9.5a.25.25 0 00-.25-.25H1.75zM0 1.75C0 .784.784 0 1.75 0h12.5C15.216 0 16 .784 16 1.75v9.5A1.75 1.75 0 0114.25 13H8.06l-2.573 2.573A1.457 1.457 0 013 14.543V13H1.75A1.75 1.75 0 010 11.25v-9.5zM9 9a1 1 0 11-2 0 1 1 0 012 0zm-.25-5.25a.75.75 0 00-1.5 0v2.5a.75.75 0 001.5 0v-2.5z"})),sync:l("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:"16",height:"16"},l("path",{"fill-rule":"evenodd",d:"M8 2.5a5.487 5.487 0 00-4.131 1.869l1.204 1.204A.25.25 0 014.896 6H1.25A.25.25 0 011 5.75V2.104a.25.25 0 01.427-.177l1.38 1.38A7.001 7.001 0 0114.95 7.16a.75.75 0 11-1.49.178A5.501 5.501 0 008 2.5zM1.705 8.005a.75.75 0 01.834.656 5.501 5.501 0 009.592 2.97l-1.204-1.204a.25.25 0 01.177-.427h3.646a.25.25 0 01.25.25v3.646a.25.25 0 01-.427.177l-1.38-1.38A7.001 7.001 0 011.05 8.84a.75.75 0 01.656-.834z"})),x:l("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:"16",height:"16"},l("path",{"fill-rule":"evenodd",d:"M3.72 3.72a.75.75 0 011.06 0L8 6.94l3.22-3.22a.75.75 0 111.06 1.06L9.06 8l3.22 3.22a.75.75 0 11-1.06 1.06L8 9.06l-3.22 3.22a.75.75 0 01-1.06-1.06L6.94 8 3.72 4.78a.75.75 0 010-1.06z"}))},w=["1.16.5","1.17.1","21w44a","1.18"];var k,x,E;!function(e){function t(e){return w.indexOf(e)}e.DEFAULT_SOURCE="1.17.1",e.DEFAULT_TARGET="1.18",e.ord=t,e.order=function(e,a){return t(e)<t(a)},e.includes=function(e,a,n,r){return t(e)<t(r)&&t(a)>t(n)},e.includesInclusive=function(e,a,n,r){return t(e)<=t(r)&&t(a)>=t(n)}}(k||(k={})),(E=x||(x={})).all=function(...e){return async(t,a)=>{for(const n of e)await n(t,a)}},E.onFile=function(e,t){return async(a,n)=>{for(const o of a.data[e]){const a=s(c({},n),{warn:e=>n.warn(e,[o.name])});try{await t(o,a)}catch(r){throw r.message=`Error fixing ${e.replace(/^worldgen\//,"").replaceAll("_"," ")} ${o.name}: ${r.message}`,r}}}},E.groupProblems=function(...e){return async(t,a)=>{const n={},r=s(c({},a),{warn:(e,t)=>{void 0===t?n[e]=[]:t.forEach((t=>{var a;(null!=(a=n[e])?a:n[e]=[]).push(t)}))}});await E.all(...e)(t,r),Object.entries(n).forEach((([e,t])=>a.warn(e,[...new Set(t)])))}},E.when=function(e,...t){return async(a,n)=>{n.config(e)&&await E.all(...t)(a,n)}},E.assert=function(e,t){return async(a,n)=>{if(!e(a,n))throw new Error(t)}},E.version=function(e,t,...a){return async(n,r)=>{k.includes(r.source(),r.target(),e,t)&&await E.all(...a)(n,r)}},E.versionInclusive=function(e,t,...a){return async(n,r)=>{k.includesInclusive(r.source(),r.target(),e,t)&&await E.all(...a)(n,r)}},E.debug=function(e){return async()=>{console.debug(e)}};const $=x.all(x.onFile("worldgen/configured_carver",(({data:e})=>A(e))),x.onFile("worldgen/biome",(({data:e})=>{var t,a;"object"==typeof e.carvers&&(null==(t=e.carvers.air)||t.forEach(A),null==(a=e.carvers.liquid)||a.forEach(A))})));function A(e){if("object"!=typeof e)return;const t=e.type.replace(/^minecraft:/,"");e.config.lava_level={above_bottom:10},e.config.aquifers_enabled=!1,"cave"===t||"underwater_cave"===t||"nether_cave"===t?(e.config.y="nether_cave"===t?{type:"minecraft:uniform",min_inclusive:{absolute:0},max_inclusive:{below_top:1}}:{type:"minecraft:biased_to_bottom",min_inclusive:{absolute:0},max_inclusive:{absolute:127},inner:8},e.config.yScale=.5,e.config.horizontal_radius_multiplier=1,e.config.vertical_radius_multiplier=1,e.config.floor_level=-.7):(e.config.y={type:"minecraft:biased_to_bottom",min_inclusive:{absolute:20},max_inclusive:{absolute:67},inner:8},e.config.yScale=3,e.config.vertical_rotation={type:"minecraft:uniform",value:{min_inclusive:-.125,max_exclusive:.125}},e.config.shape={distance_factor:{type:"minecraft:uniform",value:{min_inclusive:.75,max_exclusive:1}},thickness:{type:"minecraft:trapezoid",value:{min:0,max:6,plateau:2}},width_smoothness:3,horizontal_radius_factor:{type:"minecraft:uniform",value:{min_inclusive:.75,max_exclusive:1}},vertical_radius_default_factor:1,vertical_radius_center_factor:0})}const j=x.all(x.onFile("dimension_type",(({data:e})=>z(e))),x.onFile("dimension",(({data:e})=>{"object"==typeof e.type&&z(e.type)})));function z(e){e.min_y=0,e.height=256}const C=x.all(x.onFile("worldgen/configured_feature",(({data:e},t)=>F(e,t))),x.onFile("worldgen/biome",(({data:e})=>{Array.isArray(e.starts)&&e.starts.forEach(F)})));function F(e,t){if("object"!=typeof e)return;switch(e.type.replace(/^minecraft:/,"")){case"basalt_columns":M(e.config,"reach"),M(e.config,"height");break;case"decorated":R(e.config.decorator,t),F(e.config.feature,t);break;case"delta_feature":M(e.config,"size"),M(e.config,"rim_size");break;case"disk":case"ice_patch":M(e.config,"radius");break;case"emerald_ore":e.type="minecraft:replace_single_block",e.config={targets:[{target:{predicate_type:"minecraft:blockstate_match",block_state:e.config.target},state:e.config.state}]};break;case"flower":case"no_bonemeal_flower":case"random_patch":const a=e.config.block_placer;"column_placer"===a.type.replace(/^minecraft:/,"")&&(a.size={type:"minecraft:uniform",value:{min_inclusive:a.min_size,max_inclusive:a.min_size+a.extra_size}},delete a.min_size,delete a.extra_size);break;case"fossil":e.config={max_empty_corners_allowed:4,fossil_processors:"minecraft:fossil_rot",overlay_processors:"minecraft:fossil_coal",fossil_structures:["minecraft:fossil/spine_1","minecraft:fossil/spine_2","minecraft:fossil/spine_3","minecraft:fossil/spine_4","minecraft:fossil/skull_1","minecraft:fossil/skull_2","minecraft:fossil/skull_3","minecraft:fossil/skull_4"],overlay_structures:["minecraft:fossil/spine_1_coal","minecraft:fossil/spine_2_coal","minecraft:fossil/spine_3_coal","minecraft:fossil/spine_4_coal","minecraft:fossil/skull_1_coal","minecraft:fossil/skull_2_coal","minecraft:fossil/skull_3_coal","minecraft:fossil/skull_4_coal"]};break;case"netherrack_replace_blobs":const n=e.config.radius;let r="number"==typeof n?n:n.base,o="number"==typeof n?n:n.base+n.spread;if(o>12&&(t.warn('Feature "netherrack_replace_blobs" no longer allows values above 12. Consider increasing the count of this feature.'),r=Math.min(12,r),o=Math.min(12,o)),r===o){e.config.radius=r;break}e.config.radius={type:"minecraft:uniform",value:{min_inclusive:r,max_inclusive:o}};break;case"no_surface_ore":O(e),e.type="minecraft:ore",e.config.discard_chance_on_air_exposure=1;break;case"ore":O(e);break;case"random_boolean_selector":F(e.config.feature_false,t),F(e.config.feature_true,t);break;case"random_selector":e.config.features.forEach((e=>F(e.feature,t))),F(e.config.default,t);break;case"sea_pickle":M(e.config,"count");break;case"simple_block":e.config.to_place={type:"minecraft:simple_state_provider",state:e.config.to_place};break;case"simple_random_selector":e.config.features.forEach((e=>F(e,t)));break;case"tree":["radius","offset","crown_height","height","trunk_height"].forEach((t=>M(e.config.foliage_placer,t))),e.config.foliage_provider=e.config.leaves_provider,delete e.config.leaves_provider,e.config.force_dirt=!1,e.config.dirt_provider={type:"minecraft:simple_state_provider",state:{Name:"minecraft:dirt"}},e.config.sapling_provider={type:"minecraft:simple_state_provider",state:{Name:S(e.config.foliage_provider),Properties:{stage:"0"}}},e.type="minecraft:decorated",e.config={decorator:{type:"decorated",config:T({type:"minecraft:water_depth_threshold",config:{max_water_depth:e.config.max_water_depth}},{type:"minecraft:heightmap",config:{heightmap:e.config.heightmap}})},feature:{type:"minecraft:tree",config:e.config}},delete e.config.feature.config.max_water_depth,delete e.config.feature.config.heightmap}}function M(e,t){"object"==typeof(null==e?void 0:e[t])&&(e[t]={type:"minecraft:uniform",value:{min_inclusive:e[t].base,max_inclusive:e[t].base+e[t].spread}})}function O(e){e.config.discard_chance_on_air_exposure=0,e.config.targets=[{target:e.config.target,state:e.config.state}],delete e.config.target,delete e.config.state}function S(e){if("simple_state_provider"===e.type.replace(/^minecraft:/,"")){const t=e.state.Name.match(/^(?:minecraft:)?([a-z_]+)_leaves/);if(t)return`minecraft:${t[1]}_sapling`}return"minecraft:oak_sapling"}function R(e,t){if("object"!=typeof e)return;const a=e.type.replace(/^minecraft:/,"");switch(a){case"carving_mask":if(0===e.config.probability){e.type="minecraft:nope",e.config={};break}const n=1/e.config.probability;e.type="minecraft:decorated",e.config=T({type:"minecraft:carving_mask",config:{step:e.config.step}},...Number.isInteger(n)?[{type:"minecraft:chance",config:{chance:n}}]:[{type:"minecraft:count_extra",config:{count:0,extra_count:1,extra_chance:e.config.probability}}]),delete e.config.probability;break;case"count":case"count_multilayer":const r=e.config.count;let o="number"==typeof r?r:r.base,i="number"==typeof r?r:r.base+r.spread;if(o<0&&(t.warn(`Decorator "${a}" no longer allows negative values.`),o=Math.max(0,o),i=Math.max(0,i)),o===i){e.config.count=o;break}e.config.count={type:"minecraft:uniform",value:{min_inclusive:o,max_inclusive:i}};break;case"decorated":R(e.config.outer,t),R(e.config.inner,t);break;case"heightmap_world_surface":e.type="minecraft:heightmap",e.config={heightmap:"WORLD_SURFACE_WG"};break;case"top_solid_heightmap":e.type="minecraft:heightmap",e.config={heightmap:"OCEAN_FLOOR_WG"};break;case"heightmap":case"heightmap_spread_double":e.config={heightmap:"MOTION_BLOCKING"};break;case"water_lake":e.type="minecraft:decorated",e.config=T({type:"minecraft:chance",config:{chance:e.config.chance}},{type:"minecraft:square",config:{}},{type:"minecraft:range",config:{height:{type:"minecraft:biased_to_bottom",min_inclusive:{absolute:0},max_inclusive:{absolute:256},inner:8}}});break;case"lava_lake":const c=e.config.chance/10;e.type="minecraft:decorated",e.config=T(...Number.isInteger(c)?[{type:"minecraft:chance",config:{chance:c}}]:[{type:"minecraft:count_extra",config:{count:0,extra_count:1,extra_chance:1/c}}],{type:"minecraft:square",config:{}},{type:"minecraft:range",config:{height:{type:"minecraft:biased_to_bottom",min_inclusive:{absolute:0},max_inclusive:{absolute:256},inner:8}}},{type:"minecraft:lava_lake",config:{chance:10}});break;case"fire":const s="number"==typeof e.config.count?e.config.count:e.config.count.base+e.config.count.spread/2;e.type="minecraft:decorated",e.config=T({type:"minecraft:count",config:{count:{type:"minecraft:biased_to_bottom",value:{min_inclusive:0,max_inclusive:Math.ceil(s/2)}}}},{type:"minecraft:square",config:{}},{type:"minecraft:range",config:{height:{type:"minecraft:uniform",min_inclusive:{absolute:4},max_inclusive:{absolute:252}}}});break;case"glowstone":const l="number"==typeof e.config.count?e.config.count:e.config.count.base+e.config.count.spread/2;e.type="minecraft:decorated",e.config=T({type:"minecraft:count",config:{count:{type:"minecraft:biased_to_bottom",value:{min_inclusive:0,max_inclusive:Math.ceil(l-1)}}}},{type:"minecraft:square",config:{}},{type:"minecraft:range",config:{height:{type:"minecraft:uniform",min_inclusive:{absolute:4},max_inclusive:{absolute:252}}}});break;case"range":const f=e.config.bottom_offset,u=e.config.bottom_offset+e.config.maximum-e.config.top_offset-1;if(f===u){e.config={height:{absolute:f}};break}e.config={height:{type:"minecraft:uniform",min_inclusive:{absolute:f},max_inclusive:{absolute:u}}};break;case"range_biased":const d=e.config.bottom_offset,_=e.config.bottom_offset+e.config.maximum-e.config.top_offset-1;e.type="minecraft:range",e.config={height:{type:"minecraft:biased_to_bottom",min_inclusive:{absolute:d},max_inclusive:{absolute:_},cutoff:d}};break;case"range_very_biased":const p=e.config.bottom_offset,m=e.config.bottom_offset+e.config.maximum-e.config.top_offset-1;e.type="minecraft:range",e.config={height:{type:"minecraft:very_biased_to_bottom",min_inclusive:{absolute:p},max_inclusive:{absolute:m},cutoff:p}};break;case"depth_average":e.type="minecraft:range",e.config={height:{type:"minecraft:trapezoid",min_inclusive:{absolute:e.config.baseline},max_inclusive:{absolute:e.config.baseline+e.config.spread}}};break;case"emerald_ore":e.type="minecraft:decorated",e.config=T({type:"minecraft:count",config:{count:{type:"minecraft:uniform",value:{min_inclusive:3,max_inclusive:8}}}},{type:"minecraft:square",config:{}},{type:"minecraft:range",config:{height:{type:"minecraft:uniform",min_inclusive:{absolute:4},max_inclusive:{absolute:31}}}});break;case"end_island":e.type="minecraft:decorated",e.config=T({type:"minecraft:chance",config:{chance:14}},{type:"minecraft:count_extra",config:{count:1,extra_count:1,extra_chance:.25}},{type:"minecraft:square",config:{}},{type:"minecraft:range",config:{height:{type:"minecraft:uniform",min_inclusive:{absolute:55},max_inclusive:{absolute:70}}}});break;case"magma":t.warn('Removed decorator "magma" previously used the sea level. Assumed sea level is 32 and replaced with a range decorator between 27 and 36.'),e.type="minecraft:range",e.config={height:{type:"minecraft:uniform",min_inclusive:{absolute:27},max_inclusive:{absolute:36}}}}}function T(...e){return{outer:e[0],inner:2===e.length?e[1]:{type:"minecraft:decorated",config:T(...e.slice(1))}}}const D=/replaceitem ((?:entity @[parse](\[.*\]*)?|block( [^ ]+){3}) [a-z0-9.]+) /,N=/scoreboard objectives add ([^ ]+) (minecraft.)?custom:(minecraft.)?play_one_minute/,P=x.onFile("functions",(({data:e})=>{e.forEach(((t,a)=>{(t.startsWith("replaceitem ")||t.startsWith("execute "))&&(e[a]=e[a].replace(D,"item replace $1 with ")),(t.startsWith("scoreboard")||t.startsWith("execute"))&&(e[a]=e[a].replace(N,"scoreboard objectives add $1 $2custom:$3play_time"))}))})),q=x.all(x.onFile("tags/blocks",(({data:e})=>L(e))),x.onFile("tags/items",(({data:e})=>L(e))));function L(e){var t;null==(t=e.values)||t.forEach(((t,a)=>function(e,t){"grass_path"===e[t].replace(/^minecraft:/,"")&&(e[t]="minecraft:dirt_path")}(e.values,a)))}const U=x.all(x.onFile("worldgen/noise_settings",(({data:e})=>I(e))),x.onFile("dimension",(({data:e})=>{var t,a;"noise"===(null==(a=null==(t=e.generator)?void 0:t.type)?void 0:a.replace(/^minecraft:/,""))&&I(e.generator.settings)})));function I(e){"object"==typeof e&&(e.bedrock_roof_position<=-10&&(e.bedrock_roof_position=-2147483648),e.bedrock_floor_position<=-10&&(e.bedrock_floor_position=-2147483648),e.min_surface_level=0,e.noise_caves_enabled=!1,e.noodle_caves_enabled=!1,e.aquifers_enabled=!1,e.deepslate_enabled=!1,e.ore_veins_enabled=!1,e.noise.min_y=0)}const W=x.all(x.onFile("predicates",(({data:e})=>{Array.isArray(e)?e.forEach(J):J(e)})),x.onFile("advancements",(({data:e})=>{Object.values(e.criteria).forEach(B)})),x.onFile("loot_tables",(({data:e})=>{var t;null==(t=e.pools)||t.forEach(H)})));function B(e){var t,a;"object"==typeof e.conditions&&(V(e.conditions.entity),V(e.conditions.player),V(e.conditions.parent),V(e.conditions.partner),V(e.conditions.child),V(e.conditions.villager),V(e.conditions.zombie),V(e.conditions.projectile),V(e.conditions.shooter),null==(t=e.conditions.victims)||t.forEach(V),K(e.conditions.item),null==(a=e.conditions.items)||a.forEach(K),Z(e.conditions.damage),Z(e.conditions.killing_blow),Y(e.conditions.location),Y(e.conditions.entered),Y(e.conditions.exited))}function H(e){var t,a;null==(t=e.entries)||t.forEach(G),null==(a=e.conditions)||a.forEach(J)}function G(e){var t,a;null==(t=e.children)||t.forEach(G),null==(a=e.conditions)||a.forEach(J)}function J(e){switch(e.condition.replace(/^minecraft:/,"")){case"match_tool":K(e.predicate);break;case"entity_properties":V(e.predicate);break;case"damage_source_properties":Z(e.predicate);break;case"location_check":Y(e.predicate)}}function Z(e){"object"==typeof e&&(V(e.source_entity),V(e.direct_entity),Z(e.type))}function V(e){"object"==typeof e&&(Array.isArray(e)?e.forEach(J):(e.equipment&&Object.values(e.equipment).forEach(K),V(e.vehicle),V(e.targeted_entity),Y(e.location)))}function Y(e){"object"==typeof e&&function(e){if("object"!=typeof e)return;e.block&&(e.blocks=[e.block],delete e.block)}(e.block)}function K(e){"object"==typeof e&&e.item&&(e.items=[e.item],delete e.item)}const X=x.all(x.onFile("worldgen/configured_structure_feature",(({data:e})=>Q(e))),x.onFile("worldgen/biome",(({data:e})=>{Array.isArray(e.starts)&&e.starts.forEach(Q)})));function Q(e){if("object"!=typeof e)return;"nether_fossil"===e.type.replace(/^minecraft:/,"")&&(e.config||(e.config={}),e.config.height={type:"minecraft:uniform",min_inclusive:{absolute:32},max_inclusive:{below_top:2}})}const ee=x.version("1.16.5","1.17.1",x.groupProblems(x.debug("1.17 fixes"),x.assert((e=>e.meta.data.pack.pack_format<7),"This pack already has pack_format 7 or higher and cannot be upgraded."),x.when("ids",q),x.when("predicates",W),x.when("functions",P),x.when("worldgen",j,U,X,$,C),x.when("packFormat",(async e=>e.meta.data.pack.pack_format=7)))),te=x.all(x.onFile("worldgen/configured_feature",(function(e,t){if("object"!=typeof e.data)return;const a=ne(e.data,t);"string"==typeof a.feature?e.data=ae(oe(a.feature,t)):(e.data={type:null==a?void 0:a.feature.type,config:null==a?void 0:a.feature.config},a.feature=e.name);t.create("worldgen/placed_feature",e.name,{feature:a.feature,placement:null==a?void 0:a.placement})})),x.onFile("worldgen/biome",(({data:e},t)=>{e.player_spawn_friendly=void 0,["air","liquid"].forEach((t=>{Array.isArray(e.carvers[t])&&(e.carvers[t]=e.carvers[t].filter((e=>!ge.has(e.replace(/^minecraft:/,"")))))})),Array.isArray(e.features)&&(e.features=e.features.map((e=>Array.isArray(e)?e.flatMap((e=>{if("string"!=typeof e)return e;const a=function(e,t){var a;const n=e.replace(/^minecraft:/,"");return le.has(n)?le.get(n).map((e=>`minecraft:${e}`)):_e.has(n)||pe.has(n)?[`minecraft:${null!=(a=_e.get(n))?a:pe.get(n)}`]:ue.has(n)&&void 0===t.read("worldgen/placed_feature",n)||fe.has(n)?[]:[e]}(e,t);return a.forEach((e=>{const a=t.read("worldgen/placed_feature",e);a&&(a.data.placement.find((e=>"minecraft:biome"===e.type))||a.data.placement.push({type:"minecraft:biome"}))})),a})):e)))})));function ae(e){return{type:"minecraft:random_selector",config:{features:[],default:e}}}function ne(e,t){var a;if("string"==typeof e){const t=e.replace(/^minecraft:/,"");if(fe.has(t))e={type:"minecraft:no_op",config:{}};else if(de.has(t))e=ae(e);else if(_e.has(t)||me.has(t)){const n=null!=(a=me.get(t))?a:_e.get(t);console.log(`Rename ${t} -> configured: ${n}`),e=`minecraft:${n}`}else if(pe.has(t)){const a=pe.get(t);console.log(`Redirect ${t} -> placed: ${a}`),e=ae(a)}return{feature:e,placement:[]}}if("object"!=typeof e)throw new Error("Feature is not an object nor a string");const n=[];switch(e.type.replace(/^minecraft:/,"")){case"decorated":e=function(e,t){var a;const n=ne(e,t);if("string"==typeof n.feature&&0===n.placement.length){const e=n.feature.replace(/^minecraft:/,"");if(_e.has(e)||me.has(e)){const t=null!=(a=me.get(e))?a:_e.get(e);return console.log(`Rename config: ${e} -> ${t}`),`minecraft:${t}`}if(de.has(e))return ae(n.feature)}return n.feature}(ce(e,n,t),t);break;case"glow_lichen":e.config.can_be_placed_on=[...new Set(e.config.can_be_placed_on.map((e=>e.Name)))];break;case"lake":e.config={fluid:{type:"minecraft:simple_state_provider",state:e.config.state},barrier:{type:"minecraft:simple_state_provider",state:{Name:"minecraft:stone"}}};break;case"nether_forest_vegetation":e.config.spread_width=8,e.config.spread_height=4;break;case"random_boolean_selector":e.config.feature_false=re(e.config.feature_false,t),e.config.feature_true=re(e.config.feature_true,t);break;case"root_system":e.config.allowed_tree_position={type:"minecraft:true"};case"random_patch":case"flower":case"no_bonemeal_flower":e.config.feature=re(e.config.feature,t);break;case"random_selector":e.config.features.forEach((e=>{e.feature=re(e.feature,t)})),e.config.default=re(e.config.default,t);break;case"simple_random_selector":e.config.features=e.config.features.map((e=>re(e,t)));break;case"twisting_vines":e.config={spread_width:8,spread_height:4,max_height:8};break;case"vegetation_patch":case"waterlogged_vegetation_patch":e.config.vegetation_feature=re(e.config.vegetation_feature,t)}return{feature:e,placement:n}}function re(e,t){const a=ne(e,t);return"string"==typeof a.feature&&0===a.placement.length?oe(a.feature,t):a}function oe(e,t){var a;const n=e.replace(/^minecraft:/,"");if(_e.has(n)||pe.has(n)){const e=null!=(a=pe.get(n))?a:_e.get(n);return console.log(`Rename placement: ${n} -> ${e}`),`minecraft:${e}`}return ue.has(n)||void 0!==t.read("worldgen/configured_feature",n)?{feature:e,placement:[]}:(console.log(`No placement: ${n}`),e)}function ie(e,t){if("object"!=typeof e)return[];const a=e.type.replace(/^minecraft:/,"");switch(a){case"block_filter":return[c({type:"minecraft:block_predicate_filter"},e.config)];case"cave_surface":const n=e.config.floor_to_ceiling_search_range;n>32&&t.warn('Converting cave_surface decorator into environment_scan: "max_steps" is limited to 32.');const r={direction_of_search:"ceiling"===e.config.surface?"up":"down",target_condition:{type:"minecraft:solid"},allowed_search_condition:{type:"minecraft:matching_blocks",blocks:["minecraft:air",...e.config.allow_water?["minecraft:water"]:[]]},max_steps:Math.min(32,n)};return[c({type:"minecraft:environment_scan"},r)];case"count_multilayer":return[c({type:"minecraft:count_on_every_layer"},e.config)];case"chance":return[c({type:"minecraft:rarity_filter"},e.config)];case"count_extra":let o=e.config.count+e.config.extra_count;if(o>256){let t=[o];for(o-=1;t.some((e=>e>256));)o+=1,t=se(o);for(let e=2;e<=5;e+=1){const a=Array(e).fill(1),n=[...t];e:for(;n.length>0;){const t=n.pop();for(let n=0;n<e;n+=1)if(a[n]*t<=256){a[n]*=t;continue e}break}if(0===n.length&&a.every((e=>e<=256)))return a.map((e=>({type:"minecraft:count",count:e})))}throw new Error(`Extremely high count: ${e.config.count+e.config.extra_count}`)}return[{type:"minecraft:count",count:{type:"minecraft:weighted_list",distribution:[{weight:Math.round(100*(1-e.config.extra_chance)),data:Math.min(256,e.config.count)},{weight:Math.round(100*e.config.extra_chance),data:Math.min(256,o)}]}}];case"count_noise":return[c({type:"minecraft:noise_threshold_count"},e.config)];case"count_noise_biased":return[c({type:"minecraft:noise_based_count"},e.config)];case"dark_oak_tree":return[{type:"minecraft:count",count:16},{type:"minecraft:in_square"}];case"decorated":return[...ie(e.config.outer,t),...ie(e.config.inner,t)];case"end_gateway":return[{type:"minecraft:random_offset",xz_spread:0,y_spread:{type:"minecraft:uniform",value:{min_inclusive:3,max_inclusive:9}}}];case"iceberg":return[{type:"minecraft:in_square"}];case"lava_lake":return[{type:"minecraft:rarity_filter",chance:10}];case"nope":return[];case"range":return[c({type:"minecraft:height_range"},e.config)];case"scatter":return[c({type:"minecraft:random_offset"},e.config)];case"square":return[c({type:"minecraft:in_square"},e.config)];case"surface_relative_threshold":return[c({type:"minecraft:surface_relative_threshold_filter"},e.config)];case"water_depth_threshold":return[c({type:"minecraft:surface_water_depth_filter"},e.config)];default:return[c({type:a},e.config)]}}function ce(e,t,a){if("object"!=typeof e)return e;return"decorated"===e.type.replace(/^minecraft:/,"")?(t.push(...ie(e.config.decorator,a)),ce(e.config.feature,t,a)):e}function se(e){const t=[];let a=2;for(;e>=2;)e%a==0?(t.push(a),e/=a):a+=1;return t}const le=new Map(Object.entries({birch_other:["forest_flowers","trees_birch_and_oak"],fossil:["fossil_upper","fossil_lower"],lake_lava:["lake_lava_surface","lake_lava_underground"],monster_room:["monster_room","monster_room_deep"],ore_granite:["ore_granite_upper","ore_granite_lower"],ore_diorite:["ore_diorite_upper","ore_diorite_lower"],ore_andesite:["ore_andesite_upper","ore_andesite_lower"],ore_coal:["ore_coal_upper","ore_coal_lower"],ore_iron:["ore_iron_upper","ore_iron_middle","ore_iron_small"],ore_gold:["ore_gold","ore_gold_lower"],ore_redstone:["ore_redstone","ore_redstone_lower"],ore_diamond:["ore_diamond","ore_diamond_large","ore_diamond_buried"],ore_lapis:["ore_lapis","ore_lapis_buried"]})),fe=new Set(["lake_water","rare_dripstone_cluster","rare_small_dripstone","ore_deepslate"]),ue=new Set(["azalea_tree","birch_bees_005","bonus_chest","cave_vine_in_moss","clay_pool_with_dripleaves","clay_with_dripleaves","dripleaf","end_gateway_delayed","huge_brown_mushroom","huge_red_mushroom","jungle_tree_no_vine","moss_patch","moss_patch_bonemeal","moss_patch_ceiling","moss_vegetation","oak_bees_005","patch_brown_mushroom","patch_red_mushroom","spring_lava_double","swamp_oak"]),de=new Set(["patch_dead_bush_2"]),_e=new Map(Object.entries({birch_other:"trees_birch_and_oak",end_gateway:"end_gateway_return",fancy_oak_bees_005:"fancy_oak_bees",flower_forest:"flower_flower_forest",forest_flower_trees:"trees_flower_forest",forest_flower_vegetation:"forest_flowers",forest_flower_vegetation_common:"flower_forest_flowers",grove_vegetation:"trees_grove",mushroom_field_vegetation:"mushroom_island_vegetation",ore_debris_large:"ore_ancient_debris_large",patch_waterlilly:"patch_waterlily",pine:"pine_checked",plain_vegetation:"trees_plains",rooted_azalea_trees:"rooted_azalea_tree",taiga_vegetation:"trees_taiga",trees_giant:"trees_old_growth_pine_taiga",trees_giant_spruce:"trees_old_growth_spruce_taiga",trees_jungle_edge:"trees_sparse_jungle",trees_mountain:"trees_windswept_hills"})),pe=new Map(Object.entries({acacia:"acacia_checked",birch:"birch_checked",brown_mushroom_giant:"brown_mushroom_old_growth",cave_vine:"cave_vines",dark_oak:"dark_oak_checked",end_island:"end_island_decorated",fancy_oak:"fancy_oak_checked",flower_plain_decorated:"flower_plains",meadow_trees:"trees_meadow",mega_jungle_tree:"mega_jungle_tree_checked",mega_pine:"mega_pine_checked",red_mushroom_giant:"red_mushroom_old_growth",patch_cactus:"patch_cactus_decorated",mega_spruce:"mega_spruce_checked",spruce:"spruce_checked",trees_mountain_edge:"trees_windswept_forest",trees_shattered_savanna:"trees_windswept_savanna"})),me=new Map(Object.entries({mega_spruce:"mega_spruce",cave_vine:"cave_vine",crimson_fungi_planted:"crimson_fungus_planted",warped_fungi_planted:"warped_fungus_planted"})),ge=new Set(["ocean_cave","prototype_canyon","prototype_cave","prototype_crevice","underwater_canyon","underwater_cave"]),he=["raw_generation","lakes","local_modifications","underground_structures","surface_structures","strongholds","underground_ores","underground_decoration","fluid_springs","vegetal_decoration","top_layer_modification"];const ve=x.all(x.onFile("worldgen/noise_settings",(({data:e})=>be(e))),x.onFile("dimension",(({data:e})=>{var t,a;"noise"===(null==(a=null==(t=e.generator)?void 0:t.type)?void 0:a.replace(/^minecraft:/,""))&&be(e.generator.settings)})));function be(e){ye(e.surface_rule)}function ye(e){if("object"!=typeof e)return;switch(e.type.replace(/^minecraft:/,"")){case"sequence":e.sequence.forEach((e=>ye(e)));break;case"condition":we(e.if_true),ye(e.then_run)}}function we(e){if("object"!=typeof e)return;switch(e.type.replace(/^minecraft:/,"")){case"not":we(e.invert);break;case"stone_depth":e.offset=0,e.add_surface_depth=e.add_run_depth,e.add_surface_secondary_depth=!1,delete e.add_run_depth;break;case"water":case"y_above":e.surface_depth_multiplier=e.run_depth_multiplier,delete e.run_depth_multiplier}}const ke=x.all(x.version("21w44a","1.18",x.groupProblems(x.debug("1.18 fixes"),x.when("worldgen",te,ve))),x.versionInclusive("1.18","1.18",x.when("featureCycles",x.debug("Checking feature order cycle"),(async function(e,t){var a;const n=e.data["worldgen/biome"],r=new Set;for(let o=0;o<he.length;o+=1){const e=[];for(const t of n){const n=null!=(a=t.data.features[o])?a:[];for(let a=0;a<n.length;a+=1){const o=n[a];if(e.some((e=>e.biome===t.name&&e.id===o))){r.add(t.name);continue}const i=new Set(n.slice(0,a));e.push({id:o,biome:t.name,depends:i})}}const i=[],c=e.filter((t=>e.filter((e=>t.id===e.id)).every((e=>0===e.depends.size))));for(;c.length>0;){const t=c.pop();if(!i.some((e=>e.id===t.id))){i.push(t);for(const a of e.filter((e=>e.depends.has(t.id))))a.depends.delete(t.id),e.filter((e=>a.id===e.id)).every((e=>0===e.depends.size))&&c.push(a)}}if(e.some((e=>e.depends.size>0))){let a=function(t,o,i){if(i<=0)return!1;n.add(t.biome),r.add(t.id);for(const c of t.depends){if(c===o.id)return[o];if(!r.has(c))for(const t of e.filter((e=>e.id===c&&!n.has(e.biome)))){const e=a(t,o,i-1);if(e)return[t,...e]}}return n.delete(t.biome),!1};const n=new Set,r=new Set;let i=!1;const c=e.filter((e=>e.depends.size>0));e:for(let e=2;e<10;e+=1)for(const t of c)if(n.clear(),r.clear(),i=a(t,t,e),i)break e;if(i){const e=[`Cycle in step ${o} (${he[o]}):`];for(let t=i.length-1;t>=0;t-=1){const a=i[t],n=i[(t+1+i.length)%i.length];e.push(`• Biome ${a.biome}: '${n.id}' -> '${a.id}'`)}t.warn("!Feature order cycle found. Needs manual fixing.",[],e)}}}r.size>0&&t.warn("!Detected duplicate features. They are no longer allowed.",[...r])})))),xe=x.all(x.onFile("advancements",(({data:e})=>{Object.values(e.criteria).forEach(Ee)})));function Ee(e){switch(e.trigger.replace(/^minecraft:/,"")){case"nether_travel":if("object"!=typeof e.conditions)break;const{distance:t,entered:a,exited:n,player:r}=e.conditions;e.conditions={player:$e(r,n),start_position:a,distance:t}}}function $e(e,t){return void 0===e?{location:t}:Array.isArray(e)&&e.length>=1?[e,{type:"minecraft:entity_properties",predicate:{location:t}}]:s(c({},e),{location:c(c({},e.location),t)})}const Ae=x.all(x.onFile("worldgen/biome",(function({data:e},t){var a,n;t.warn('Biome "depth" and "scale" were removed and replaced with a more powerful terrain shaper option in noise settings. No automatic upgrade possible.'),e.depth=void 0,e.scale=void 0,t.warn('Biome "surface_builder" was removed and replaced with a more powerful surface_rule option in noise settings. No automatic upgrade possible.'),e.surface_builder=void 0,Array.isArray(e.starts)&&e.starts.length>0&&t.warn('Biome "starts" was removed, custom structures are not supported in 1.18.');e.starts=void 0,Array.isArray(e.features)&&e.features.length>=9&&e.features.splice(8,0,[]);const r=null==(a=e.effects.particle)?void 0:a.options;"dust"===(null==(n=null==r?void 0:r.type)?void 0:n.replace(/minecraft:/,""))&&r.r&&(e.effects.particle.options={type:"minecraft:dust",color:[r.r,r.g,r.b],scale:r.scale})})));const je=x.all(x.onFile("dimension",(({data:e},t)=>{var a,n;if("noise"===(null==(n=null==(a=e.generator)?void 0:a.type)?void 0:n.replace(/^minecraft:/,""))){const a=function(e,t){var a;if("object"!=typeof e)return[];switch(e.type.replace(/^minecraft:/,"")){case"fixed":return[e.biome];case"checkerboard":return[...new Set(e.biomes)];case"multi_noise":return e.seed=void 0,"nether"===(null==(a=e.preset)?void 0:a.replace(/^minecraft:/,""))?["nether_wastes","soul_sand_valley","crimson_forest","warped_forest","basalt_deltas"]:(e.altitude_noise=void 0,e.temperature_noise=void 0,e.humidity_noise=void 0,e.weirdness_noise=void 0,e.biomes.forEach((e=>{e.parameters={temperature:e.parameters.temperature,humidity:e.parameters.humidity,continentalness:e.parameters.altitude,erosion:0,weirdness:e.parameters.weirdness,depth:0,offset:e.parameters.offset}})),[...new Set(e.biomes.map((e=>e.biome)))]);case"vanilla_layered":return t.warn('Removed biome source "vanilla_layered", replaced with the multi noise overworld preset.'),e.type="multi_noise",e.preset="minecraft:overworld",[]}return[]}(e.generator.biome_source,t);ze(e.generator.settings,t,a)}})),x.onFile("worldgen/noise_settings",(({data:e},t)=>{ze(e,t)})));function ze(e,t,a=[]){if("string"==typeof e){const n=t.read("worldgen/noise_settings",e);return void(n&&ze(n.data,t,a))}if("object"!=typeof e)return;if(void 0!==e.surface_rule)return;e.legacy_random_source=!1,e.noise.top_slide.target/=128,e.noise.bottom_slide.target/=128,e.min_surface_level=void 0,e.noise.simplex_surface_noise=void 0,e.noise.random_density_offset=void 0,e.noise.terrain_shaper={offset:0,factor:0,jaggedness:0},e.noise.density_offset=void 0,e.noise.density_factor=void 0;const n=[];var r,o;e.bedrock_floor_position>-10&&n.push(Ce("vertical_gradient",{random_name:"minecraft:bedrock_floor",true_at_and_below:{above_bottom:e.bedrock_floor_position+5},false_at_and_above:{above_bottom:e.bedrock_floor_position}}).thenRun("block",{result_state:{Name:"minecraft:bedrock"}})),e.bedrock_roof_position>-10&&n.push((r="vertical_gradient",o={random_name:"minecraft:bedrock_roof",true_at_and_below:{below_top:e.bedrock_roof_position+5},false_at_and_above:{below_top:e.bedrock_roof_position}},Ce("not",{invert:c({type:`minecraft:${r}`},o)})).thenRun("block",{result_state:{Name:"minecraft:bedrock"}})),e.deepslate_enabled&&n.push(Ce("vertical_gradient",{random_name:"minecraft:deepslate",true_at_and_below:{absolute:0},false_at_and_above:{absolute:8}}).thenRun("block",{result_state:{Name:"minecraft:deepslate",Properties:{axis:"y"}}})),e.surface_rule={type:"minecraft:sequence",sequence:n}}function Ce(e,t){return{thenRun:(a,n)=>({type:"minecraft:condition",if_true:c({type:`minecraft:${e}`},t),then_run:c({type:`minecraft:${a}`},n)})}}const Fe=x.all(x.onFile("worldgen/configured_feature",(({data:e},t)=>Me(e,t))));function Me(e,t){if("object"!=typeof e)return;switch(e.type.replace(/^minecraft:/,"")){case"decorated":Se(e.config.decorator,t),Me(e.config.feature,t);break;case"random_boolean_selector":Me(e.config.feature_false,t),Me(e.config.feature_true,t);break;case"random_selector":e.config.features.forEach((e=>Me(e.feature,t))),Me(e.config.default,t);break;case"simple_random_selector":e.config.features.forEach((e=>Me(e,t)));break;case"flower":case"no_bonemeal_flower":case"random_patch":e.config.xspread!==e.config.zspread&&t.warn("Random patch xspread and zspread can no longer be different. Using xspread.");const a=[];!0!==e.config.can_replace&&a.push({type:"minecraft:matching_blocks",blocks:["minecraft:air"]}),Te(e.config.whitelist)&&a.push({type:"minecraft:matching_blocks",blocks:De(e.config.whitelist)}),Te(e.config.blacklist)&&a.push({type:"minecraft:not",predicate:{type:"minecraft:matching_blocks",blocks:De(e.config.blacklist)}});const n="column_placer"===e.config.block_placer.type.replace(/^minecraft:/,"")?{type:"minecraft:block_column",config:{direction:"up",allowed_placement:!0!==e.config.can_replace?{type:"minecraft:matching_blocks",blocks:["minecraft:air"]}:{type:"minecraft:true"},prioritize_tip:!1,layers:[{height:e.config.block_placer.size,provider:e.config.state_provider}]}}:{type:"minecraft:simple_block",config:{to_place:e.config.state_provider}};e.config={tries:e.config.tries,xz_spread:e.config.xspread,y_spread:e.config.yspread,feature:Re(n,[{type:"minecraft:block_filter",config:{predicate:{type:"minecraft:all_of",predicates:a}}}])},!0===e.config.project&&(e.config={decorator:{type:"heightmap",config:{heightmap:"OCEAN_FLOOR"}},feature:{type:e.type,config:e.config}},e.type="minecraft:decorated");break;case"growing_plant":e.type="minecraft:block_column",e.config={direction:e.config.direction,allowed_placement:!0!==e.config.allow_water?{type:"minecraft:matching_blocks",blocks:["minecraft:air"]}:{type:"minecraft:true"},prioritize_tip:!0,layers:[{height:{type:"minecraft:weighted_list",distribution:e.config.height_distribution.map((e=>({weight:e.weight,data:Oe(e.data,-1,0,1/0)})))},provider:e.config.body_provider},{height:1,provider:e.config.head_provider}]};break;case"root_system":Me(e.config.feature,t);break;case"simple_block":const r=[];Te(e.config.place_on)&&r.push({type:"minecraft:matching_blocks",offset:[0,-1,0],blocks:De(e.config.place_on)}),Te(e.config.place_in)&&r.push({type:"minecraft:matching_blocks",blocks:De(e.config.place_in)}),Te(e.config.place_under)&&r.push({type:"minecraft:matching_blocks",offset:[0,1,0],blocks:De(e.config.place_under)}),e.config.place_on=void 0,e.config.place_in=void 0,e.config.place_under=void 0,r.length>0&&(e.type="minecraft:decorated",e.config={decorator:{type:"minecraft:block_filter",config:{predicate:1==r.length?r[0]:{type:"minecraft:all_of",predicates:r}}},feature:{type:"minecraft:simple_block",config:e.config}});break;case"small_dripstone":const o=t=>Re({type:"minecraft:pointed_dripstone",config:{chance_of_taller_dripstone:e.config.chance_of_taller_dripstone,chance_of_directional_spread:.7,chance_of_spread_radius2:.5,chance_of_spread_radius3:.5}},[{type:"minecraft:cave_surface",config:{surface:t,floor_to_ceiling_search_range:12,allow_water:!0}}]);e.type="minecraft:decorated",e.config=Re({type:"minecraft:simple_random_selector",config:{features:[o("floor"),o("ceiling")]}},[{type:"count",config:{count:{type:"minecraft:uniform",value:{min_inclusive:1,max_inclusive:e.config.max_placements}}}},{type:"minecraft:scatter",config:{xz_spread:{type:"minecraft:clamped_normal",value:{mean:0,deviation:3,min_inclusive:-10,max_inclusive:10}},y_spread:{type:"minecraft:clamped_normal",value:{mean:0,deviation:.6,min_inclusive:-2,max_inclusive:2}}}}]).config;break;case"vegetation_patch":case"waterlogged_vegetation_patch":Me(e.config.vegetation_feature,t)}}function Oe(e,t,a,n){if("number"==typeof e)return e+t;const r=e.type.replace(/^minecraft:/,"");switch(r){case"constant":return{type:e.type,value:Math.max(a,Math.min(n,e.value+t))};case"uniform":case"biased_to_bottom":return{type:e.type,value:{min_inclusive:Math.max(a,Math.min(n,e.value.min_inclusive+t)),max_inclusive:Math.max(a,Math.min(n,e.value.max_inclusive+t))}};case"clamped":return{type:e.type,value:{min_inclusive:Math.max(a,Math.min(n,e.value.min_inclusive+t)),max_inclusive:Math.max(a,Math.min(n,e.value.max_inclusive+t)),source:Oe(e.value.source,t,a,n)}}}throw new Error(`Unknown int provider "${r}"`)}function Se(e,t){if("object"!=typeof e)return;switch(e.type.replace(/^minecraft:/,"")){case"decorated":Se(e.config.outer,t),Se(e.config.inner,t);break;case"cave_surface":e.config.allow_water=!1;break;case"heightmap_spread_double":t.warn('Removed decorator "heightmap_spread_double" was replaced with "heightmap". You likely need to make this feature rarer.'),e.type="minecraft:heightmap";break;case"spread_32_above":t.warn('Removed decorator "spread_32_above". You likely need to make this feature rarer.'),e.type="minecraft:nope"}}function Re(e,t=[]){return 0==t.length?e:{type:"minecraft:decorated",config:{decorator:t[0],feature:Re(e,t.slice(1))}}}function Te(e){return Array.isArray(e)&&e.length>0}function De(e){return[...new Set(e.map((e=>e.Name)))]}const Ne=x.version("1.17.1","21w44a",x.groupProblems(x.debug("21w44a fixes"),x.assert((e=>e.meta.data.pack.pack_format<8),"This pack already has pack_format 8 or higher and cannot be upgraded."),x.when("predicates",xe),x.when("worldgen",je,Fe,Ae),x.when("packFormat",(async e=>e.meta.data.pack.pack_format=8)))),Pe=x.all(ee,Ne,ke),qe=["advancements","dimension","dimension_type","loot_tables","predicates","tags/blocks","tags/items","worldgen/biome","worldgen/configured_carver","worldgen/configured_feature","worldgen/configured_structure_feature","worldgen/configured_surface_builder","worldgen/noise_settings","worldgen/placed_feature","worldgen/processor_list","worldgen/template_pool"];var Le;!function(e){async function t(e){let t=await a(e);const n=u(t).indent;try{return t=t.replaceAll("​","").replaceAll("‌","").replaceAll("‍","").replaceAll("\ufeff",""),t=t.split("\n").map((e=>e.replace(/^([^"\/]+)\/\/.*/,"$1"))).join("\n"),{data:JSON.parse(d(t)),indent:n}}catch(r){throw console.log(t),new Error(`Cannot parse file: ${r.message}.`)}}async function a(e){return await e.async("text")}function n(e,t,a,n){r(e,t,JSON.stringify(a,null,n)+"\n")}function r(e,t,a){e.file(t,a)}e.fromZip=async function(e){const n=await e.arrayBuffer(),r=await f.loadAsync(n),o=r.filter((e=>e.endsWith("pack.mcmeta")&&!e.startsWith("__MACOSX/")));if(0===o.length)throw new Error('Cannot find any "pack.mcmeta" files.');return Promise.all(o.map((n=>{const o=n.name.replace(/\/?pack.mcmeta$/,""),i=0===o.length?e.name:o.split("/").pop();return console.log(n,o,i),async function(e,n){const r={id:Ie(),name:e,root:n,status:"loaded",data:{},meta:c({name:"pack"},await t(n.file("pack.mcmeta")))};return await Promise.all(qe.map((async e=>{r.data[e]=await async function(e,a){const n=new RegExp(`([^/]+)/${a}/(.*).json$`);return Promise.all(e.filter((e=>null!==e.match(n))).map((async e=>{const a=e.name.match(n);return c({name:`${a[1]}:${a[2]}`},await t(e))})))}(n.folder("data"),e)}))),r.data.functions=await async function(e){const t=/([^\/]+)\/functions\/(.*)\.mcfunction$/;return Promise.all(e.filter((e=>null!==e.match(t))).map((async e=>{const n=e.name.match(t);return{name:`${n[1]}:${n[2]}`,data:(await a(e)).split("\n")}})))}(n.folder("data")),console.log(r),r}(i,r.folder(o))})))},e.toZip=async function(e){var t,a;if("upgraded"!==e.status)throw new Error(`Cannot download pack with status ${e.status}.`);qe.forEach((t=>{var a;!function(e,t,a){a.forEach((({name:a,data:r,indent:o})=>{const[i,c]=a.split(":");n(e,`${i}/${t}/${c}.json`,r,o)}))}(e.root.folder("data"),t,null!=(a=e.data[t])?a:[])})),a=e.root.folder("data"),(null!=(t=e.data.functions)?t:[]).forEach((({name:e,data:t})=>{const[n,o]=e.split(":");r(a,`${n}/functions/${o}.mcfunction`,t.join("\n"))})),n(e.root,"pack.mcmeta",e.meta.data,e.meta.indent);const o=await e.root.generateAsync({type:"blob",compression:"DEFLATE"}),i=URL.createObjectURL(o);return e.status="done",i},e.upgrade=async function(e,t){if("loaded"!==e.status)throw new Error(`Cannot upgrade pack with status '${e.status}'.`);const a={warn:t.onWarning,prompt:t.onPrompt,source:()=>t.source,target:()=>t.target,config:e=>t.features[e],read:(t,a)=>e.data[t].find((e=>e.name.replace(/^minecraft:/,"")===a.replace(/^minecraft:/,""))),create:(t,a,n)=>{e.data[t].push({name:a,indent:e.meta.indent,data:n})}};await Pe(e,a),e.status="upgraded"}}(Le||(Le={}));const Ue=e=>("0"+e.toString(16)).substr(-2);function Ie(e=12){var t=new Uint8Array(e/2);return window.crypto.getRandomValues(t),Array.from(t,Ue).join("")}function We({pack:e,config:t,source:a,target:n,onError:r,onRemove:o,onDone:i,doDownload:c}){var s;const[f,u]=_("Loading..."),[d,h]=_(null),[v,b]=_([]),[w,k]=_(null),[x,E]=_(!1),[$,A]=_(null),j=p(null),z=p((()=>{})),C=e.name.replace(/\.zip$/,`_${n}.zip`),F=(e,t,a,n)=>(A({title:e,message:t,actions:null!=a?a:["Confirm"],info:n}),new Promise((e=>{z.current=t=>{A(null),e(t)}}))),M=(e,t,a)=>{setTimeout((()=>b((n=>[...n,{message:e,files:t,info:a}]))))};m((()=>{(async()=>{try{u("Upgrading..."),await Le.upgrade(e,{features:t,source:a,target:n,onPrompt:F,onWarning:M}),u("Zipping...");const r=await Le.toZip(e);h(r),i()}catch(o){r(o),k("Error during upgrading")}})()}),[e]);return m((()=>{c&&j.current.click()}),[c]),l("div",{class:"pack"},l("div",{class:"pack-head"},d&&l("a",{class:"pack-status download",ref:j,href:d,download:C,"data-hover":`Download data pack for ${n}`},y.download),!d&&!w&&!$&&l("div",{class:"pack-status loading","data-hover":f},y.sync),!d&&!w&&$&&l("div",{class:"pack-status prompt","data-hover":"Manual action required"},y.report),(v.length>0||w)&&l("div",{class:"pack-status alert"+(w?" error":""),onClick:()=>{E(!x)},"data-hover":null!=w?w:"There were issues upgrading"},y.alert),l("span",{class:"pack-name"},e.name.replace(/\.zip$/,"")),l("div",{class:"pack-status remove",onClick:o},y.x)),($||v.length>0&&!x)&&l("div",{class:"pack-body"},$&&l("div",{class:"pack-prompt"},l("p",{class:"prompt-title"},$.title),$.message&&l("p",{class:"prompt-message"},$.message),l("p",null,$.actions.map((e=>l("button",{onClick:()=>z.current(e)},e)))),null==(s=$.info)?void 0:s.map((e=>l("p",{class:"prompt-info"},e)))),v.length>0&&!x&&v.map((({message:e,files:t,info:a})=>l("div",{class:"pack-alert"},l("div",{class:"alert-message "+(e.startsWith("!")?"alert-error":"")},e.replace(/\!/,"")),t&&t.length>0&&l(g,null,l("p",null,"Affected files:"),l("div",{class:"alert-files"},t.map((e=>l("p",null,e))))),null==a?void 0:a.map((e=>l("p",{class:"alert-info"},e))))))))}function Be({value:e,onChange:t}){const a=p(null);return l("select",{class:"version-picker",ref:a,value:e,onChange:()=>{t(a.current.value)}},w.map((e=>l("option",{value:e},e))))}var He;function Ge(){const[e,t]=_([]),[a,n]=_([]),[r,o]=_(He.getSource()),[i,f]=_(He.getTarget()),[u,d]=_({functions:!0,ids:!0,predicates:!0,worldgen:!0,packFormat:!0,featureCycles:!0}),p=(e,t)=>{const r=Ie(),o=t.stack.split("\n").map((e=>e.replace(/^(\s+)at (?:async )?(https?:.*)/,"$1at ($2)")));h.exports.mapStackTrace(o.join("\n"),(e=>{const t=o[0]+"\n"+e.map((e=>e.replace(/..\/..\/src\//,"src/"))).join("\n");n((e=>e.map((e=>e.id===r?s(c({},e),{stacktrace:t}):e))))})),n([...a,{id:r,process:e,error:t}])},m=e=>{console.error(e),p("upgrading",e)},[v,w]=_(0);return l("main",{onDrop:async a=>{if(a.preventDefault(),!a.dataTransfer)return;const n=[];for(let e=0;e<a.dataTransfer.files.length;e++){const t=a.dataTransfer.files[e];t.type.match(/^application\/(x-)?zip(-compressed)?$/)&&n.push(Le.fromZip(t))}if(0===n.length)p("loading",new Error("The dropped files contain no zip files. Please zip the data pack first."));else{const a=await Promise.all(n.map((async e=>{try{return await e}catch(t){return p("loading",t),void console.error(t)}})));t([...e,...a.flat().filter((e=>void 0!==e))])}},onDragOver:e=>e.preventDefault()},e.length>0&&l(g,null,l("div",{class:"packs"},e.map((a=>l(We,s(c({key:a.id},{pack:a,config:u,source:r,target:i,doDownload:v}),{onError:m,onRemove:()=>{return e=a.id,void t((t=>t.filter((t=>t.id!==e))));var e},onDone:()=>t([...e])})))),e.filter((e=>"done"===e.status)).length>1&&l("button",{class:"download-all",onClick:()=>w(v+1)},y.download,l("span",null,"Download all")))),l("div",{class:"drop"},l("h1",null,"Drop data pack here"),l("p",null,"Convert from ",l(Be,{value:r,onChange:e=>{He.setSource(e),o(e)}})," to ",l(Be,{value:i,onChange:e=>{He.setTarget(e),f(e)}})),k.order(i,r)?l("p",{class:"error-message"},"Invalid version range"):null),l("div",{class:"configs"},l(b,{name:"Upgrade functions",value:u.functions,onChange:e=>d(s(c({},u),{functions:e}))}),l(b,{name:"Upgrade IDs",value:u.ids,onChange:e=>d(s(c({},u),{ids:e}))}),l(b,{name:"Upgrade JSON files",value:u.predicates,onChange:e=>d(s(c({},u),{predicates:e}))}),l(b,{name:"Upgrade worldgen",value:u.worldgen,onChange:e=>d(s(c({},u),{worldgen:e}))}),l(b,{name:"Upgrade pack_format",value:u.packFormat,onChange:e=>d(s(c({},u),{packFormat:e}))}),l(b,{name:"Detect feature cycles",value:u.featureCycles,onChange:e=>d(s(c({},u),{featureCycles:e}))})),l("div",{class:"footer"},l("p",null,"Developed by Misode"),l("p",null,"Source code on ",l("a",{href:"https://github.com/misode/upgrader",target:"_blank"},"GitHub"))),l("div",{class:"main-errors"},a.map((e=>{var t;const r=`${e.error.name}: ${e.error.message}`,o=`An error occurred while ${e.process} a data pack.\nData Pack: \x3c!-- ATTACH YOUR DATAPACK HERE --\x3e\n\n\`\`\`\n${null!=(t=e.stacktrace)?t:e.error.stack}\n\`\`\`\n`,i=`https://github.com/misode/upgrader/issues/new?title=${encodeURIComponent(r)}&body=${encodeURIComponent(o)}\n`;return l("div",{class:"main-error"},l("p",null,"Something went wrong ",e.process," the data pack:"),l("p",{class:"error-message"},e.error.message),l("p",null,"You can report this as a bug ",l("a",{href:i,target:"_blank"},"on GitHub")," and upload the data pack"),l("div",{class:"error-close",onClick:()=>n(a.filter((t=>t.id!==e.id)))},y.x))}))))}!function(e){const t="misode_upgrader_config";function a(){var e;return JSON.parse(null!=(e=localStorage.getItem(t))?e:"{}")}function n(e){const n=c(c({},a()),e);localStorage.setItem(t,JSON.stringify(n))}e.getSource=function(){const e=a().source;return e&&w.includes(e)?e:k.DEFAULT_SOURCE},e.setSource=function(e){n({source:e})},e.getTarget=function(){const e=a().target;return e&&w.includes(e)?e:k.DEFAULT_TARGET},e.setTarget=function(e){n({target:e})}}(He||(He={}));v(l(Ge,null),document.body);
//# sourceMappingURL=index.bbe3751c.js.map
