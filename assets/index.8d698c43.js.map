{"version":3,"file":"index.8d698c43.js","sources":["../../vite/modulepreload-polyfill","../../src/components/Config.tsx","../../src/components/Octicon.tsx","../../src/Version.ts","../../src/Fix.ts","../../src/fixes/1.17/Carver.ts","../../src/fixes/1.17/DimensionType.ts","../../src/fixes/1.17/Feature.ts","../../src/fixes/1.17/Function.ts","../../src/fixes/1.17/Ids.ts","../../src/fixes/1.17/NoiseSettings.ts","../../src/fixes/1.17/Predicates.ts","../../src/fixes/1.17/StructureFeature.ts","../../src/fixes/1.17/index.ts","../../src/fixes/1.18/Feature.ts","../../src/fixes/1.18/FeatureCycles.ts","../../src/fixes/1.18/NoiseSettings.ts","../../src/fixes/1.18/index.ts","../../src/fixes/1.18.2/Dimension.ts","../../src/fixes/1.18.2/DimensionType.ts","../../src/fixes/1.18.2/Feature.ts","../../src/fixes/1.18.2/Function.ts","../../src/fixes/1.18.2/NoiseSettings.ts","../../src/fixes/1.18.2/Predicates.ts","../../src/fixes/1.18.2/ProcessorList.ts","../../src/fixes/1.18.2/StructureFeature.ts","../../src/fixes/1.18.2/index.ts","../../src/fixes/1.19/Biome.ts","../../src/fixes/1.19/Carver.ts","../../src/fixes/1.19/Dimension.ts","../../src/fixes/1.19/Feature.ts","../../src/fixes/1.19/Function.ts","../../src/fixes/1.19/DefaultNoise.ts","../../src/fixes/1.19/NoiseSettings.ts","../../src/fixes/1.19/Predicates.ts","../../src/fixes/1.19/Structure.ts","../../src/fixes/1.19/index.ts","../../src/fixes/21w44a/Advancement.ts","../../src/fixes/21w44a/Biome.ts","../../src/fixes/21w44a/Dimension.ts","../../src/fixes/21w44a/Feature.ts","../../src/fixes/21w44a/index.ts","../../src/fixes/ParseErrors.ts","../../src/fixes/index.ts","../../src/Pack.ts","../../src/components/PackCard.tsx","../../src/components/VersionPicker.tsx","../../src/Store.ts","../../src/App.tsx","../../src/main.tsx"],"sourcesContent":["const p = function polyfill() {\n    const relList = document.createElement('link').relList;\n    if (relList && relList.supports && relList.supports('modulepreload')) {\n        return;\n    }\n    for (const link of document.querySelectorAll('link[rel=\"modulepreload\"]')) {\n        processPreload(link);\n    }\n    new MutationObserver((mutations) => {\n        for (const mutation of mutations) {\n            if (mutation.type !== 'childList') {\n                continue;\n            }\n            for (const node of mutation.addedNodes) {\n                if (node.tagName === 'LINK' && node.rel === 'modulepreload')\n                    processPreload(node);\n            }\n        }\n    }).observe(document, { childList: true, subtree: true });\n    function getFetchOpts(script) {\n        const fetchOpts = {};\n        if (script.integrity)\n            fetchOpts.integrity = script.integrity;\n        if (script.referrerpolicy)\n            fetchOpts.referrerPolicy = script.referrerpolicy;\n        if (script.crossorigin === 'use-credentials')\n            fetchOpts.credentials = 'include';\n        else if (script.crossorigin === 'anonymous')\n            fetchOpts.credentials = 'omit';\n        else\n            fetchOpts.credentials = 'same-origin';\n        return fetchOpts;\n    }\n    function processPreload(link) {\n        if (link.ep)\n            // ep marker = processed\n            return;\n        link.ep = true;\n        // prepopulate the load record\n        const fetchOpts = getFetchOpts(link);\n        fetch(link.href, fetchOpts);\n    }\n};__VITE_IS_MODERN__&&p();","\n\nexport function Config({ name, value, onChange }: { name: string, value: boolean, onChange: (value: boolean) => unknown }) {\n\treturn <label class=\"config\">\t\n\t\t<input type=\"checkbox\" checked={value} onChange={(e) => onChange((e.target as any).checked )} />\n\t\t{name}\n\t</label>\n}\n","export const Octicon = {\n\talert: <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 16 16\" width=\"16\" height=\"16\"><path fill-rule=\"evenodd\" d=\"M8.22 1.754a.25.25 0 00-.44 0L1.698 13.132a.25.25 0 00.22.368h12.164a.25.25 0 00.22-.368L8.22 1.754zm-1.763-.707c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0114.082 15H1.918a1.75 1.75 0 01-1.543-2.575L6.457 1.047zM9 11a1 1 0 11-2 0 1 1 0 012 0zm-.25-5.25a.75.75 0 00-1.5 0v2.5a.75.75 0 001.5 0v-2.5z\"></path></svg>,\n\tdownload: <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 16 16\" width=\"16\" height=\"16\"><path fill-rule=\"evenodd\" d=\"M7.47 10.78a.75.75 0 001.06 0l3.75-3.75a.75.75 0 00-1.06-1.06L8.75 8.44V1.75a.75.75 0 00-1.5 0v6.69L4.78 5.97a.75.75 0 00-1.06 1.06l3.75 3.75zM3.75 13a.75.75 0 000 1.5h8.5a.75.75 0 000-1.5h-8.5z\"></path></svg>,\n\theart: <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 16 16\" width=\"16\" height=\"16\"><path fill-rule=\"evenodd\" d=\"M4.25 2.5c-1.336 0-2.75 1.164-2.75 3 0 2.15 1.58 4.144 3.365 5.682A20.565 20.565 0 008 13.393a20.561 20.561 0 003.135-2.211C12.92 9.644 14.5 7.65 14.5 5.5c0-1.836-1.414-3-2.75-3-1.373 0-2.609.986-3.029 2.456a.75.75 0 01-1.442 0C6.859 3.486 5.623 2.5 4.25 2.5zM8 14.25l-.345.666-.002-.001-.006-.003-.018-.01a7.643 7.643 0 01-.31-.17 22.075 22.075 0 01-3.434-2.414C2.045 10.731 0 8.35 0 5.5 0 2.836 2.086 1 4.25 1 5.797 1 7.153 1.802 8 3.02 8.847 1.802 10.203 1 11.75 1 13.914 1 16 2.836 16 5.5c0 2.85-2.045 5.231-3.885 6.818a22.08 22.08 0 01-3.744 2.584l-.018.01-.006.003h-.002L8 14.25zm0 0l.345.666a.752.752 0 01-.69 0L8 14.25z\"></path></svg>,\n\treport: <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 16 16\" width=\"16\" height=\"16\"><path fill-rule=\"evenodd\" d=\"M1.75 1.5a.25.25 0 00-.25.25v9.5c0 .138.112.25.25.25h2a.75.75 0 01.75.75v2.19l2.72-2.72a.75.75 0 01.53-.22h6.5a.25.25 0 00.25-.25v-9.5a.25.25 0 00-.25-.25H1.75zM0 1.75C0 .784.784 0 1.75 0h12.5C15.216 0 16 .784 16 1.75v9.5A1.75 1.75 0 0114.25 13H8.06l-2.573 2.573A1.457 1.457 0 013 14.543V13H1.75A1.75 1.75 0 010 11.25v-9.5zM9 9a1 1 0 11-2 0 1 1 0 012 0zm-.25-5.25a.75.75 0 00-1.5 0v2.5a.75.75 0 001.5 0v-2.5z\"></path></svg>,\n\tsync: <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 16 16\" width=\"16\" height=\"16\"><path fill-rule=\"evenodd\" d=\"M8 2.5a5.487 5.487 0 00-4.131 1.869l1.204 1.204A.25.25 0 014.896 6H1.25A.25.25 0 011 5.75V2.104a.25.25 0 01.427-.177l1.38 1.38A7.001 7.001 0 0114.95 7.16a.75.75 0 11-1.49.178A5.501 5.501 0 008 2.5zM1.705 8.005a.75.75 0 01.834.656 5.501 5.501 0 009.592 2.97l-1.204-1.204a.25.25 0 01.177-.427h3.646a.25.25 0 01.25.25v3.646a.25.25 0 01-.427.177l-1.38-1.38A7.001 7.001 0 011.05 8.84a.75.75 0 01.656-.834z\"></path></svg>,\t\n\tx: <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 16 16\" width=\"16\" height=\"16\"><path fill-rule=\"evenodd\" d=\"M3.72 3.72a.75.75 0 011.06 0L8 6.94l3.22-3.22a.75.75 0 111.06 1.06L9.06 8l3.22 3.22a.75.75 0 11-1.06 1.06L8 9.06l-3.22 3.22a.75.75 0 01-1.06-1.06L6.94 8 3.72 4.78a.75.75 0 010-1.06z\"></path></svg>,\n}\n","export const Versions = ['1.16.5', '1.17.1', '21w44a', '1.18.1', '1.18.2', '1.19'] as const\nexport type Version = typeof Versions[number]\n\nexport namespace Version {\n\texport const DEFAULT_SOURCE: Version = '1.17.1'\n\texport const DEFAULT_TARGET: Version = '1.18.1'\n\n\texport function ord(version: Version): number {\n\t\treturn Versions.indexOf(version)\n\t}\n\n\texport function order(before: Version, after: Version) {\n\t\treturn ord(before) < ord(after)\n\t}\n\n\texport function includes(source: Version, target: Version, from: Version, to: Version) {\n\t\treturn ord(source) < ord(to) && ord(target) > ord(from)\n\t}\n\n\texport function includesInclusive(source: Version, target: Version, from: Version, to: Version) {\n\t\treturn ord(source) <= ord(to) && ord(target) >= ord(from)\n\t}\n\n\texport function isWorkInProgress(source: Version, target: Version) {\n\t\treturn Version.includes(source, target, '1.18.2', '1.19')\n\t}\n}\n","import type { categories, Pack, PackFile } from './Pack'\nimport { Version } from './Version'\n\nexport type Fix = (pack: Pack, ctx: FixContext) => Promise<unknown>\n\nexport namespace Fix {\n\t/**\n\t * Runs each fix after each other\n\t */\n\texport function all(...fixes: Fix[]): Fix {\n\t\treturn async (pack, ctx) => {\n\t\t\tfor (const fix of fixes) {\n\t\t\t\tawait fix(pack, ctx)\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * A simple fix that runs on one file category\n\t */\n\texport function onFile(category: typeof categories[number] | 'functions', fix: (file: PackFile, ctx: FixContext) => unknown): Fix {\n\t\treturn async (pack, ctx) => {\n\t\t\tfor (const file of pack.data[category]) {\n\t\t\t\tif (file.error || file.deleted) continue\n\t\t\t\tconst fileCtx: FixContext = {\n\t\t\t\t\t...ctx,\n\t\t\t\t\twarn: (message: string) => ctx.warn(message, [file.name]),\n\t\t\t\t}\n\t\t\t\ttry {\n\t\t\t\t\tawait fix(file, fileCtx)\n\t\t\t\t} catch (e: any) {\n\t\t\t\t\te.message = `Error fixing ${category.replace(/^worldgen\\//, '').replaceAll('_', ' ')} ${file.name}: ${e.message}`\n\t\t\t\t\tthrow e\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\texport function groupProblems(...fixes: Fix[]): Fix {\n\t\treturn async (pack, ctx) => {\n\t\t\t// Mapping messages to a list of affected files\n\t\t\tconst problems: Record<string, string[]> = {}\n\t\t\tconst groupCtx = {\n\t\t\t\t...ctx,\n\t\t\t\twarn: (message: string, files?: string[]) => {\n\t\t\t\t\tif (files === undefined) {\n\t\t\t\t\t\tproblems[message] = []\n\t\t\t\t\t} else {\n\t\t\t\t\t\tfiles.forEach(file => {\n\t\t\t\t\t\t\t(problems[message] ??= []).push(file)\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t}\n\t\t\tawait Fix.all(...fixes)(pack, groupCtx)\n\t\t\tObject.entries(problems).forEach(([message, files]) =>\n\t\t\t\tctx.warn(message, [...new Set(files)]))\n\t\t}\n\t}\n\n\texport function when(key: keyof FixConfig, ...fixes: Fix[]): Fix {\n\t\treturn async (pack, ctx) => {\n\t\t\tif (ctx.config(key)) {\n\t\t\t\tawait Fix.all(...fixes)(pack, ctx)\n\t\t\t}\n\t\t}\n\t}\n\n\texport function assert(predicate: (pack: Pack, ctx: FixContext) => boolean, message: string): Fix {\n\t\treturn async (pack, ctx) => {\n\t\t\tif (!predicate(pack, ctx)) {\n\t\t\t\tthrow new Error(message)\n\t\t\t}\n\t\t}\n\t}\n\n\texport function version(from: Version, to: Version, ...fixes: Fix[]): Fix {\n\t\treturn async (pack, ctx) => {\n\t\t\tif (Version.includes(ctx.source(), ctx.target(), from, to)) {\n\t\t\t\tawait Fix.all(...fixes)(pack, ctx)\n\t\t\t}\n\t\t}\n\t}\n\n\texport function versionInclusive(from: Version, to: Version, ...fixes: Fix[]): Fix {\n\t\treturn async (pack, ctx) => {\n\t\t\tif (Version.includesInclusive(ctx.source(), ctx.target(), from, to)) {\n\t\t\t\tawait Fix.all(...fixes)(pack, ctx)\n\t\t\t}\n\t\t}\n\t}\n\n\texport function debug(message: string): Fix {\n\t\treturn async () => {\n\t\t\tconsole.debug(message)\n\t\t}\n\t}\n\n\texport function packFormat(format: number): Fix {\n\t\treturn Fix.all(\n\t\t\tFix.assert(pack => pack.meta.data.pack.pack_format < format, `This pack already has pack_format ${format} or higher and cannot be upgraded.`),\n\t\t\tFix.when('packFormat', async pack => pack.meta.data.pack.pack_format = format),\n\t\t)\n\t}\n\n\texport function rename(from: string, to: string): Fix {\n\t\treturn async (pack) => {\n\t\t\tpack.data[to] = pack.data[from].map(f => ({ ...f }))\n\t\t\tpack.data[from].forEach((file) => file.deleted = true)\n\t\t}\n\t}\n}\n\nexport type FixConfig = {\n\tfunctions: boolean,\n\tids: boolean,\n\tpredicates: boolean,\n\tworldgen: boolean,\n\tpackFormat: boolean,\n\tfeatureCycles: boolean,\n}\n\nexport interface FixContext {\n\twarn: (message: string, files?: string[], info?: string[]) => unknown\n\tconfig: (key: keyof FixConfig) => boolean\n\tread: (category: string, name: string) => PackFile | undefined,\n\tcreate: (category: string, name: string, data: any) => unknown,\n\tsource: () => Version,\n\ttarget: () => Version,\n\tprompt: (title: string, prompt?: string, actions?: string[], info?: string[]) => Promise<string>,\n}\n","import { Fix } from '../../Fix'\n\n/**\n * Adds the new config properties to configured carvers\n */\nexport const Carver = Fix.all(\n\tFix.onFile('worldgen/configured_carver', ({ data }) => fixCarver(data)),\n\tFix.onFile('worldgen/biome', ({ data }) => {\n\t\tif (typeof data.carvers === 'object') {\n\t\t\tdata.carvers.air?.forEach(fixCarver)\n\t\t\tdata.carvers.liquid?.forEach(fixCarver)\n\t\t}\n\t}),\n)\n\nfunction fixCarver(data: any) {\n\tif (typeof data !== 'object') return\n\tconst type = data.type.replace(/^minecraft:/, '')\n\n\tdata.config.lava_level = { above_bottom: 10 }\n\tdata.config.aquifers_enabled = false\n\tif (type === 'cave' || type === 'underwater_cave' || type === 'nether_cave') {\n\t\tif (type === 'nether_cave') {\n\t\t\tdata.config.y = {\n\t\t\t\ttype: 'minecraft:uniform',\n\t\t\t\tmin_inclusive: { absolute: 0 },\n\t\t\t\tmax_inclusive: { below_top: 1 },\n\t\t\t}\n\t\t} else {\n\t\t\tdata.config.y = {\n\t\t\t\ttype: 'minecraft:biased_to_bottom',\n\t\t\t\tmin_inclusive: { absolute: 0 },\n\t\t\t\tmax_inclusive: { absolute: 127 },\n\t\t\t\tinner: 8,\n\t\t\t}\n\t\t}\n\t\tdata.config.yScale = 0.5\n\t\tdata.config.horizontal_radius_multiplier = 1\n\t\tdata.config.vertical_radius_multiplier = 1\n\t\tdata.config.floor_level = -0.7\n\t} else {\n\t\tdata.config.y = {\n\t\t\ttype: 'minecraft:biased_to_bottom',\n\t\t\tmin_inclusive: { absolute: 20 },\n\t\t\tmax_inclusive: { absolute: 67 },\n\t\t\tinner: 8,\n\t\t}\n\t\tdata.config.yScale = 3\n\t\tdata.config.vertical_rotation = {\n\t\t\ttype: 'minecraft:uniform',\n\t\t\tvalue: { min_inclusive: -0.125, max_exclusive: 0.125 },\n\t\t}\n\t\tdata.config.shape = {\n\t\t\tdistance_factor: {\n\t\t\t\ttype: 'minecraft:uniform',\n\t\t\t\tvalue: { min_inclusive: 0.75, max_exclusive: 1 },\n\t\t\t},\n\t\t\tthickness: {\n\t\t\t\ttype: 'minecraft:trapezoid',\n\t\t\t\tvalue: { min: 0, max: 6, plateau: 2 },\n\t\t\t},\n\t\t\twidth_smoothness: 3,\n\t\t\thorizontal_radius_factor: {\n\t\t\t\ttype: 'minecraft:uniform',\n\t\t\t\tvalue: { min_inclusive: 0.75, max_exclusive: 1 },\n\t\t\t},\n\t\t\tvertical_radius_default_factor: 1,\n\t\t\tvertical_radius_center_factor: 0,\n\t\t}\n\t}\n}\n","import { Fix } from '../../Fix'\n\n/**\n * Adds the \"min_y\" and \"height\" properties to dimension types\n */\nexport const DimensionType = Fix.all(\n\tFix.onFile('dimension_type', ({ data }) => fixDimensionType(data)),\n\tFix.onFile('dimension', ({ data }) => {\n\t\tif (typeof data.type === 'object') {\n\t\t\tfixDimensionType(data.type)\n\t\t}\n\t}),\n)\n\nfunction fixDimensionType(data: any) {\n\tdata.min_y = 0\n\tdata.height = 256\n}\n","import type { FixContext } from '../../Fix'\nimport { Fix } from '../../Fix'\n\nexport const Feature = Fix.all(\n\tFix.onFile('worldgen/configured_feature', ({ data }, ctx) => fixFeature(data, ctx)),\n\tFix.onFile('worldgen/biome', ({ data }) => {\n\t\tif (Array.isArray(data.starts)) {\n\t\t\tdata.starts.forEach(fixFeature)\n\t\t}\n\t}),\n)\n\nfunction fixFeature(data: any, ctx: FixContext) {\n\tif (typeof data !== 'object') return\n\n\tconst type = data.type.replace(/^minecraft:/, '')\n\tswitch (type) {\n\t\tcase 'basalt_columns':\n\t\t\tfixUniformInt(data.config, 'reach')\n\t\t\tfixUniformInt(data.config, 'height')\n\t\t\tbreak\n\t\tcase 'decorated':\n\t\t\tfixDecorator(data.config.decorator, ctx)\n\t\t\tfixFeature(data.config.feature, ctx)\n\t\t\tbreak\n\t\tcase 'delta_feature':\n\t\t\tfixUniformInt(data.config, 'size')\n\t\t\tfixUniformInt(data.config, 'rim_size')\n\t\t\tbreak\n\t\tcase 'disk':\n\t\tcase 'ice_patch':\n\t\t\tfixUniformInt(data.config, 'radius')\n\t\t\tbreak\n\t\tcase 'emerald_ore':\n\t\t\tdata.type = 'minecraft:replace_single_block',\n\t\t\tdata.config = { targets: [ {\n\t\t\t\ttarget: {\n\t\t\t\t\tpredicate_type: 'minecraft:blockstate_match',\n\t\t\t\t\tblock_state: data.config.target,\n\t\t\t\t},\n\t\t\t\tstate: data.config.state,\n\t\t\t} ] }\n\t\t\tbreak\n\t\tcase 'flower':\n\t\tcase 'no_bonemeal_flower':\n\t\tcase 'random_patch':\n\t\t\tconst placer = data.config.block_placer\n\t\t\tif (placer.type.replace(/^minecraft:/, '') === 'column_placer') {\n\t\t\t\tplacer.size = {\n\t\t\t\t\ttype: 'minecraft:uniform',\n\t\t\t\t\tvalue: {\n\t\t\t\t\t\tmin_inclusive: placer.min_size,\n\t\t\t\t\t\tmax_inclusive: placer.min_size + placer.extra_size,\n\t\t\t\t\t},\n\t\t\t\t}\n\t\t\t\tdelete placer.min_size\n\t\t\t\tdelete placer.extra_size\n\t\t\t}\n\t\t\tbreak\n\t\tcase 'fossil':\n\t\t\tdata.config = {\n\t\t\t\tmax_empty_corners_allowed: 4,\n\t\t\t\tfossil_processors: 'minecraft:fossil_rot',\n\t\t\t\toverlay_processors: 'minecraft:fossil_coal',\n\t\t\t\tfossil_structures: [\n\t\t\t\t\t'minecraft:fossil/spine_1',\n\t\t\t\t\t'minecraft:fossil/spine_2',\n\t\t\t\t\t'minecraft:fossil/spine_3',\n\t\t\t\t\t'minecraft:fossil/spine_4',\n\t\t\t\t\t'minecraft:fossil/skull_1',\n\t\t\t\t\t'minecraft:fossil/skull_2',\n\t\t\t\t\t'minecraft:fossil/skull_3',\n\t\t\t\t\t'minecraft:fossil/skull_4',\n\t\t\t\t],\n\t\t\t\toverlay_structures: [\n\t\t\t\t\t'minecraft:fossil/spine_1_coal',\n\t\t\t\t\t'minecraft:fossil/spine_2_coal',\n\t\t\t\t\t'minecraft:fossil/spine_3_coal',\n\t\t\t\t\t'minecraft:fossil/spine_4_coal',\n\t\t\t\t\t'minecraft:fossil/skull_1_coal',\n\t\t\t\t\t'minecraft:fossil/skull_2_coal',\n\t\t\t\t\t'minecraft:fossil/skull_3_coal',\n\t\t\t\t\t'minecraft:fossil/skull_4_coal',\n\t\t\t\t],\n\t\t\t}\n\t\t\tbreak\n\t\tcase 'netherrack_replace_blobs':\n\t\t\tconst r = data.config.radius\n\t\t\tlet min = typeof r === 'number' ? r : r.base\n\t\t\tlet max = typeof r === 'number' ? r : r.base + r.spread\n\t\t\tif (max > 12) {\n\t\t\t\tctx.warn('Feature \"netherrack_replace_blobs\" no longer allows values above 12. Consider increasing the count of this feature.')\n\t\t\t\tmin = Math.min(12, min)\n\t\t\t\tmax = Math.min(12, max)\n\t\t\t}\n\t\t\tif (min === max) {\n\t\t\t\tdata.config.radius = min\n\t\t\t\tbreak\n\t\t\t}\n\t\t\tdata.config.radius = {\n\t\t\t\ttype: 'minecraft:uniform',\n\t\t\t\tvalue: {\n\t\t\t\t\tmin_inclusive: min,\n\t\t\t\t\tmax_inclusive: max,\n\t\t\t\t},\n\t\t\t}\n\t\t\tbreak\n\t\tcase 'no_surface_ore':\n\t\t\tfixOre(data)\n\t\t\tdata.type = 'minecraft:ore'\n\t\t\tdata.config.discard_chance_on_air_exposure = 1\n\t\t\tbreak\n\t\tcase 'ore':\n\t\t\tfixOre(data)\n\t\t\tbreak\n\t\tcase 'random_boolean_selector':\n\t\t\tfixFeature(data.config.feature_false, ctx)\n\t\t\tfixFeature(data.config.feature_true, ctx)\n\t\t\tbreak\n\t\tcase 'random_selector':\n\t\t\tdata.config.features.forEach((e: any) => fixFeature(e.feature, ctx))\n\t\t\tfixFeature(data.config.default, ctx)\n\t\t\tbreak\n\t\tcase 'sea_pickle':\n\t\t\tfixUniformInt(data.config, 'count')\n\t\t\tbreak\n\t\tcase 'simple_block':\n\t\t\tdata.config.to_place = {\n\t\t\t\ttype: 'minecraft:simple_state_provider',\n\t\t\t\tstate: data.config.to_place,\n\t\t\t}\n\t\t\tbreak\n\t\tcase 'simple_random_selector':\n\t\t\tdata.config.features.forEach((feature: any) => fixFeature(feature, ctx))\n\t\t\tbreak\n\t\tcase 'tree':\n\t\t\t['radius', 'offset', 'crown_height', 'height', 'trunk_height']\n\t\t\t\t.forEach(k => fixUniformInt(data.config.foliage_placer, k))\n\t\t\tdata.config.foliage_provider = data.config.leaves_provider\n\t\t\tdelete data.config.leaves_provider\n\t\t\tdata.config.force_dirt = false\n\t\t\tdata.config.dirt_provider = {\n\t\t\t\ttype: 'minecraft:simple_state_provider',\n\t\t\t\tstate: {\n\t\t\t\t\tName: 'minecraft:dirt',\n\t\t\t\t},\n\t\t\t}\n\t\t\tdata.config.sapling_provider = {\n\t\t\t\ttype: 'minecraft:simple_state_provider',\n\t\t\t\tstate: {\n\t\t\t\t\tName: getSapling(data.config.foliage_provider),\n\t\t\t\t\tProperties: {\n\t\t\t\t\t\tstage: '0',\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t}\n\t\t\tdata.type = 'minecraft:decorated'\n\t\t\tdata.config = {\n\t\t\t\tdecorator: {\n\t\t\t\t\ttype: 'decorated',\n\t\t\t\t\tconfig: combinedDecorators(\n\t\t\t\t\t\t{ type: 'minecraft:water_depth_threshold', config: {\n\t\t\t\t\t\t\tmax_water_depth: data.config.max_water_depth,\n\t\t\t\t\t\t} },\n\t\t\t\t\t\t{ type: 'minecraft:heightmap', config: {\n\t\t\t\t\t\t\theightmap: data.config.heightmap,\n\t\t\t\t\t\t} }\n\t\t\t\t\t),\n\t\t\t\t},\n\t\t\t\tfeature: {\n\t\t\t\t\ttype: 'minecraft:tree',\n\t\t\t\t\tconfig: data.config,\n\t\t\t\t},\n\t\t\t}\n\t\t\tdelete data.config.feature.config.max_water_depth\n\t\t\tdelete data.config.feature.config.heightmap\n\t\t\tbreak\n\t}\n}\n\nfunction fixUniformInt(data: any, key: string) {\n\tif (typeof data?.[key] === 'object') {\n\t\tdata[key] = {\n\t\t\ttype: 'minecraft:uniform',\n\t\t\tvalue: {\n\t\t\t\tmin_inclusive: data[key].base,\n\t\t\t\tmax_inclusive: data[key].base + data[key].spread,\n\t\t\t},\n\t\t}\n\t}\n}\n\nfunction fixOre(data: any) {\n\tdata.config.discard_chance_on_air_exposure = 0\n\tdata.config.targets = [{\n\t\ttarget: data.config.target,\n\t\tstate: data.config.state,\n\t}]\n\tdelete data.config.target\n\tdelete data.config.state\n}\n\nfunction getSapling(foliage: any) {\n\tif (foliage.type.replace(/^minecraft:/, '') === 'simple_state_provider') {\n\t\tconst match = foliage.state.Name.match(/^(?:minecraft:)?([a-z_]+)_leaves/)\n\t\tif (match) {\n\t\t\treturn `minecraft:${match[1]}_sapling`\n\t\t}\n\t}\n\treturn 'minecraft:oak_sapling'\n}\n\nfunction fixDecorator(data: any, ctx: FixContext) {\n\tif (typeof data !== 'object') return\n\n\tconst type = data.type.replace(/^minecraft:/, '')\n\tswitch (type) {\n\t\tcase 'carving_mask':\n\t\t\tif (data.config.probability === 0) {\n\t\t\t\tdata.type = 'minecraft:nope'\n\t\t\t\tdata.config = {}\n\t\t\t\tbreak\n\t\t\t}\n\t\t\tconst chance = 1 / data.config.probability\n\t\t\tdata.type = 'minecraft:decorated'\n\t\t\tdata.config = combinedDecorators(\n\t\t\t\t{ type: 'minecraft:carving_mask', config: { step: data.config.step } },\n\t\t\t\t...Number.isInteger(chance) ? [\n\t\t\t\t\t{ type: 'minecraft:chance', config: { chance: chance } },\n\t\t\t\t] : [\n\t\t\t\t\t{ type: 'minecraft:count_extra', config: {\n\t\t\t\t\t\tcount: 0,\n\t\t\t\t\t\textra_count: 1,\n\t\t\t\t\t\textra_chance: data.config.probability,\n\t\t\t\t\t} },\n\t\t\t\t]\n\t\t\t)\n\t\t\tdelete data.config.probability\n\t\t\tbreak\n\t\tcase 'count':\n\t\tcase 'count_multilayer':\n\t\t\tconst c = data.config.count\n\t\t\tlet min0 = typeof c === 'number' ? c : c.base\n\t\t\tlet max0 = typeof c === 'number' ? c : c.base + c.spread\n\t\t\tif (min0 < 0) {\n\t\t\t\tctx.warn(`Decorator \"${type}\" no longer allows negative values.`)\n\t\t\t\tmin0 = Math.max(0, min0)\n\t\t\t\tmax0 = Math.max(0, max0)\n\t\t\t}\n\t\t\tif (min0 === max0) {\n\t\t\t\tdata.config.count = min0\n\t\t\t\tbreak\n\t\t\t}\n\t\t\tdata.config.count = {\n\t\t\t\ttype: 'minecraft:uniform',\n\t\t\t\tvalue: {\n\t\t\t\t\tmin_inclusive: min0,\n\t\t\t\t\tmax_inclusive: max0,\n\t\t\t\t},\n\t\t\t}\n\t\t\tbreak\n\t\tcase 'decorated':\n\t\t\tfixDecorator(data.config.outer, ctx)\n\t\t\tfixDecorator(data.config.inner, ctx)\n\t\t\tbreak\n\t\tcase 'heightmap_world_surface':\n\t\t\tdata.type = 'minecraft:heightmap'\n\t\t\tdata.config = { heightmap: 'WORLD_SURFACE_WG' }\n\t\t\tbreak\n\t\tcase 'top_solid_heightmap':\n\t\t\tdata.type = 'minecraft:heightmap'\n\t\t\tdata.config = { heightmap: 'OCEAN_FLOOR_WG' }\n\t\t\tbreak\n\t\tcase 'heightmap':\n\t\tcase 'heightmap_spread_double':\n\t\t\tdata.config = { heightmap: 'MOTION_BLOCKING' }\n\t\t\tbreak\n\t\tcase 'water_lake':\n\t\t\tdata.type = 'minecraft:decorated'\n\t\t\tdata.config = combinedDecorators(\n\t\t\t\t{ type: 'minecraft:chance', config: { chance: data.config.chance } },\n\t\t\t\t{ type: 'minecraft:square', config: {} },\n\t\t\t\t{ type: 'minecraft:range', config: { height: {\n\t\t\t\t\ttype: 'minecraft:biased_to_bottom',\n\t\t\t\t\tmin_inclusive: { absolute: 0 },\n\t\t\t\t\tmax_inclusive: { absolute: 256 },\n\t\t\t\t\tinner: 8,\n\t\t\t\t} } }\n\t\t\t)\n\t\t\tbreak\n\t\tcase 'lava_lake':\n\t\t\tconst chance2 = data.config.chance / 10\n\t\t\tdata.type = 'minecraft:decorated'\n\t\t\tdata.config = combinedDecorators(\n\t\t\t\t...Number.isInteger(chance2) ? [\n\t\t\t\t\t{ type: 'minecraft:chance', config: { chance: chance2 } },\n\t\t\t\t] : [\n\t\t\t\t\t{ type: 'minecraft:count_extra', config: {\n\t\t\t\t\t\tcount: 0,\n\t\t\t\t\t\textra_count: 1,\n\t\t\t\t\t\textra_chance: 1 / chance2,\n\t\t\t\t\t} },\n\t\t\t\t],\n\t\t\t\t{ type: 'minecraft:square', config: {} },\n\t\t\t\t{ type: 'minecraft:range', config: { height: {\n\t\t\t\t\ttype: 'minecraft:biased_to_bottom',\n\t\t\t\t\tmin_inclusive: { absolute: 0 },\n\t\t\t\t\tmax_inclusive: { absolute: 256 },\n\t\t\t\t\tinner: 8,\n\t\t\t\t} } },\n\t\t\t\t{ type: 'minecraft:lava_lake', config: { chance: 10 } },\n\t\t\t)\n\t\t\tbreak\n\t\tcase 'fire':\n\t\t\tconst count = typeof data.config.count === 'number' ? data.config.count : data.config.count.base + data.config.count.spread / 2\n\t\t\tdata.type = 'minecraft:decorated'\n\t\t\tdata.config = combinedDecorators(\n\t\t\t\t{ type: 'minecraft:count', config: { count: {\n\t\t\t\t\ttype: 'minecraft:biased_to_bottom', value: {\n\t\t\t\t\t\tmin_inclusive: 0,\n\t\t\t\t\t\tmax_inclusive: Math.ceil(count / 2),\n\t\t\t\t\t},\n\t\t\t\t} } },\n\t\t\t\t{ type: 'minecraft:square', config: {} },\n\t\t\t\t{ type: 'minecraft:range', config: { height: {\n\t\t\t\t\ttype: 'minecraft:uniform',\n\t\t\t\t\tmin_inclusive: { absolute: 4 },\n\t\t\t\t\tmax_inclusive: { absolute: 252 },\n\t\t\t\t} } },\n\t\t\t)\n\t\t\tbreak\n\t\tcase 'glowstone':\n\t\t\tconst count2 = typeof data.config.count === 'number' ? data.config.count : data.config.count.base + data.config.count.spread / 2\n\t\t\tdata.type = 'minecraft:decorated'\n\t\t\tdata.config = combinedDecorators(\n\t\t\t\t{ type: 'minecraft:count', config: { count: {\n\t\t\t\t\ttype: 'minecraft:biased_to_bottom', value: {\n\t\t\t\t\t\tmin_inclusive: 0,\n\t\t\t\t\t\tmax_inclusive: Math.ceil(count2 - 1),\n\t\t\t\t\t},\n\t\t\t\t} } },\n\t\t\t\t{ type: 'minecraft:square', config: {} },\n\t\t\t\t{ type: 'minecraft:range', config: { height: {\n\t\t\t\t\ttype: 'minecraft:uniform',\n\t\t\t\t\tmin_inclusive: { absolute: 4 },\n\t\t\t\t\tmax_inclusive: { absolute: 252 },\n\t\t\t\t} } },\n\t\t\t)\n\t\t\tbreak\n\t\tcase 'range':\n\t\t\tconst min = data.config.bottom_offset\n\t\t\tconst max = data.config.bottom_offset + data.config.maximum - data.config.top_offset - 1\n\t\t\tif (min === max) {\n\t\t\t\tdata.config = {\n\t\t\t\t\theight: { absolute: min },\n\t\t\t\t}\n\t\t\t\tbreak\n\t\t\t}\n\t\t\tdata.config = {\n\t\t\t\theight: {\n\t\t\t\t\ttype: 'minecraft:uniform',\n\t\t\t\t\tmin_inclusive: { absolute: min },\n\t\t\t\t\tmax_inclusive: { absolute: max },\n\t\t\t\t},\n\t\t\t}\n\t\t\tbreak\n\t\tcase 'range_biased':\n\t\t\tconst min2 = data.config.bottom_offset\n\t\t\tconst max2 = data.config.bottom_offset + data.config.maximum - data.config.top_offset - 1\n\t\t\tdata.type = 'minecraft:range'\n\t\t\tdata.config = {\n\t\t\t\theight: {\n\t\t\t\t\ttype: 'minecraft:biased_to_bottom',\n\t\t\t\t\tmin_inclusive: { absolute: min2 },\n\t\t\t\t\tmax_inclusive: { absolute: max2 },\n\t\t\t\t\tcutoff: min2,\n\t\t\t\t},\n\t\t\t}\n\t\t\tbreak\n\t\tcase 'range_very_biased':\n\t\t\tconst min3 = data.config.bottom_offset\n\t\t\tconst max3 = data.config.bottom_offset + data.config.maximum - data.config.top_offset - 1\n\t\t\tdata.type = 'minecraft:range'\n\t\t\tdata.config = {\n\t\t\t\theight: {\n\t\t\t\t\ttype: 'minecraft:very_biased_to_bottom',\n\t\t\t\t\tmin_inclusive: { absolute: min3 },\n\t\t\t\t\tmax_inclusive: { absolute: max3 },\n\t\t\t\t\tcutoff: min3,\n\t\t\t\t},\n\t\t\t}\n\t\t\tbreak\n\t\tcase 'depth_average':\n\t\t\tdata.type = 'minecraft:range'\n\t\t\tdata.config = {\n\t\t\t\theight: {\n\t\t\t\t\ttype: 'minecraft:trapezoid',\n\t\t\t\t\tmin_inclusive: { absolute: data.config.baseline },\n\t\t\t\t\tmax_inclusive: { absolute: data.config.baseline + data.config.spread },\n\t\t\t\t},\n\t\t\t}\n\t\t\tbreak\n\t\tcase 'emerald_ore':\n\t\t\tdata.type = 'minecraft:decorated'\n\t\t\tdata.config = combinedDecorators(\n\t\t\t\t{ type: 'minecraft:count', config: { count: {\n\t\t\t\t\ttype: 'minecraft:uniform',\n\t\t\t\t\tvalue: { min_inclusive: 3, max_inclusive: 8 },\n\t\t\t\t} } },\n\t\t\t\t{ type: 'minecraft:square', config: {} },\n\t\t\t\t{ type: 'minecraft:range', config: { height: {\n\t\t\t\t\ttype: 'minecraft:uniform',\n\t\t\t\t\tmin_inclusive: { absolute: 4 },\n\t\t\t\t\tmax_inclusive: { absolute: 31 },\n\t\t\t\t} } }\n\t\t\t)\n\t\t\tbreak\n\t\tcase 'end_island':\n\t\t\tdata.type = 'minecraft:decorated'\n\t\t\tdata.config = combinedDecorators(\n\t\t\t\t{ type: 'minecraft:chance', config: { chance: 14 } },\n\t\t\t\t{ type: 'minecraft:count_extra', config: {\n\t\t\t\t\tcount: 1,\n\t\t\t\t\textra_count: 1,\n\t\t\t\t\textra_chance: 0.25,\n\t\t\t\t} },\n\t\t\t\t{ type: 'minecraft:square', config: {} },\n\t\t\t\t{ type: 'minecraft:range', config: { height: {\n\t\t\t\t\ttype: 'minecraft:uniform',\n\t\t\t\t\tmin_inclusive: { absolute: 55 },\n\t\t\t\t\tmax_inclusive: { absolute: 70 },\n\t\t\t\t} } }\n\t\t\t)\n\t\t\tbreak\n\t\tcase 'magma':\n\t\t\tctx.warn('Removed decorator \"magma\" previously used the sea level. Assumed sea level is 32 and replaced with a range decorator between 27 and 36.')\n\t\t\tdata.type = 'minecraft:range'\n\t\t\tdata.config = { height: {\n\t\t\t\ttype: 'minecraft:uniform',\n\t\t\t\tmin_inclusive: { absolute: 27 },\n\t\t\t\tmax_inclusive: { absolute: 36 },\n\t\t\t} }\n\t\t\tbreak\n\t}\n}\n\nfunction combinedDecorators(...decorators: any[]): any {\n\treturn {\n\t\touter: decorators[0],\n\t\tinner: decorators.length === 2 ? decorators[1] : {\n\t\t\ttype: 'minecraft:decorated',\n\t\t\tconfig: combinedDecorators(...decorators.slice(1)),\n\t\t},\n\t}\n}\n","import { Fix } from '../../Fix'\n\nconst replaceitemRegex = /replaceitem ((?:entity @[parse](\\[.*\\]*)?|block( [^ ]+){3}) [a-z0-9.]+) /\nconst timeObjectiveRegex = /scoreboard objectives add ([^ ]+) (minecraft.)?custom:(minecraft.)?play_one_minute/\n\n/**\n * Upgrades /replaceitem to /item replace ... with\n */\nexport const Function = Fix.onFile('functions', ({ data }: { data: string[] }) => {\n\tdata.forEach((line, i) => {\n\t\tif (line.startsWith('replaceitem ') || line.startsWith('execute ')) {\n\t\t\tdata[i] = data[i].replace(replaceitemRegex, 'item replace $1 with ')\n\t\t}\n\t\tif (line.startsWith('scoreboard') || line.startsWith('execute')) {\n\t\t\tdata[i] = data[i].replace(timeObjectiveRegex, 'scoreboard objectives add $1 $2custom:$3play_time')\n\t\t}\n\t})\n})\n","import { Fix } from '../../Fix'\n\n/**\n * Renames grass_path to dirt_path\n */\nexport const Ids = Fix.all(\n\tFix.onFile('tags/blocks', ({ data }) => fixTag(data)),\n\tFix.onFile('tags/items', ({ data }) => fixTag(data)),\n)\n\nfunction fixTag(data: any) {\n\tdata.values?.forEach((_: any, i: number) => fixIds(data.values, i))\n}\n\nexport function fixIds(data: any, key: string | number) {\n\tconst id = data[key].replace(/^minecraft:/, '')\n\n\tif (id === 'grass_path') {\n\t\tdata[key] = 'minecraft:dirt_path'\n\t}\n}\n","import { Fix } from '../../Fix'\n\n/**\n * Adds the \"min_y\" and \"height\" properties to dimension types\n */\nexport const NoiseSettings = Fix.all(\n\tFix.onFile('worldgen/noise_settings', ({ data }) => fixNoiseSettings(data)),\n\tFix.onFile('dimension', ({ data }) => {\n\t\tif (data.generator?.type?.replace(/^minecraft:/, '') === 'noise') {\n\t\t\tfixNoiseSettings(data.generator.settings)\n\t\t}\n\t}),\n)\n\nfunction fixNoiseSettings(data: any) {\n\tif (typeof data !== 'object') return\n\n\tif (data.bedrock_roof_position <= -10) data.bedrock_roof_position = -2147483648\n\tif (data.bedrock_floor_position <= -10) data.bedrock_floor_position = -2147483648\n\n\tdata.min_surface_level = 0\n\tdata.noise_caves_enabled = false\n\tdata.noodle_caves_enabled = false\n\tdata.aquifers_enabled = false\n\tdata.deepslate_enabled = false\n\tdata.ore_veins_enabled = false\n\tdata.noise.min_y = 0\n}\n","import { Fix } from '../../Fix'\n\n/**\n * Fixes item and block predicates all over predicates, advancements and loot tables\n */\nexport const Predicates = Fix.all(\n\tFix.onFile('predicates', ({ data }) => {\n\t\tif (Array.isArray(data)) {\n\t\t\tdata.forEach(fixCondition)\n\t\t} else {\n\t\t\tfixCondition(data)\n\t\t}\n\t}),\n\tFix.onFile('advancements', ({ data }) => {\n\t\tObject.values(data.criteria).forEach(fixCriterion)\n\t}),\n\tFix.onFile('loot_tables', ({ data }) => {\n\t\tdata.pools?.forEach(fixPool)\n\t}),\n)\n\nfunction fixCriterion(data: any) {\n\tif (typeof data.conditions !== 'object') return\n\n\tfixEntity(data.conditions.entity)\n\tfixEntity(data.conditions.player)\n\tfixEntity(data.conditions.parent)\n\tfixEntity(data.conditions.partner)\n\tfixEntity(data.conditions.child)\n\tfixEntity(data.conditions.villager)\n\tfixEntity(data.conditions.zombie)\n\tfixEntity(data.conditions.projectile)\n\tfixEntity(data.conditions.shooter)\n\tdata.conditions.victims?.forEach(fixEntity)\n\n\tfixItem(data.conditions.item)\n\tdata.conditions.items?.forEach(fixItem)\n\n\tfixDamage(data.conditions.damage)\n\tfixDamage(data.conditions.killing_blow)\n\t\n\tfixLocation(data.conditions.location)\n\tfixLocation(data.conditions.entered)\n\tfixLocation(data.conditions.exited)\n}\n\nfunction fixPool(data: any) {\n\tdata.entries?.forEach(fixEntry)\n\tdata.conditions?.forEach(fixCondition)\n}\n\nfunction fixEntry(data: any) {\n\tdata.children?.forEach(fixEntry)\n\tdata.conditions?.forEach(fixCondition)\n}\n\nfunction fixCondition(data: any) {\n\tconst condition = data.condition.replace(/^minecraft:/, '')\n\tswitch (condition) {\n\t\tcase 'match_tool':\n\t\t\tfixItem(data.predicate)\n\t\t\tbreak\n\t\tcase 'entity_properties':\n\t\t\tfixEntity(data.predicate)\n\t\t\tbreak\n\t\tcase 'damage_source_properties':\n\t\t\tfixDamage(data.predicate)\n\t\t\tbreak\n\t\tcase 'location_check':\n\t\t\tfixLocation(data.predicate)\n\t\t\tbreak\n\t}\n}\n\nfunction fixDamage(data: any) {\n\tif (typeof data !== 'object') return\n\n\tfixEntity(data.source_entity)\n\tfixEntity(data.direct_entity)\n\tfixDamage(data.type)\n}\n\nfunction fixEntity(data: any) {\n\tif (typeof data !== 'object') return\n\n\tif (Array.isArray(data)) {\n\t\tdata.forEach(fixCondition)\n\t\treturn\n\t}\n\n\tif (data.equipment) {\n\t\tObject.values(data.equipment).forEach(fixItem)\n\t}\n\tfixEntity(data.vehicle)\n\tfixEntity(data.targeted_entity)\n\tfixLocation(data.location)\n}\n\nfunction fixLocation(data: any) {\n\tif (typeof data !== 'object') return\n\n\tfixBlock(data.block)\n}\n\nfunction fixItem(data: any) {\n\tif (typeof data !== 'object') return\n\n\tif (data.item) {\n\t\tdata.items = [data.item]\n\t\tdelete data.item\n\t}\n}\n\nfunction fixBlock(data: any) {\n\tif (typeof data !== 'object') return\n\n\tif (data.block) {\n\t\tdata.blocks = [data.block]\n\t\tdelete data.block\n\t}\n}\n","import { Fix } from '../../Fix'\n\n/**\n * Adds the new config property to the nether_fossil structure feature\n */\nexport const StructureFeature = Fix.all(\n\tFix.onFile('worldgen/configured_structure_feature', ({ data }) => fixStructureFeature(data)),\n\tFix.onFile('worldgen/biome', ({ data }) => {\n\t\tif (Array.isArray(data.starts)) {\n\t\t\tdata.starts.forEach(fixStructureFeature)\n\t\t}\n\t}),\n)\n\nfunction fixStructureFeature(data: any) {\n\tif (typeof data !== 'object') return\n\tconst type = data.type.replace(/^minecraft:/, '')\n\n\tif (type === 'nether_fossil') {\n\t\tif (!data.config) data.config = {}\n\t\tdata.config.height = {\n\t\t\ttype: 'minecraft:uniform',\n\t\t\tmin_inclusive: { absolute: 32 },\n\t\t\tmax_inclusive: { below_top: 2 },\n\t\t}\n\t}\n}\n","import { Fix } from '../../Fix'\nimport { Carver } from './Carver'\nimport { DimensionType } from './DimensionType'\nimport { Feature } from './Feature'\nimport { Function } from './Function'\nimport { Ids } from './Ids'\nimport { NoiseSettings } from './NoiseSettings'\nimport { Predicates } from './Predicates'\nimport { StructureFeature } from './StructureFeature'\n\nexport const Fixes17 = Fix.version('1.16.5', '1.17.1', Fix.groupProblems(\n\tFix.debug('1.17 fixes'),\n\tFix.when('ids', Ids),\n\tFix.when('predicates', Predicates),\n\tFix.when('functions', Function),\n\tFix.when('worldgen',\n\t\tDimensionType,\n\t\tNoiseSettings,\n\t\tStructureFeature,\n\t\tCarver,\n\t\tFeature\n\t),\n\tFix.packFormat(7),\n))\n","import type { FixContext } from '../../Fix'\nimport { Fix } from '../../Fix'\nimport type { PackFile } from '../../Pack'\n\nexport const Feature = Fix.all(\n\tFix.onFile('worldgen/configured_feature', fixRootFeature),\n\n\t// Remove or rename vanilla configured features and carvers\n\tFix.onFile('worldgen/biome', ({ data }, ctx) => {\n\t\tdata.player_spawn_friendly = undefined\n\n\t\t;['air', 'liquid'].forEach(step => {\n\t\t\tif (Array.isArray(data.carvers[step])) {\n\t\t\t\tdata.carvers[step] = data.carvers[step].filter((c: any) => !CarverRemovals.has(c.replace(/^minecraft:/, '')))\n\t\t\t}\n\t\t})\n\n\t\tif (!Array.isArray(data.features)) return\n\t\tdata.features = data.features.map((d: any) => {\n\t\t\tif (!Array.isArray(d)) return d\n\t\t\treturn d.flatMap(e => {\n\t\t\t\tif (typeof e !== 'string') return e\n\t\t\t\tconst replacement = fixFeatureId(e, ctx)\n\t\t\t\treplacement.forEach(r => {\n\t\t\t\t\tconst file = ctx.read('worldgen/placed_feature', r)\n\t\t\t\t\tif (!file) return\n\t\t\t\t\tif (file.data.placement.find((p: any) => p.type === 'minecraft:biome')) return\n\t\t\t\t\tfile.data.placement.push({ type: 'minecraft:biome' })\n\t\t\t\t})\n\t\t\t\treturn replacement\n\t\t\t})\n\t\t})\n\t}),\n)\n\nfunction fixFeatureId(str: string, ctx: FixContext) {\n\tconst id = str.replace(/^minecraft:/, '')\n\tif (FeatureReplacements.has(id)) {\n\t\treturn FeatureReplacements.get(id)!.map(e => `minecraft:${e}`)\n\t} else if (FeatureRenames.has(id) || FeatureRenamesPlacement.has(id)) {\n\t\treturn [`minecraft:${FeatureRenames.get(id) ?? FeatureRenamesPlacement.get(id)}`]\n\t} else if (FeatureOnlyConfig.has(id) && ctx.read('worldgen/placed_feature', id) === undefined) {\n\t\treturn []\n\t} else if (FeatureFullyRemoved.has(id)) {\n\t\treturn []\n\t} else {\n\t\treturn [str]\n\t}\n}\n\nfunction fixRootFeature(file: PackFile, ctx: FixContext) {\n\tif (typeof file.data !== 'object') return\n\n\tconst f = fixFeature(file.data, ctx)\n\tif (typeof f.feature === 'string') {\n\t\tfile.data = redirect(fixPlacedFeatureId(f.feature, ctx))\n\t} else {\n\t\tfile.data = {\n\t\t\ttype: f?.feature.type,\n\t\t\tconfig: f?.feature.config,\n\t\t}\n\t\tf.feature = file.name\n\t}\n\tctx.create('worldgen/placed_feature', file.name, {\n\t\tfeature: f.feature,\n\t\tplacement: f?.placement,\n\t})\n}\n\n// Wraps a placed feature in a configured feature\nfunction redirect(placedFeature: unknown) {\n\treturn {\n\t\ttype: 'minecraft:random_selector',\n\t\tconfig: {\n\t\t\tfeatures: [],\n\t\t\tdefault: placedFeature,\n\t\t},\n\t}\n}\n\n/**\n * Fixes a configured feature into a placed feature\n */\nfunction fixFeature(data: any, ctx: FixContext) {\n\tif (typeof data === 'string') {\n\t\tconst id = data.replace(/^minecraft:/, '')\n\t\tif (FeatureFullyRemoved.has(id)) {\n\t\t\tdata = { type: 'minecraft:no_op', config: {} }\n\t\t} else if (FeatureOnlyPlacement.has(id)) {\n\t\t\tdata = redirect(data)\n\t\t} else if (FeatureRenames.has(id) || FeatureRenamesConfig.has(id)) {\n\t\t\tconst configuredFeature = FeatureRenamesConfig.get(id) ?? FeatureRenames.get(id)\n\t\t\tconsole.log(`Rename ${id} -> configured: ${configuredFeature}`)\n\t\t\tdata = `minecraft:${configuredFeature}`\n\t\t} else if (FeatureRenamesPlacement.has(id)) {\n\t\t\tconst placedFeature = FeatureRenamesPlacement.get(id)\n\t\t\tconsole.log(`Redirect ${id} -> placed: ${placedFeature}`)\n\t\t\tdata = redirect(placedFeature)\n\t\t}\n\t\treturn {\n\t\t\tfeature: data,\n\t\t\tplacement: [],\n\t\t}\n\t}\n\n\tif (typeof data !== 'object') throw new Error('Feature is not an object nor a string')\n\n\tconst type = data.type.replace(/^minecraft:/, '')\n\tconst placement: any[] = []\n\tswitch (type) {\n\t\tcase 'decorated':\n\t\t\tconst feature = collectDecorators(data, placement, ctx)\n\t\t\tdata = fixToConfiguredFeature(feature, ctx)\n\t\t\tbreak\n\t\tcase 'glow_lichen':\n\t\t\tdata.config.can_be_placed_on = [...new Set(\n\t\t\t\tdata.config.can_be_placed_on.map((b: any) => b.Name)\n\t\t\t)]\n\t\t\tbreak\n\t\tcase 'lake':\n\t\t\tdata.config = {\n\t\t\t\tfluid: {\n\t\t\t\t\ttype: 'minecraft:simple_state_provider',\n\t\t\t\t\tstate: data.config.state,\n\t\t\t\t},\n\t\t\t\tbarrier: {\n\t\t\t\t\ttype: 'minecraft:simple_state_provider',\n\t\t\t\t\tstate: {\n\t\t\t\t\t\tName: 'minecraft:stone',\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t}\n\t\t\tbreak\n\t\tcase 'nether_forest_vegetation':\n\t\t\tdata.config.spread_width = 8\n\t\t\tdata.config.spread_height = 4\n\t\t\tbreak\n\t\tcase 'random_boolean_selector':\n\t\t\tdata.config.feature_false = fixToPlacedFeature(data.config.feature_false, ctx)\n\t\t\tdata.config.feature_true = fixToPlacedFeature(data.config.feature_true, ctx)\n\t\t\tbreak\n\t\tcase 'root_system':\n\t\t\tdata.config.allowed_tree_position = { type: 'minecraft:true' }\n\t\t// eslint-disable-next-line no-fallthrough\n\t\tcase 'random_patch':\n\t\tcase 'flower':\n\t\tcase 'no_bonemeal_flower':\n\t\t\tdata.config.feature = fixToPlacedFeature(data.config.feature, ctx)\n\t\t\tbreak\n\t\tcase 'random_selector':\n\t\t\tdata.config.features.forEach((e: any) => {\n\t\t\t\te.feature = fixToPlacedFeature(e.feature, ctx)\n\t\t\t})\n\t\t\tdata.config.default = fixToPlacedFeature(data.config.default, ctx)\n\t\t\tbreak\n\t\tcase 'simple_random_selector':\n\t\t\tdata.config.features = data.config.features.map((f: any) => {\n\t\t\t\treturn fixToPlacedFeature(f, ctx)\n\t\t\t})\n\t\t\tbreak\n\t\tcase 'twisting_vines':\n\t\t\tdata.config = {\n\t\t\t\tspread_width: 8,\n\t\t\t\tspread_height: 4,\n\t\t\t\tmax_height: 8,\n\t\t\t}\n\t\t\tbreak\n\t\tcase 'vegetation_patch':\n\t\tcase 'waterlogged_vegetation_patch':\n\t\t\tdata.config.vegetation_feature = fixToPlacedFeature(data.config.vegetation_feature, ctx)\n\t}\n\treturn {\n\t\tfeature: data,\n\t\tplacement,\n\t}\n}\n\n/**\n * Fixes a configured feature and then returns it as a reference to a placed feature\n */\nfunction fixToPlacedFeature(data: any, ctx: FixContext) {\n\tconst f = fixFeature(data, ctx)\n\tif (typeof f.feature === 'string' && f.placement.length === 0) {\n\t\treturn fixPlacedFeatureId(f.feature, ctx)\n\t}\n\treturn f\n}\n\nfunction fixPlacedFeatureId(feature: string, ctx: FixContext) {\n\tconst id = feature.replace(/^minecraft:/, '')\n\tif (FeatureRenames.has(id) || FeatureRenamesPlacement.has(id)) {\n\t\tconst placedFeature = FeatureRenamesPlacement.get(id) ?? FeatureRenames.get(id)\n\t\tconsole.log(`Rename placement: ${id} -> ${placedFeature}`)\n\t\treturn `minecraft:${placedFeature}`\n\t}\n\tif (!FeatureOnlyConfig.has(id) && ctx.read('worldgen/configured_feature', id) === undefined) {\n\t\tconsole.log(`No placement: ${id}`)\n\t\treturn feature\n\t}\n\treturn {\n\t\tfeature,\n\t\tplacement: [],\n\t}\n}\n\n/**\n * Fixes a configured feature and then returns it as a reference to a configured feature\n */\nfunction fixToConfiguredFeature(data: any, ctx: FixContext) {\n\tconst f = fixFeature(data, ctx)\n\tif (typeof f.feature === 'string' && f.placement.length === 0) {\n\t\tconst id = f.feature.replace(/^minecraft:/, '')\n\t\tif (FeatureRenames.has(id) || FeatureRenamesConfig.has(id)) {\n\t\t\tconst configuredFeature = FeatureRenamesConfig.get(id) ?? FeatureRenames.get(id)\n\t\t\tconsole.log(`Rename config: ${id} -> ${configuredFeature}`)\n\t\t\treturn `minecraft:${configuredFeature}`\n\t\t}\n\t\tif (FeatureOnlyPlacement.has(id)) {\n\t\t\treturn redirect(f.feature)\n\t\t}\n\t}\n\treturn f.feature\n}\n\n/**\n * Converts a configured decorator to a list of placement modifiers\n */\nfunction fixDecorator(data: any, ctx: FixContext): any[] {\n\tif (typeof data !== 'object') return []\n\n\tconst type = data.type.replace(/^minecraft:/, '')\n\tswitch (type) {\n\t\tcase 'block_filter':\n\t\t\treturn [{ type: 'minecraft:block_predicate_filter', ...data.config }]\n\t\tcase 'cave_surface':\n\t\t\tconst steps = data.config.floor_to_ceiling_search_range\n\t\t\tif (steps > 32) {\n\t\t\t\tctx.warn('Converting cave_surface decorator into environment_scan: \"max_steps\" is limited to 32.')\n\t\t\t}\n\t\t\tconst config = {\n\t\t\t\tdirection_of_search: data.config.surface === 'ceiling' ? 'up' : 'down',\n\t\t\t\ttarget_condition: {\n\t\t\t\t\ttype: 'minecraft:solid',\n\t\t\t\t},\n\t\t\t\tallowed_search_condition: {\n\t\t\t\t\ttype: 'minecraft:matching_blocks',\n\t\t\t\t\tblocks: [\n\t\t\t\t\t\t'minecraft:air',\n\t\t\t\t\t\t...data.config.allow_water ? ['minecraft:water'] : [],\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t\tmax_steps: Math.min(32, steps),\n\t\t\t}\n\t\t\treturn [{ type: 'minecraft:environment_scan', ...config }]\n\t\tcase 'count_multilayer':\n\t\t\treturn [{ type: 'minecraft:count_on_every_layer', ...data.config }]\n\t\tcase 'chance':\n\t\t\treturn [{ type: 'minecraft:rarity_filter', ...data.config }]\n\t\tcase 'count_extra':\n\t\t\tlet max = data.config.count + data.config.extra_count\n\t\t\tif (max > 256) {\n\t\t\t\tlet factors = [max]\n\t\t\t\tmax -= 1\n\t\t\t\twhile (factors.some(f => f > 256)) {\n\t\t\t\t\tmax += 1\n\t\t\t\t\tfactors = primeFactors(max)\n\t\t\t\t}\n\n\t\t\t\tfor (let n = 2; n <= 5; n += 1) {\n\t\t\t\t\tconst counts: number[] = Array(n).fill(1)\n\t\t\t\t\tconst factorsToUse = [...factors]\n\t\t\t\t\touter:\n\t\t\t\t\twhile (factorsToUse.length > 0) {\n\t\t\t\t\t\tconst f = factorsToUse.pop()\n\t\t\t\t\t\tfor (let i = 0; i < n; i += 1) {\n\t\t\t\t\t\t\tif (counts[i] * f <= 256) {\n\t\t\t\t\t\t\t\tcounts[i] *= f\n\t\t\t\t\t\t\t\tcontinue outer\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak\n\t\t\t\t\t}\n\t\t\t\t\tif (factorsToUse.length === 0 && counts.every(p => p <= 256)) {\n\t\t\t\t\t\treturn counts.map(count => ({ type: 'minecraft:count', count }))\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthrow new Error(`Extremely high count: ${data.config.count + data.config.extra_count}`)\n\t\t\t}\n\t\t\tconst count = {\n\t\t\t\ttype: 'minecraft:weighted_list',\n\t\t\t\tdistribution: [\n\t\t\t\t\t{\n\t\t\t\t\t\tweight: Math.round(100 * (1 - data.config.extra_chance)),\n\t\t\t\t\t\tdata: Math.min(256, data.config.count),\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tweight: Math.round(100 * data.config.extra_chance),\n\t\t\t\t\t\tdata: Math.min(256, max),\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t}\n\t\t\treturn [{ type: 'minecraft:count', count }]\n\t\tcase 'count_noise':\n\t\t\treturn [{ type: 'minecraft:noise_threshold_count', ...data.config }]\n\t\tcase 'count_noise_biased':\n\t\t\treturn [{ type: 'minecraft:noise_based_count', ...data.config }]\n\t\tcase 'dark_oak_tree':\n\t\t\treturn [{ type: 'minecraft:count', count: 16 }, { type: 'minecraft:in_square' }]\n\t\tcase 'decorated':\n\t\t\tconst outer = fixDecorator(data.config.outer, ctx)\n\t\t\tconst inner = fixDecorator(data.config.inner, ctx)\n\t\t\treturn [...outer, ...inner]\n\t\tcase 'end_gateway':\n\t\t\tconst y_spread = {\n\t\t\t\ttype: 'minecraft:uniform',\n\t\t\t\tvalue: {\n\t\t\t\t\tmin_inclusive: 3,\n\t\t\t\t\tmax_inclusive: 9,\n\t\t\t\t},\n\t\t\t}\n\t\t\treturn [{ type: 'minecraft:random_offset', xz_spread: 0, y_spread }]\n\t\tcase 'iceberg':\n\t\t\treturn [{ type: 'minecraft:in_square' }]\n\t\tcase 'lava_lake':\n\t\t\treturn [{ type: 'minecraft:rarity_filter', chance: 10 }]\n\t\tcase 'nope':\n\t\t\treturn []\n\t\tcase 'range':\n\t\t\treturn [{ type: 'minecraft:height_range', ...data.config }]\n\t\tcase 'scatter':\n\t\t\treturn [{ type: 'minecraft:random_offset', ...data.config }]\n\t\tcase 'square':\n\t\t\treturn [{ type: 'minecraft:in_square', ...data.config }]\n\t\tcase 'surface_relative_threshold':\n\t\t\treturn [{ type: 'minecraft:surface_relative_threshold_filter', ...data.config }]\n\t\tcase 'water_depth_threshold':\n\t\t\treturn [{ type: 'minecraft:surface_water_depth_filter', ...data.config }]\n\t\tdefault:\n\t\t\treturn [{ type, ...data.config }]\n\t}\n}\n\nfunction collectDecorators(data: any, placement: any[], ctx: FixContext): any {\n\tif (typeof data !== 'object') return data\n\n\tconst type = data.type.replace(/^minecraft:/, '')\n\tif (type === 'decorated') {\n\t\tplacement.push(...fixDecorator(data.config.decorator, ctx))\n\t\treturn collectDecorators(data.config.feature, placement, ctx)\n\t}\n\treturn data\n}\n\nfunction primeFactors(n: number) {\n\tconst factors = []\n\tlet divisor = 2\n\twhile (n >= 2) {\n\t\tif (n % divisor == 0) {\n\t\t\tfactors.push(divisor)\n\t\t\tn = n / divisor\n\t\t} else {\n\t\t\tdivisor += 1\n\t\t}\n\t}\n\treturn factors\n}\n\n// Configured features in 1.17 that were replaced with multiple placed features\nconst FeatureReplacements = new Map(Object.entries({\n\tbirch_other: ['forest_flowers', 'trees_birch_and_oak'],\n\tfossil: ['fossil_upper', 'fossil_lower'],\n\tlake_lava: ['lake_lava_surface', 'lake_lava_underground'],\n\tmonster_room: ['monster_room', 'monster_room_deep'],\n\tore_granite: ['ore_granite_upper', 'ore_granite_lower'],\n\tore_diorite: ['ore_diorite_upper', 'ore_diorite_lower'],\n\tore_andesite: ['ore_andesite_upper', 'ore_andesite_lower'],\n\tore_coal: ['ore_coal_upper', 'ore_coal_lower'],\n\tore_iron: ['ore_iron_upper', 'ore_iron_middle', 'ore_iron_small'],\n\tore_gold: ['ore_gold', 'ore_gold_lower'],\n\tore_redstone: ['ore_redstone', 'ore_redstone_lower'],\n\tore_diamond: ['ore_diamond', 'ore_diamond_large', 'ore_diamond_buried'],\n\tore_lapis: ['ore_lapis', 'ore_lapis_buried'],\n}))\n\n// Configured features in 1.17 that were fully removed\nconst FeatureFullyRemoved = new Set(['lake_water', 'rare_dripstone_cluster', 'rare_small_dripstone', 'ore_deepslate'])\n\n// Configured features in 1.17 that have no corresponding placed feature in 1.18\nconst FeatureOnlyConfig = new Set(['azalea_tree', 'birch_bees_005', 'bonus_chest', 'cave_vine_in_moss', 'clay_pool_with_dripleaves', 'clay_with_dripleaves', 'dripleaf', 'end_gateway_delayed', 'huge_brown_mushroom', 'huge_red_mushroom', 'jungle_tree_no_vine', 'moss_patch', 'moss_patch_bonemeal', 'moss_patch_ceiling', 'moss_vegetation', 'oak_bees_005', 'patch_brown_mushroom', 'patch_red_mushroom', 'spring_lava_double', 'swamp_oak'])\n\n// Configured features in 1.17 that have a corresponding placed feature, but their configured feature was removed.\nconst FeatureOnlyPlacement = new Set(['patch_dead_bush_2'])\n\n// Configured features in 1.17 that got a new name as placed feature and configured feature in 1.18\nconst FeatureRenames = new Map(Object.entries({\n\tbirch_other: 'trees_birch_and_oak',\n\tend_gateway: 'end_gateway_return',\n\tfancy_oak_bees_005: 'fancy_oak_bees',\n\tflower_forest: 'flower_flower_forest',\n\tforest_flower_trees: 'trees_flower_forest',\n\tforest_flower_vegetation: 'forest_flowers',\n\tforest_flower_vegetation_common: 'flower_forest_flowers',\n\tgrove_vegetation: 'trees_grove',\n\tmushroom_field_vegetation: 'mushroom_island_vegetation',\n\tore_debris_large: 'ore_ancient_debris_large',\n\tpatch_waterlilly: 'patch_waterlily',\n\tpine: 'pine_checked',\n\tplain_vegetation: 'trees_plains',\n\trooted_azalea_trees: 'rooted_azalea_tree',\n\ttaiga_vegetation: 'trees_taiga',\n\ttrees_giant: 'trees_old_growth_pine_taiga',\n\ttrees_giant_spruce: 'trees_old_growth_spruce_taiga',\n\ttrees_jungle_edge: 'trees_sparse_jungle',\n\ttrees_mountain: 'trees_windswept_hills',\n}))\n\n// Configured features in 1.17 that got a new name as placed feature in 1.18 but have no configured feature with this new name\nconst FeatureRenamesPlacement = new Map(Object.entries({\n\tacacia: 'acacia_checked',\n\tbirch: 'birch_checked',\n\tbrown_mushroom_giant: 'brown_mushroom_old_growth',\n\tcave_vine: 'cave_vines',\n\tdark_oak: 'dark_oak_checked',\n\tend_island: 'end_island_decorated',\n\tfancy_oak: 'fancy_oak_checked',\n\tflower_plain_decorated: 'flower_plains',\n\tmeadow_trees: 'trees_meadow',\n\tmega_jungle_tree: 'mega_jungle_tree_checked',\n\tmega_pine: 'mega_pine_checked',\n\tred_mushroom_giant: 'red_mushroom_old_growth',\n\tpatch_cactus: 'patch_cactus_decorated',\n\tmega_spruce: 'mega_spruce_checked',\n\tspruce: 'spruce_checked',\n\ttrees_mountain_edge: 'trees_windswept_forest',\n\ttrees_shattered_savanna: 'trees_windswept_savanna',\n}))\n\n// Configured features in 1.17 that got a new name as configured feature in 1.18 but have no placed feature with this new name\nconst FeatureRenamesConfig = new Map(Object.entries({\n\tmega_spruce: 'mega_spruce',\n\tcave_vine: 'cave_vine', // entry is included because the placed feature was renamed\n\tcrimson_fungi_planted: 'crimson_fungus_planted',\n\twarped_fungi_planted: 'warped_fungus_planted',\n}))\n\nconst CarverRemovals = new Set(['ocean_cave', 'prototype_canyon', 'prototype_cave', 'prototype_crevice', 'underwater_canyon', 'underwater_cave'])\n","import type { FixContext } from '../../Fix'\nimport type { Pack } from '../../Pack'\n\ntype FeatureData = {\n\tid: string,\n\tbiome: string,\n\tdepends: Set<string>,\n}\n\nconst STEPS = ['raw_generation', 'lakes', 'local_modifications', 'underground_structures', 'surface_structures', 'strongholds', 'underground_ores', 'underground_decoration', 'fluid_springs', 'vegetal_decoration', 'top_layer_modification']\n\nexport async function CycleOrder(pack: Pack, ctx: FixContext) {\n\tconst biomes = pack.data['worldgen/biome'].filter(f => !f.error)\n\n\tconst biomesWithDuplicates = new Set<string>()\n\tfor (let step = 0; step < STEPS.length; step += 1) {\n\t\tconst features: FeatureData[] = []\n\t\tfor (const biome of biomes) {\n\t\t\tconst stepFeatures: string[] = biome.data.features[step] ?? []\n\t\t\tfor (let index = 0; index < stepFeatures.length; index += 1) {\n\t\t\t\tconst id = stepFeatures[index]\n\t\t\t\tif (features.some(f => f.biome === biome.name && f.id === id)) {\n\t\t\t\t\tbiomesWithDuplicates.add(biome.name)\n\t\t\t\t\tcontinue\n\t\t\t\t}\n\t\t\t\tconst depends = new Set(stepFeatures.slice(0, index))\n\t\t\t\tfeatures.push({ id, biome: biome.name, depends })\n\t\t\t}\n\t\t}\n\n\t\tconst sortedFeatures: FeatureData[] = []\n\t\tconst startFeatures = features.filter(f => features.filter(g => f.id === g.id).every(g => g.depends.size === 0))\n\t\twhile (startFeatures.length > 0) {\n\t\t\tconst node = startFeatures.pop()!\n\t\t\tif (sortedFeatures.some(f => f.id === node.id)) continue\n\t\t\tsortedFeatures.push(node)\n\t\t\tfor (const member of features.filter(f => f.depends.has(node.id))) {\n\t\t\t\tmember.depends.delete(node.id)\n\t\t\t\tif (features.filter(g => member.id === g.id).every(g => g.depends.size === 0)) {\n\t\t\t\t\tstartFeatures.push(member)\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// There is at least one cycle\n\t\tif (features.some(f => f.depends.size > 0)) {\n\t\t\tconst visitedBiomes = new Set<string>()\n\t\t\tconst visitedFeatures = new Set<string>()\n\t\t\tfunction findCycle(node: FeatureData, start: FeatureData, depth: number): false | FeatureData[] {\n\t\t\t\tif (depth <= 0) return false\n\t\t\t\tvisitedBiomes.add(node.biome)\n\t\t\t\tvisitedFeatures.add(node.id)\n\t\t\t\tfor (const dep of node.depends) {\n\t\t\t\t\tif (dep === start.id) {\n\t\t\t\t\t\treturn [start]\n\t\t\t\t\t}\n\t\t\t\t\tif (visitedFeatures.has(dep)) continue\n\t\t\t\t\tfor (const member of features.filter(f => f.id === dep && !visitedBiomes.has(f.biome))) {\n\t\t\t\t\t\tconst cycle = findCycle(member, start, depth - 1)\n\t\t\t\t\t\tif (cycle) {\n\t\t\t\t\t\t\treturn [member, ...cycle]\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tvisitedBiomes.delete(node.biome)\n\t\t\t\treturn false\n\t\t\t}\n\n\t\t\tlet cycle: false | FeatureData[] = false\n\t\t\tconst startCandidates = features.filter(f => f.depends.size > 0)\n\t\t\touter:\n\t\t\tfor (let depth = 2; depth < 10; depth += 1) {\n\t\t\t\tfor (const start of startCandidates) {\n\t\t\t\t\tvisitedBiomes.clear()\n\t\t\t\t\tvisitedFeatures.clear()\n\t\t\t\t\tcycle = findCycle(start, start, depth)\n\t\t\t\t\tif (cycle) break outer\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (cycle) {\n\t\t\t\tconst info = [`Cycle in step ${step} (${STEPS[step]}):`]\n\t\t\t\tfor (let i = cycle.length - 1; i >= 0; i -= 1) {\n\t\t\t\t\tconst node = cycle[i]\n\t\t\t\t\tconst nextNode = cycle[(i + 1 + cycle.length) % cycle.length]\n\t\t\t\t\tinfo.push(` Biome ${node.biome}: '${nextNode.id}' -> '${node.id}'`)\n\t\t\t\t}\n\t\t\t\tctx.warn('!Feature order cycle found. Needs manual fixing.', [], info)\n\t\t\t}\n\t\t}\n\t}\n\n\tif (biomesWithDuplicates.size > 0) {\n\t\tctx.warn('!Detected duplicate features. They are no longer allowed.', [...biomesWithDuplicates])\n\t}\n}\n\n// Code to check if features are in different steps\n/*\n\n\tconst features: FeatureData[] = []\n\tfor (const biome of biomes) {\n\t\tconst biomeFeatures = biome.data.features as string[][]\n\t\tfor (let step = 0; step < biomeFeatures.length; step += 1) {\n\t\t\tconst stepFeatures = biomeFeatures[step] as string[]\n\t\t\tfor (let index = 0; index < stepFeatures.length; index += 1) {\n\t\t\t\tconst feature = stepFeatures[index]\n\t\t\t\tconst before = new Set(stepFeatures.slice(0, index))\n\t\t\t\tconst after = new Set(stepFeatures.slice(index + 1))\n\t\t\t\tfeatures.push({ feature, step, biomes: new Set([biome.name]), before, after })\n\t\t\t}\n\t\t}\n\t}\n\n\t// Detect when a feature appears in multiple steps\n\tconst featureSteps = new Map<string, Set<number>>()\n\tfor (const data of features) {\n\t\tconst steps = featureSteps.get(data.feature)\n\t\tif (steps === undefined) {\n\t\t\tfeatureSteps.set(data.feature, new Set([data.step]))\n\t\t} else {\n\t\t\tsteps.add(data.step)\n\t\t}\n\t}\n\tfor (const [feature, steps] of featureSteps) {\n\t\tif (steps.size > 1) {\n\t\t\tconst choice = parseInt(await ctx.prompt(\n\t\t\t\t`Feature order cycle found: Conflicting steps for feature \"${feature}\"`,\n\t\t\t\t'Which step should it be in?',\n\t\t\t\t[...steps].map(s => s.toFixed())\n\t\t\t))\n\t\t\t// Correct the features which were in a different step\n\t\t\tfeatures.filter(f => f.feature === feature && f.step !== choice).forEach(f => {\n\t\t\t\tf.step = choice\n\t\t\t\tf.before.clear()\n\t\t\t\tf.after.clear()\n\t\t\t})\n\t\t}\n\t}\n\t*/\n","import { Fix } from '../../Fix'\n\nexport const NoiseSettings = Fix.all(\n\tFix.onFile('worldgen/noise_settings', ({ data }) => fixNoiseSettings(data)),\n\tFix.onFile('dimension', ({ data }) => {\n\t\tif (data.generator?.type?.replace(/^minecraft:/, '') === 'noise') {\n\t\t\tfixNoiseSettings(data.generator.settings)\n\t\t}\n\t}),\n)\n\nfunction fixNoiseSettings(data: any) {\n\tfixSurfaceRule(data.surface_rule)\n}\n\nfunction fixSurfaceRule(data: any) {\n\tif (typeof data !== 'object') return\n\n\tconst type = data.type.replace(/^minecraft:/, '')\n\tswitch (type) {\n\t\tcase 'sequence':\n\t\t\tdata.sequence.forEach((s: any) => fixSurfaceRule(s))\n\t\t\tbreak\n\t\tcase 'condition':\n\t\t\tfixSurfaceCondition(data.if_true)\n\t\t\tfixSurfaceRule(data.then_run)\n\t}\n}\n\nfunction fixSurfaceCondition(data: any) {\n\tif (typeof data !== 'object') return\n\tconst condition = data.type.replace(/^minecraft:/, '')\n\tswitch (condition) {\n\t\tcase 'not':\n\t\t\tfixSurfaceCondition(data.invert)\n\t\t\tbreak\n\t\tcase 'stone_depth':\n\t\t\tdata.offset = 0\n\t\t\tdata.add_surface_depth = data.add_run_depth\n\t\t\tdata.add_surface_secondary_depth = false\n\t\t\tdelete data.add_run_depth\n\t\t\tbreak\n\t\tcase 'water':\n\t\tcase 'y_above':\n\t\t\tdata.surface_depth_multiplier = data.run_depth_multiplier\n\t\t\tdelete data.run_depth_multiplier\n\t}\n}\n","import { Fix } from '../../Fix'\nimport { Feature } from './Feature'\nimport { CycleOrder } from './FeatureCycles'\nimport { NoiseSettings } from './NoiseSettings'\n\nexport const Fixes18 = Fix.all(\n\tFix.version('21w44a', '1.18.1', Fix.groupProblems(\n\t\tFix.debug('1.18 fixes'),\n\t\tFix.when('worldgen',\n\t\t\tFeature,\n\t\t\tNoiseSettings\n\t\t),\n\t)),\n\tFix.versionInclusive('1.18.1', '1.18.1',\n\t\tFix.when('featureCycles',\n\t\t\tFix.debug('Checking feature order cycle'),\n\t\t\tCycleOrder\n\t\t)\n\t)\n)\n","import { Fix } from '../../Fix'\n\nexport const Dimension = Fix.all(\n\tFix.onFile('dimension', ({ data }) => fixGenerator(data.generator)),\n)\n\nfunction fixGenerator(data: any) {\n\tif (typeof data !== 'object') return\n\n\tconst type = data.type.replace(/^minecraft:/, '')\n\tswitch (type) {\n\t\tcase 'flat':\n\t\t\tif (typeof data.settings !== 'object') return\n\t\t\tdata.settings.structure_overrides = []\n\t\t\tdelete data.settings.structures\n\t}\n}\n","import { Fix } from '../../Fix'\n\n/**\n * Fix infiniburn tag\n */\nexport const DimensionType = Fix.all(\n\tFix.onFile('dimension_type', ({ data }) => fixDimensionType(data)),\n\tFix.onFile('dimension', ({ data }) => {\n\t\tif (typeof data.type === 'object') {\n\t\t\tfixDimensionType(data.type)\n\t\t}\n\t}),\n)\n\nfunction fixDimensionType(data: any) {\n\tdata.infiniburn = '#' + data.infiniburn\n}\n","import { Fix } from '../../Fix'\n\nexport const Feature = Fix.all(\n\tFix.onFile('worldgen/configured_feature', ({ data }) => fixConfiguredFeature(data)),\n\tFix.onFile('worldgen/placed_feature', ({ data }) => fixPlacedFeature(data)),\n)\n\nfunction fixPlacedFeature(data: any) {\n\tif (typeof data !== 'object') return\n\n\tfixConfiguredFeature(data.feature)\n}\n\nfunction fixConfiguredFeature(data: any) {\n\tif (typeof data !== 'object') return\n\n\tconst type = data.type.replace(/^minecraft:/, '')\n\tswitch (type) {\n\t\tcase 'random_boolean_selector':\n\t\t\tfixPlacedFeature(data.config.feature_false)\n\t\t\tfixPlacedFeature(data.config.feature_true)\n\t\t\tbreak\n\t\tcase 'random_patch':\n\t\tcase 'flower':\n\t\tcase 'no_bonemeal_flower':\n\t\t\tfixPlacedFeature(data.config.feature)\n\t\t\tbreak\n\t\tcase 'random_selector':\n\t\t\tdata.config.features.forEach((e: any) => {\n\t\t\t\tfixPlacedFeature(e.feature)\n\t\t\t})\n\t\t\tfixPlacedFeature(data.config.default)\n\t\t\tbreak\n\t\tcase 'simple_random_selector':\n\t\t\tdata.config.features.forEach((f: any) => {\n\t\t\t\tfixPlacedFeature(f)\n\t\t\t})\n\t\t\tbreak\n\t\tcase 'vegetation_patch':\n\t\tcase 'waterlogged_vegetation_patch':\n\t\t\tfixPlacedFeature(data.config.vegetation_feature)\n\t\t\tif (typeof data.config === 'object') {\n\t\t\t\tdata.config.replaceable = '#' + data.config.replaceable\n\t\t\t}\n\t\t\tbreak\n\t\tcase 'geode':\n\t\t\tif (typeof data.config?.blocks === 'object') {\n\t\t\t\tdata.config.blocks.cannot_replace = '#' + data.config.blocks.cannot_replace\n\t\t\t\tdata.config.blocks.invalid_blocks = '#' + data.config.blocks.invalid_blocks\n\t\t\t}\n\t\t\tbreak\n\t\tcase 'root_system':\n\t\t\tif (typeof data.config === 'object') {\n\t\t\t\tdata.config.root_replaceable = '#' + data.config.root_replaceable\n\t\t\t}\n\t}\n}\n","import { Fix } from '../../Fix'\n\nconst locateRegex = /locate (minecraft:)?(mineshaft|ocean_ruin|ruined_portal|shipwreck|village)/\n\n/**\n * Upgrades /locate\n */\nexport const Function = Fix.onFile('functions', ({ data }: { data: string[] }) => {\n\tdata.forEach((line, i) => {\n\t\tif (line.startsWith('locate ') || line.startsWith('execute ')) {\n\t\t\tdata[i] = data[i].replace(locateRegex, 'locate #$1$2')\n\t\t}\n\t})\n})\n","import { Fix } from '../../Fix'\n\nexport const NoiseSettings = Fix.all(\n\tFix.onFile('worldgen/noise_settings', ({ data }) => fixNoiseSettings(data)),\n\tFix.onFile('dimension', ({ data }) => {\n\t\tif (data.generator?.type?.replace(/^minecraft:/, '') === 'noise') {\n\t\t\tfixNoiseSettings(data.generator.settings)\n\t\t}\n\t}),\n)\n\nfunction fixNoiseSettings(data: any) {\n\tif (typeof data !== 'object') return\n\n\tfixSurfaceRule(data.surface_rule)\n\n\tdata.noise_router = createNoiseRouter(data.aquifers_enabled, data.ore_veins_enabled, data.noise_caves_enabled, data.noodle_caves_enabled, data.noise.island_noise_override, data.noise.large_biomes)\n\tdelete data.noise_caves_enabled\n\tdelete data.noodle_caves_enabled\n\tdelete data.noise.island_noise_override\n\tdelete data.noise.amplified\n\tdelete data.noise.large_biomes\n\n\t// Assuming the vanilla structure sets are good enough, because custom structures weren't possible before anyways\n\tdelete data.structures\n}\n\nfunction fixSurfaceRule(data: any) {\n\tif (typeof data !== 'object') return\n\n\tconst type = data.type.replace(/^minecraft:/, '')\n\tswitch (type) {\n\t\tcase 'sequence':\n\t\t\tdata.sequence.forEach((s: any) => fixSurfaceRule(s))\n\t\t\tbreak\n\t\tcase 'condition':\n\t\t\tfixSurfaceCondition(data.if_true)\n\t\t\tfixSurfaceRule(data.then_run)\n\t}\n}\n\nfunction fixSurfaceCondition(data: any) {\n\tif (typeof data !== 'object') return\n\tconst condition = data.type.replace(/^minecraft:/, '')\n\tswitch (condition) {\n\t\tcase 'stone_depth':\n\t\t\tdata.secondary_depth_range = data.add_surface_secondary_depth ? 6 : 0\n\t\t\tdelete data.add_surface_secondary_depth\n\t}\n}\n\nfunction createNoiseRouter(aquifersEnabled: boolean, oreVeinsEnabled: boolean, noiseCavesEnabled: boolean, noodleCavesEnabled: boolean, islandNoiseOverride: boolean, largeBiomes: boolean) {\n\tconst prefix = islandNoiseOverride ? 'end' : largeBiomes ? 'overworld_large_biomes' : 'overworld'\n\n\tconst slopedCheese = !noiseCavesEnabled ? `minecraft:${prefix}/sloped_cheese` : {\n\t\tmax_exclusive: 1.5625,\n\t\twhen_in_range: {\n\t\t\targument1: `minecraft:${prefix}/sloped_cheese`,\n\t\t\targument2: {\n\t\t\t\targument1: 5.0,\n\t\t\t\targument2: 'minecraft:overworld/caves/entrances',\n\t\t\t\ttype: 'minecraft:mul',\n\t\t\t},\n\t\t\ttype: 'minecraft:min',\n\t\t},\n\t\twhen_out_of_range: {\n\t\t\targument1: {\n\t\t\t\targument1: {\n\t\t\t\t\targument1: {\n\t\t\t\t\t\targument1: {\n\t\t\t\t\t\t\targument1: 4.0,\n\t\t\t\t\t\t\targument2: {\n\t\t\t\t\t\t\t\targument: {\n\t\t\t\t\t\t\t\t\tnoise: 'minecraft:cave_layer',\n\t\t\t\t\t\t\t\t\txz_scale: 1.0,\n\t\t\t\t\t\t\t\t\ty_scale: 8.0,\n\t\t\t\t\t\t\t\t\ttype: 'minecraft:noise',\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\ttype: 'minecraft:square',\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\ttype: 'minecraft:mul',\n\t\t\t\t\t\t},\n\t\t\t\t\t\targument2: {\n\t\t\t\t\t\t\targument1: {\n\t\t\t\t\t\t\t\tinput: {\n\t\t\t\t\t\t\t\t\targument1: 0.27,\n\t\t\t\t\t\t\t\t\targument2: {\n\t\t\t\t\t\t\t\t\t\tnoise: 'minecraft:cave_cheese',\n\t\t\t\t\t\t\t\t\t\txz_scale: 1.0,\n\t\t\t\t\t\t\t\t\t\ty_scale: 0.6666666666666666,\n\t\t\t\t\t\t\t\t\t\ttype: 'minecraft:noise',\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\ttype: 'minecraft:add',\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tmin: -1.0,\n\t\t\t\t\t\t\t\tmax: 1.0,\n\t\t\t\t\t\t\t\ttype: 'minecraft:clamp',\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\targument2: {\n\t\t\t\t\t\t\t\tinput: {\n\t\t\t\t\t\t\t\t\targument1: 1.5,\n\t\t\t\t\t\t\t\t\targument2: {\n\t\t\t\t\t\t\t\t\t\targument1: -0.64,\n\t\t\t\t\t\t\t\t\t\targument2: `minecraft:${prefix}/sloped_cheese`,\n\t\t\t\t\t\t\t\t\t\ttype: 'minecraft:mul',\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\ttype: 'minecraft:add',\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tmin: 0.0,\n\t\t\t\t\t\t\t\tmax: 0.5,\n\t\t\t\t\t\t\t\ttype: 'minecraft:clamp',\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\ttype: 'minecraft:add',\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttype: 'minecraft:add',\n\t\t\t\t\t},\n\t\t\t\t\targument2: 'minecraft:overworld/caves/entrances',\n\t\t\t\t\ttype: 'minecraft:min',\n\t\t\t\t},\n\t\t\t\targument2: {\n\t\t\t\t\targument1: 'minecraft:overworld/caves/spaghetti_2d',\n\t\t\t\t\targument2: 'minecraft:overworld/caves/spaghetti_roughness_function',\n\t\t\t\t\ttype: 'minecraft:add',\n\t\t\t\t},\n\t\t\t\ttype: 'minecraft:min',\n\t\t\t},\n\t\t\targument2: {\n\t\t\t\tmax_exclusive: 0.03,\n\t\t\t\twhen_in_range: -1000000.0,\n\t\t\t\twhen_out_of_range: 'minecraft:overworld/caves/pillars',\n\t\t\t\tinput: 'minecraft:overworld/caves/pillars',\n\t\t\t\tmin_inclusive: -1000000.0,\n\t\t\t\ttype: 'minecraft:range_choice',\n\t\t\t},\n\t\t\ttype: 'minecraft:max',\n\t\t},\n\t\tinput: `minecraft:${prefix}/sloped_cheese`,\n\t\tmin_inclusive: -1000000.0,\n\t\ttype: 'minecraft:range_choice',\n\t}\n\tconst postProcessed = {\n\t\targument: {\n\t\t\targument1: 0.64,\n\t\t\targument2: {\n\t\t\t\targument: {\n\t\t\t\t\targument: {\n\t\t\t\t\t\targument: slopedCheese,\n\t\t\t\t\t\ttype: 'minecraft:slide',\n\t\t\t\t\t},\n\t\t\t\t\ttype: 'minecraft:blend_density',\n\t\t\t\t},\n\t\t\t\ttype: 'minecraft:interpolated',\n\t\t\t},\n\t\t\ttype: 'minecraft:mul',\n\t\t},\n\t\ttype: 'minecraft:squeeze',\n\t}\n\n\treturn {\n\t\tfinal_density: !noodleCavesEnabled ? postProcessed : {\n\t\t\targument1: postProcessed,\n\t\t\targument2: 'minecraft:overworld/caves/noodle',\n\t\t\ttype: 'minecraft:min',\n\t\t},\n\t\tvein_toggle: !oreVeinsEnabled || islandNoiseOverride ? 0 : {\n\t\t\targument: {\n\t\t\t\tmax_exclusive: 51.0,\n\t\t\t\twhen_in_range: {\n\t\t\t\t\tnoise: 'minecraft:ore_veininess',\n\t\t\t\t\txz_scale: 1.5,\n\t\t\t\t\ty_scale: 1.5,\n\t\t\t\t\ttype: 'minecraft:noise',\n\t\t\t\t},\n\t\t\t\twhen_out_of_range: 0.0,\n\t\t\t\tinput: 'minecraft:y',\n\t\t\t\tmin_inclusive: -60.0,\n\t\t\t\ttype: 'minecraft:range_choice',\n\t\t\t},\n\t\t\ttype: 'minecraft:interpolated',\n\t\t},\n\t\tvein_ridged: !oreVeinsEnabled || islandNoiseOverride ? 0 : {\n\t\t\targument1: -0.07999999821186066,\n\t\t\targument2: {\n\t\t\t\targument1: {\n\t\t\t\t\targument: {\n\t\t\t\t\t\targument: {\n\t\t\t\t\t\t\tmax_exclusive: 51.0,\n\t\t\t\t\t\t\twhen_in_range: {\n\t\t\t\t\t\t\t\tnoise: 'minecraft:ore_vein_a',\n\t\t\t\t\t\t\t\txz_scale: 4.0,\n\t\t\t\t\t\t\t\ty_scale: 4.0,\n\t\t\t\t\t\t\t\ttype: 'minecraft:noise',\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\twhen_out_of_range: 0.0,\n\t\t\t\t\t\t\tinput: 'minecraft:y',\n\t\t\t\t\t\t\tmin_inclusive: -60.0,\n\t\t\t\t\t\t\ttype: 'minecraft:range_choice',\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttype: 'minecraft:interpolated',\n\t\t\t\t\t},\n\t\t\t\t\ttype: 'minecraft:abs',\n\t\t\t\t},\n\t\t\t\targument2: {\n\t\t\t\t\targument: {\n\t\t\t\t\t\targument: {\n\t\t\t\t\t\t\tmax_exclusive: 51.0,\n\t\t\t\t\t\t\twhen_in_range: {\n\t\t\t\t\t\t\t\tnoise: 'minecraft:ore_vein_b',\n\t\t\t\t\t\t\t\txz_scale: 4.0,\n\t\t\t\t\t\t\t\ty_scale: 4.0,\n\t\t\t\t\t\t\t\ttype: 'minecraft:noise',\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\twhen_out_of_range: 0.0,\n\t\t\t\t\t\t\tinput: 'minecraft:y',\n\t\t\t\t\t\t\tmin_inclusive: -60.0,\n\t\t\t\t\t\t\ttype: 'minecraft:range_choice',\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttype: 'minecraft:interpolated',\n\t\t\t\t\t},\n\t\t\t\t\ttype: 'minecraft:abs',\n\t\t\t\t},\n\t\t\t\ttype: 'minecraft:max',\n\t\t\t},\n\t\t\ttype: 'minecraft:add',\n\t\t},\n\t\tvein_gap: !oreVeinsEnabled || islandNoiseOverride ? 0 : {\n\t\t\tnoise: 'minecraft:ore_gap',\n\t\t\txz_scale: 1.0,\n\t\t\ty_scale: 1.0,\n\t\t\ttype: 'minecraft:noise',\n\t\t},\n\t\terosion: islandNoiseOverride ? 0 : `minecraft:${prefix}/erosion`,\n\t\tdepth: islandNoiseOverride ? 0 : `minecraft:${prefix}/depth`,\n\t\tridges: islandNoiseOverride ? 0 : 'minecraft:overworld/ridges',\n\t\tinitial_density_without_jaggedness: islandNoiseOverride ? {\n\t\t\targument: {\n\t\t\t\ttype: 'minecraft:end_islands',\n\t\t\t},\n\t\t\ttype: 'minecraft:cache_2d',\n\t\t} : {\n\t\t\targument1: 4.0,\n\t\t\targument2: {\n\t\t\t\targument: {\n\t\t\t\t\targument1: `minecraft:${prefix}/depth`,\n\t\t\t\t\targument2: {\n\t\t\t\t\t\targument: `minecraft:${prefix}/factor`,\n\t\t\t\t\t\ttype: 'minecraft:cache_2d',\n\t\t\t\t\t},\n\t\t\t\t\ttype: 'minecraft:mul',\n\t\t\t\t},\n\t\t\t\ttype: 'minecraft:quarter_negative',\n\t\t\t},\n\t\t\ttype: 'minecraft:mul',\n\t\t},\n\t\tlava: !aquifersEnabled || islandNoiseOverride ? 0 : {\n\t\t\tnoise: 'minecraft:aquifer_lava',\n\t\t\txz_scale: 1.0,\n\t\t\ty_scale: 1.0,\n\t\t\ttype: 'minecraft:noise',\n\t\t},\n\t\ttemperature: islandNoiseOverride ? 0 : {\n\t\t\txz_scale: 0.25,\n\t\t\ty_scale: 0.0,\n\t\t\tnoise: largeBiomes ? 'minecraft:temperature_large' : 'minecraft:temperature',\n\t\t\tshift_x: 'minecraft:shift_x',\n\t\t\tshift_y: 0.0,\n\t\t\tshift_z: 'minecraft:shift_z',\n\t\t\ttype: 'minecraft:shifted_noise',\n\t\t},\n\t\tvegetation: islandNoiseOverride ? 0 : {\n\t\t\txz_scale: 0.25,\n\t\t\ty_scale: 0.0,\n\t\t\tnoise: largeBiomes ? 'minecraft:vegetation_large' : 'minecraft:vegetation',\n\t\t\tshift_x: 'minecraft:shift_x',\n\t\t\tshift_y: 0.0,\n\t\t\tshift_z: 'minecraft:shift_z',\n\t\t\ttype: 'minecraft:shifted_noise',\n\t\t},\n\t\tcontinents: islandNoiseOverride ? 0 : `minecraft:${prefix}/continents`,\n\t\tbarrier: !aquifersEnabled || islandNoiseOverride ? 0 : {\n\t\t\tnoise: 'minecraft:aquifer_barrier',\n\t\t\txz_scale: 1.0,\n\t\t\ty_scale: 0.5,\n\t\t\ttype: 'minecraft:noise',\n\t\t},\n\t\tfluid_level_floodedness: !aquifersEnabled || islandNoiseOverride ? 0 : {\n\t\t\tnoise: 'minecraft:aquifer_fluid_level_floodedness',\n\t\t\txz_scale: 1.0,\n\t\t\ty_scale: 0.67,\n\t\t\ttype: 'minecraft:noise',\n\t\t},\n\t\tfluid_level_spread: !aquifersEnabled || islandNoiseOverride ? 0 : {\n\t\t\tnoise: 'minecraft:aquifer_fluid_level_spread',\n\t\t\txz_scale: 1.0,\n\t\t\ty_scale: 0.7142857142857143,\n\t\t\ttype: 'minecraft:noise',\n\t\t},\n\t}\n}\n","import { Fix } from '../../Fix'\n\n/**\n * Fixes feature in location predicate\n */\nexport const Predicates = Fix.all(\n\tFix.onFile('predicates', ({ data }) => {\n\t\tif (Array.isArray(data)) {\n\t\t\tdata.forEach(fixCondition)\n\t\t} else {\n\t\t\tfixCondition(data)\n\t\t}\n\t}),\n\tFix.onFile('advancements', ({ data }) => {\n\t\tObject.values(data.criteria).forEach(fixCriterion)\n\t}),\n\tFix.onFile('loot_tables', ({ data }) => {\n\t\tdata.pools?.forEach(fixPool)\n\t}),\n)\n\nfunction fixCriterion(data: any) {\n\tif (typeof data.conditions !== 'object') return\n\n\tfixEntity(data.conditions.entity)\n\tfixEntity(data.conditions.player)\n\tfixEntity(data.conditions.parent)\n\tfixEntity(data.conditions.partner)\n\tfixEntity(data.conditions.child)\n\tfixEntity(data.conditions.villager)\n\tfixEntity(data.conditions.zombie)\n\tfixEntity(data.conditions.projectile)\n\tfixEntity(data.conditions.shooter)\n\tdata.conditions.victims?.forEach(fixEntity)\n\n\tfixDamage(data.conditions.damage)\n\tfixDamage(data.conditions.killing_blow)\n\t\n\tfixLocation(data.conditions.location)\n\tfixLocation(data.conditions.entered)\n\tfixLocation(data.conditions.exited)\n}\n\nfunction fixPool(data: any) {\n\tdata.entries?.forEach(fixEntry)\n\tdata.conditions?.forEach(fixCondition)\n}\n\nfunction fixEntry(data: any) {\n\tdata.children?.forEach(fixEntry)\n\tdata.conditions?.forEach(fixCondition)\n}\n\nfunction fixCondition(data: any) {\n\tconst condition = data.condition.replace(/^minecraft:/, '')\n\tswitch (condition) {\n\t\tcase 'entity_properties':\n\t\t\tfixEntity(data.predicate)\n\t\t\tbreak\n\t\tcase 'damage_source_properties':\n\t\t\tfixDamage(data.predicate)\n\t\t\tbreak\n\t\tcase 'location_check':\n\t\t\tfixLocation(data.predicate)\n\t\t\tbreak\n\t}\n}\n\nfunction fixDamage(data: any) {\n\tif (typeof data !== 'object') return\n\n\tfixEntity(data.source_entity)\n\tfixEntity(data.direct_entity)\n\tfixDamage(data.type)\n}\n\nfunction fixEntity(data: any) {\n\tif (typeof data !== 'object') return\n\n\tif (Array.isArray(data)) {\n\t\tdata.forEach(fixCondition)\n\t\treturn\n\t}\n\n\tfixEntity(data.vehicle)\n\tfixEntity(data.targeted_entity)\n\tfixLocation(data.location)\n}\n\nfunction fixLocation(data: any) {\n\tif (typeof data !== 'object') return\n\n\tif (typeof data.feature === 'string') {\n\t\tswitch (data.feature) {\n\t\t\tcase 'endcity':\n\t\t\t\tdata.feature = 'minecraft:end_city'\n\t\t\t\tbreak\n\t\t\tdefault:\n\t\t\t\tdata.feature = 'minecraft:' + data.feature\n\t\t}\n\t}\n}\n","import { Fix } from '../../Fix'\n\nexport const ProcessorList = Fix.all(\n\tFix.onFile('worldgen/processor_list', ({ data }) => fixProcessorList(data)),\n\tFix.onFile('worldgen/template_pool', ({ data }) => fixTemplatePool(data)),\n)\n\nfunction fixProcessorList(data: any) {\n\tif (typeof data !== 'object') return\n\n\tif (!Array.isArray(data.processors)) return\n\n\tdata.processors.forEach(fixProcessor)\n}\n\nfunction fixProcessor(data: any) {\n\tif (typeof data !== 'object') return\n\t\t\n\tconst type = data.processor_type.replace(/^minecraft:/, '')\n\tswitch (type) {\n\t\tcase 'protected_blocks':\n\t\t\tdata.value = '#' + data.value\n\t}\n}\n\nfunction fixTemplatePool(data: any) {\n\tif (typeof data !== 'object') return\n\n\tif (!Array.isArray(data.elements)) return\n\n\tdata.elements.forEach((el: any) => {\n\t\tif (typeof el !== 'object') return\n\t\tfixTemplateElement(el.element)\n\t})\n}\n\nfunction fixTemplateElement(data: any) {\n\tif (typeof data !== 'object') return\n\t\n\tif (typeof data.processors === 'object') {\n\t\tfixProcessorList(data.processors)\n\t}\n}\n","import type { FixContext } from '../../Fix'\nimport { Fix } from '../../Fix'\n\n/**\n * Adds the new biomes and spawn_overrides fields\n */\nexport const StructureFeature = Fix.all(\n\tFix.onFile('worldgen/configured_structure_feature', ({ data }, ctx) => fixStructureFeature(data, ctx)),\n)\n\nfunction fixStructureFeature(data: any, ctx: FixContext) {\n\tif (typeof data !== 'object') return\n\t\n\tconst type = data.type.replace(/^minecraft:/, '')\n\tswitch (type) {\n\t\tcase 'pillager_outpost':\n\t\tcase 'village':\n\t\t\tdata.adapt_noise = true\n\t}\n\n\tctx.warn('Cannot upgrade configured structure features, set biomes to empty list.')\n\n\tdata.biomes = []\n\tdata.spawn_overrides = {}\n}\n","import { Fix } from '../../Fix'\nimport { Dimension } from './Dimension'\nimport { DimensionType } from './DimensionType'\nimport { Feature } from './Feature'\nimport { Function } from './Function'\nimport { NoiseSettings } from './NoiseSettings'\nimport { Predicates } from './Predicates'\nimport { ProcessorList } from './ProcessorList'\nimport { StructureFeature } from './StructureFeature'\n\nexport const Fixes182 = Fix.version('1.18.1', '1.18.2', Fix.groupProblems(\n\tFix.debug('1.18.2 fixes'),\n\tFix.when('worldgen',\n\t\tDimensionType,\n\t\tNoiseSettings,\n\t\tDimension,\n\t\tStructureFeature,\n\t\tProcessorList,\n\t\tFeature,\n\t),\n\tFix.when('predicates',\n\t\tPredicates,\n\t),\n\tFix.when('functions', Function),\n\tFix.packFormat(9),\n))\n","import { Fix } from '../../Fix'\nimport type { PackFile } from '../../Pack'\n\nexport const Biome = Fix.all(\n\tFix.onFile('worldgen/biome', fixBiome),\n)\n\nfunction fixBiome({ data }: PackFile) {\n\tdelete data.category\n}\n","import { Fix } from '../../Fix'\n\nexport const Carver = Fix.all(\n\tFix.onFile('worldgen/configured_carver', ({ data }) => fixCarver(data)),\n\tFix.onFile('worldgen/biome', ({ data }) => {\n\t\tif (typeof data.carvers === 'object') {\n\t\t\tObject.values(data.carvers).forEach(carver => {\n\t\t\t\tif (Array.isArray(carver)) {\n\t\t\t\t\tcarver.forEach(fixCarver)\n\t\t\t\t} else {\n\t\t\t\t\tfixCarver(carver)\n\t\t\t\t}\n\t\t\t})\n\t\t}\n\t}),\n)\n\nfunction fixCarver(data: any) {\n\tif (typeof data !== 'object') return\n\tconst type = data.type.replace(/^minecraft:/, '')\n\tswitch (type) {\n\t\tcase 'canyon':\n\t\tcase 'cave':\n\t\t\tdata.config.replaceable = '#minecraft:overworld_carver_replaceables'\n\t\t\tbreak\n\t\tcase 'nether_cave':\n\t\t\tdata.config.replaceable = '#minecraft:nether_carver_replaceables'\n\t\t\tbreak\n\t}\n}\n","import type { FixContext } from '../../Fix'\nimport { Fix } from '../../Fix'\n\nexport const Dimension = Fix.all(\n\tFix.onFile('dimension_type', ({ data }) => fixDimensionType(data)),\n\tFix.onFile('dimension', ({ data, name }, ctx) => fixDimension(data, name, ctx)),\n)\n\nfunction fixDimension(data: any, name: string, ctx: FixContext) {\n\tif (typeof data !== 'object') return\n\n\tif (typeof data.type === 'object') {\n\t\tfixDimensionType(data.type)\n\t\tctx.create('dimension_type', name, data.type)\n\t\tdata.type = name\n\t}\n\n\tfixGenerator(data.generator)\n}\n\nfunction fixDimensionType(data: any) {\n\tdata.monster_spawn_block_light_limit = 0\n\tdata.monster_spawn_light_level = {\n\t\ttype: 'minecraft:uniform',\n\t\tvalue: {\n\t\t\tmin_inclusive: 0,\n\t\t\tmax_inclusive: 7,\n\t\t},\n\t}\n}\n\nfunction fixGenerator(data: any) {\n\tif (typeof data !== 'object') return\n\n\tconst type = data.type.replace(/^minecraft:/, '')\n\tswitch (type) {\n\t\tcase 'noise':\n\t\t\tdelete data.seed\n\t\t\t\n\t\t\tfixBiomeSource(data.biome_source)\n\t}\n}\n\nfunction fixBiomeSource(data: any) {\n\tif (typeof data !== 'object') return\n\n\tconst type = data.type.replace(/^minecraft:/, '')\n\tswitch (type) {\n\t\tcase 'end':\n\t\t\tdelete data.seed\n\t}\n}\n","import { Fix } from '../../Fix'\n\nexport const Feature = Fix.all(\n\tFix.onFile('worldgen/configured_feature', ({ data }) => fixConfiguredFeature(data)),\n\tFix.onFile('worldgen/placed_feature', ({ data }) => fixPlacedFeature(data)),\n)\n\nfunction fixPlacedFeature(data: any) {\n\tif (typeof data !== 'object') return\n\n\tfixConfiguredFeature(data.feature)\n}\n\nfunction fixConfiguredFeature(data: any) {\n\tif (typeof data !== 'object') return\n\n\tconst type = data.type.replace(/^minecraft:/, '')\n\tswitch (type) {\n\t\tcase 'random_boolean_selector':\n\t\t\tfixPlacedFeature(data.config.feature_false)\n\t\t\tfixPlacedFeature(data.config.feature_true)\n\t\t\tbreak\n\t\tcase 'random_patch':\n\t\tcase 'flower':\n\t\tcase 'no_bonemeal_flower':\n\t\t\tfixPlacedFeature(data.config.feature)\n\t\t\tbreak\n\t\tcase 'random_selector':\n\t\t\tdata.config.features.forEach((e: any) => {\n\t\t\t\tfixPlacedFeature(e.feature)\n\t\t\t})\n\t\t\tfixPlacedFeature(data.config.default)\n\t\t\tbreak\n\t\tcase 'simple_random_selector':\n\t\t\tdata.config.features.forEach((f: any) => {\n\t\t\t\tfixPlacedFeature(f)\n\t\t\t})\n\t\t\tbreak\n\t\tcase 'vegetation_patch':\n\t\tcase 'waterlogged_vegetation_patch':\n\t\t\tfixPlacedFeature(data.config.vegetation_feature)\n\t\t\tbreak\n\t\tcase 'disk':\n\t\tcase 'ice_patch':\n\t\tcase 'surface_disk':\n\t\t\tdata.type = 'minecraft:random_selector',\n\t\t\tdata.config = {\n\t\t\t\tfeatures: [],\n\t\t\t\tdefault: {\n\t\t\t\t\tfeature: {\n\t\t\t\t\t\ttype: 'minecraft:disk',\n\t\t\t\t\t\tconfig: {\n\t\t\t\t\t\t\thalf_height: data.config.half_height,\n\t\t\t\t\t\t\tradius: data.config.radius,\n\t\t\t\t\t\t\tstate_provider: {\n\t\t\t\t\t\t\t\tfallback: {\n\t\t\t\t\t\t\t\t\ttype: 'minecraft:simple_state_provider',\n\t\t\t\t\t\t\t\t\tstate: data.config.state,\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\trules: [],\n\t\t\t\t\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\ttarget: {\n\t\t\t\t\t\t\t\ttype: 'minecraft:matching_blocks',\n\t\t\t\t\t\t\t\tblocks: getBlockIds(data.config.targets),\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\tplacement: [\n\t\t\t\t\t\t...type === 'disk' ? [] : [{\n\t\t\t\t\t\t\ttype: 'minecraft:random_offset',\n\t\t\t\t\t\t\txz_spread: 0,\n\t\t\t\t\t\t\ty_spread: -1,\n\t\t\t\t\t\t}],\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttype: 'minecraft:block_predicate_filter',\n\t\t\t\t\t\t\tpredicate: type === 'disk' ? {\n\t\t\t\t\t\t\t\ttype: 'minecraft:matching_fluids',\n\t\t\t\t\t\t\t\tfluids: 'minecraft:water',\n\t\t\t\t\t\t\t} : type === 'ice_patch' ? {\n\t\t\t\t\t\t\t\ttype: 'minecraft:matching_blocks',\n\t\t\t\t\t\t\t\tblocks: 'minecraft:snow',\n\t\t\t\t\t\t\t} : {\n\t\t\t\t\t\t\t\ttype: 'minecraft:matching_blocks',\n\t\t\t\t\t\t\t\tblocks: data.config?.can_origin_replace?.filter((id: string) => id?.replace(/^minecraft:/, '') !== 'water') ?? [],\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t}\n\t\t\tbreak\n\t\tcase 'glow_lichen':\n\t\t\tdata.type = 'minecraft:multiface_growth'\n\t\t\tbreak\n\t\tcase 'tree':\n\t\t\tdata.config.decorators?.forEach((decorator: any) => {\n\t\t\t\tif (decorator?.type?.replace(/^minecraft:/, '') === 'leave_vine') {\n\t\t\t\t\tdecorator.probability = 0.25\n\t\t\t\t}\n\t\t\t})\n\t\t\tbreak\n\t}\n}\n\nfunction getBlockIds(states: any[]) {\n\treturn [...new Set(states.map((state: any) => state.Name))]\n}\n","import { Fix } from '../../Fix'\n\nexport const Function = Fix.onFile('functions', ({ data }: { data: string[] }) => {\n\tdata.forEach((line, i) => {\n\t\tif (line.startsWith('locatebiome ') || line.startsWith('execute ')) {\n\t\t\tdata[i] = data[i].replace('locatebiome ', 'locate biome ')\n\t\t}\n\t\tif (line.startsWith('placefeature ') || line.startsWith('execute ')) {\n\t\t\tdata[i] = data[i].replace('placefeature ', 'place feature ')\n\t\t}\n\t})\n})\n","export const DEFAULT_NOISE = JSON.parse('{\"min_y\":-64,\"height\":384,\"size_horizontal\":1,\"size_vertical\":2,\"sampling\":{\"xz_scale\":1,\"y_scale\":1,\"xz_factor\":80,\"y_factor\":160},\"bottom_slide\":{\"target\":0.1171875,\"size\":3,\"offset\":0},\"top_slide\":{\"target\":-0.078125,\"size\":2,\"offset\":8},\"terrain_shaper\":{\"offset\":{\"coordinate\":\"continents\",\"points\":[{\"location\":-1.1,\"derivative\":0,\"value\":0.044},{\"location\":-1.02,\"derivative\":0,\"value\":-0.2222},{\"location\":-0.51,\"derivative\":0,\"value\":-0.2222},{\"location\":-0.44,\"derivative\":0,\"value\":-0.12},{\"location\":-0.18,\"derivative\":0,\"value\":-0.12},{\"location\":-0.16,\"derivative\":0,\"value\":{\"coordinate\":\"erosion\",\"points\":[{\"location\":-0.85,\"derivative\":0,\"value\":{\"coordinate\":\"ridges\",\"points\":[{\"location\":-1,\"derivative\":0.38940096,\"value\":-0.08880186},{\"location\":1,\"derivative\":0.38940096,\"value\":0.69000006}]}},{\"location\":-0.7,\"derivative\":0,\"value\":{\"coordinate\":\"ridges\",\"points\":[{\"location\":-1,\"derivative\":0.37788022,\"value\":-0.115760356},{\"location\":1,\"derivative\":0.37788022,\"value\":0.6400001}]}},{\"location\":-0.4,\"derivative\":0,\"value\":{\"coordinate\":\"ridges\",\"points\":[{\"location\":-1,\"derivative\":0,\"value\":-0.2222},{\"location\":-0.75,\"derivative\":0,\"value\":-0.2222},{\"location\":-0.65,\"derivative\":0,\"value\":0},{\"location\":0.5954547,\"derivative\":0,\"value\":2.9802322e-8},{\"location\":0.6054547,\"derivative\":0.2534563,\"value\":2.9802322e-8},{\"location\":1,\"derivative\":0.2534563,\"value\":0.100000024}]}},{\"location\":-0.35,\"derivative\":0,\"value\":{\"coordinate\":\"ridges\",\"points\":[{\"location\":-1,\"derivative\":0.5,\"value\":-0.3},{\"location\":-0.4,\"derivative\":0,\"value\":0.05},{\"location\":0,\"derivative\":0,\"value\":0.05},{\"location\":0.4,\"derivative\":0,\"value\":0.05},{\"location\":1,\"derivative\":0.007000001,\"value\":0.060000002}]}},{\"location\":-0.1,\"derivative\":0,\"value\":{\"coordinate\":\"ridges\",\"points\":[{\"location\":-1,\"derivative\":0.5,\"value\":-0.15},{\"location\":-0.4,\"derivative\":0,\"value\":0},{\"location\":0,\"derivative\":0,\"value\":0},{\"location\":0.4,\"derivative\":0.1,\"value\":0.05},{\"location\":1,\"derivative\":0.007000001,\"value\":0.060000002}]}},{\"location\":0.2,\"derivative\":0,\"value\":{\"coordinate\":\"ridges\",\"points\":[{\"location\":-1,\"derivative\":0.5,\"value\":-0.15},{\"location\":-0.4,\"derivative\":0,\"value\":0},{\"location\":0,\"derivative\":0,\"value\":0},{\"location\":0.4,\"derivative\":0,\"value\":0},{\"location\":1,\"derivative\":0,\"value\":0}]}},{\"location\":0.7,\"derivative\":0,\"value\":{\"coordinate\":\"ridges\",\"points\":[{\"location\":-1,\"derivative\":0,\"value\":-0.02},{\"location\":-0.4,\"derivative\":0,\"value\":-0.03},{\"location\":0,\"derivative\":0,\"value\":-0.03},{\"location\":0.4,\"derivative\":0.06,\"value\":0},{\"location\":1,\"derivative\":0,\"value\":0}]}}]}},{\"location\":-0.15,\"derivative\":0,\"value\":{\"coordinate\":\"erosion\",\"points\":[{\"location\":-0.85,\"derivative\":0,\"value\":{\"coordinate\":\"ridges\",\"points\":[{\"location\":-1,\"derivative\":0.38940096,\"value\":-0.08880186},{\"location\":1,\"derivative\":0.38940096,\"value\":0.69000006}]}},{\"location\":-0.7,\"derivative\":0,\"value\":{\"coordinate\":\"ridges\",\"points\":[{\"location\":-1,\"derivative\":0.37788022,\"value\":-0.115760356},{\"location\":1,\"derivative\":0.37788022,\"value\":0.6400001}]}},{\"location\":-0.4,\"derivative\":0,\"value\":{\"coordinate\":\"ridges\",\"points\":[{\"location\":-1,\"derivative\":0,\"value\":-0.2222},{\"location\":-0.75,\"derivative\":0,\"value\":-0.2222},{\"location\":-0.65,\"derivative\":0,\"value\":0},{\"location\":0.5954547,\"derivative\":0,\"value\":2.9802322e-8},{\"location\":0.6054547,\"derivative\":0.2534563,\"value\":2.9802322e-8},{\"location\":1,\"derivative\":0.2534563,\"value\":0.100000024}]}},{\"location\":-0.35,\"derivative\":0,\"value\":{\"coordinate\":\"ridges\",\"points\":[{\"location\":-1,\"derivative\":0.5,\"value\":-0.3},{\"location\":-0.4,\"derivative\":0,\"value\":0.05},{\"location\":0,\"derivative\":0,\"value\":0.05},{\"location\":0.4,\"derivative\":0,\"value\":0.05},{\"location\":1,\"derivative\":0.007000001,\"value\":0.060000002}]}},{\"location\":-0.1,\"derivative\":0,\"value\":{\"coordinate\":\"ridges\",\"points\":[{\"location\":-1,\"derivative\":0.5,\"value\":-0.15},{\"location\":-0.4,\"derivative\":0,\"value\":0},{\"location\":0,\"derivative\":0,\"value\":0},{\"location\":0.4,\"derivative\":0.1,\"value\":0.05},{\"location\":1,\"derivative\":0.007000001,\"value\":0.060000002}]}},{\"location\":0.2,\"derivative\":0,\"value\":{\"coordinate\":\"ridges\",\"points\":[{\"location\":-1,\"derivative\":0.5,\"value\":-0.15},{\"location\":-0.4,\"derivative\":0,\"value\":0},{\"location\":0,\"derivative\":0,\"value\":0},{\"location\":0.4,\"derivative\":0,\"value\":0},{\"location\":1,\"derivative\":0,\"value\":0}]}},{\"location\":0.7,\"derivative\":0,\"value\":{\"coordinate\":\"ridges\",\"points\":[{\"location\":-1,\"derivative\":0,\"value\":-0.02},{\"location\":-0.4,\"derivative\":0,\"value\":-0.03},{\"location\":0,\"derivative\":0,\"value\":-0.03},{\"location\":0.4,\"derivative\":0.06,\"value\":0},{\"location\":1,\"derivative\":0,\"value\":0}]}}]}},{\"location\":-0.1,\"derivative\":0,\"value\":{\"coordinate\":\"erosion\",\"points\":[{\"location\":-0.85,\"derivative\":0,\"value\":{\"coordinate\":\"ridges\",\"points\":[{\"location\":-1,\"derivative\":0.38940096,\"value\":-0.08880186},{\"location\":1,\"derivative\":0.38940096,\"value\":0.69000006}]}},{\"location\":-0.7,\"derivative\":0,\"value\":{\"coordinate\":\"ridges\",\"points\":[{\"location\":-1,\"derivative\":0.37788022,\"value\":-0.115760356},{\"location\":1,\"derivative\":0.37788022,\"value\":0.6400001}]}},{\"location\":-0.4,\"derivative\":0,\"value\":{\"coordinate\":\"ridges\",\"points\":[{\"location\":-1,\"derivative\":0,\"value\":-0.2222},{\"location\":-0.75,\"derivative\":0,\"value\":-0.2222},{\"location\":-0.65,\"derivative\":0,\"value\":0},{\"location\":0.5954547,\"derivative\":0,\"value\":2.9802322e-8},{\"location\":0.6054547,\"derivative\":0.2534563,\"value\":2.9802322e-8},{\"location\":1,\"derivative\":0.2534563,\"value\":0.100000024}]}},{\"location\":-0.35,\"derivative\":0,\"value\":{\"coordinate\":\"ridges\",\"points\":[{\"location\":-1,\"derivative\":0.5,\"value\":-0.25},{\"location\":-0.4,\"derivative\":0,\"value\":0.05},{\"location\":0,\"derivative\":0,\"value\":0.05},{\"location\":0.4,\"derivative\":0,\"value\":0.05},{\"location\":1,\"derivative\":0.007000001,\"value\":0.060000002}]}},{\"location\":-0.1,\"derivative\":0,\"value\":{\"coordinate\":\"ridges\",\"points\":[{\"location\":-1,\"derivative\":0.5,\"value\":-0.1},{\"location\":-0.4,\"derivative\":0.01,\"value\":0.001},{\"location\":0,\"derivative\":0.01,\"value\":0.003},{\"location\":0.4,\"derivative\":0.094000004,\"value\":0.05},{\"location\":1,\"derivative\":0.007000001,\"value\":0.060000002}]}},{\"location\":0.2,\"derivative\":0,\"value\":{\"coordinate\":\"ridges\",\"points\":[{\"location\":-1,\"derivative\":0.5,\"value\":-0.1},{\"location\":-0.4,\"derivative\":0,\"value\":0.01},{\"location\":0,\"derivative\":0,\"value\":0.01},{\"location\":0.4,\"derivative\":0.04,\"value\":0.03},{\"location\":1,\"derivative\":0.049,\"value\":0.1}]}},{\"location\":0.7,\"derivative\":0,\"value\":{\"coordinate\":\"ridges\",\"points\":[{\"location\":-1,\"derivative\":0,\"value\":-0.02},{\"location\":-0.4,\"derivative\":0,\"value\":-0.03},{\"location\":0,\"derivative\":0,\"value\":-0.03},{\"location\":0.4,\"derivative\":0.12,\"value\":0.03},{\"location\":1,\"derivative\":0.049,\"value\":0.1}]}}]}},{\"location\":0.25,\"derivative\":0,\"value\":{\"coordinate\":\"erosion\",\"points\":[{\"location\":-0.85,\"derivative\":0,\"value\":{\"coordinate\":\"ridges\",\"points\":[{\"location\":-1,\"derivative\":0,\"value\":0.20235021},{\"location\":0,\"derivative\":0.5138249,\"value\":0.7161751},{\"location\":1,\"derivative\":0.5138249,\"value\":1.23}]}},{\"location\":-0.7,\"derivative\":0,\"value\":{\"coordinate\":\"ridges\",\"points\":[{\"location\":-1,\"derivative\":0,\"value\":0.2},{\"location\":0,\"derivative\":0.43317974,\"value\":0.44682026},{\"location\":1,\"derivative\":0.43317974,\"value\":0.88}]}},{\"location\":-0.4,\"derivative\":0,\"value\":{\"coordinate\":\"ridges\",\"points\":[{\"location\":-1,\"derivative\":0,\"value\":0.2},{\"location\":0,\"derivative\":0.3917051,\"value\":0.30829495},{\"location\":1,\"derivative\":0.3917051,\"value\":0.70000005}]}},{\"location\":-0.35,\"derivative\":0,\"value\":{\"coordinate\":\"ridges\",\"points\":[{\"location\":-1,\"derivative\":0.5,\"value\":-0.25},{\"location\":-0.4,\"derivative\":0,\"value\":0.35},{\"location\":0,\"derivative\":0,\"value\":0.35},{\"location\":0.4,\"derivative\":0,\"value\":0.35},{\"location\":1,\"derivative\":0.049000014,\"value\":0.42000002}]}},{\"location\":-0.1,\"derivative\":0,\"value\":{\"coordinate\":\"ridges\",\"points\":[{\"location\":-1,\"derivative\":0.5,\"value\":-0.1},{\"location\":-0.4,\"derivative\":0.07,\"value\":0.0069999998},{\"location\":0,\"derivative\":0.07,\"value\":0.021},{\"location\":0.4,\"derivative\":0.658,\"value\":0.35},{\"location\":1,\"derivative\":0.049000014,\"value\":0.42000002}]}},{\"location\":0.2,\"derivative\":0,\"value\":{\"coordinate\":\"ridges\",\"points\":[{\"location\":-1,\"derivative\":0.5,\"value\":-0.1},{\"location\":-0.4,\"derivative\":0,\"value\":0.01},{\"location\":0,\"derivative\":0,\"value\":0.01},{\"location\":0.4,\"derivative\":0.04,\"value\":0.03},{\"location\":1,\"derivative\":0.049,\"value\":0.1}]}},{\"location\":0.4,\"derivative\":0,\"value\":{\"coordinate\":\"ridges\",\"points\":[{\"location\":-1,\"derivative\":0.5,\"value\":-0.1},{\"location\":-0.4,\"derivative\":0,\"value\":0.01},{\"location\":0,\"derivative\":0,\"value\":0.01},{\"location\":0.4,\"derivative\":0.04,\"value\":0.03},{\"location\":1,\"derivative\":0.049,\"value\":0.1}]}},{\"location\":0.45,\"derivative\":0,\"value\":{\"coordinate\":\"ridges\",\"points\":[{\"location\":-1,\"derivative\":0,\"value\":-0.1},{\"location\":-0.4,\"derivative\":0,\"value\":{\"coordinate\":\"ridges\",\"points\":[{\"location\":-1,\"derivative\":0.5,\"value\":-0.1},{\"location\":-0.4,\"derivative\":0,\"value\":0.01},{\"location\":0,\"derivative\":0,\"value\":0.01},{\"location\":0.4,\"derivative\":0.04,\"value\":0.03},{\"location\":1,\"derivative\":0.049,\"value\":0.1}]}},{\"location\":0,\"derivative\":0,\"value\":0.17}]}},{\"location\":0.55,\"derivative\":0,\"value\":{\"coordinate\":\"ridges\",\"points\":[{\"location\":-1,\"derivative\":0,\"value\":-0.1},{\"location\":-0.4,\"derivative\":0,\"value\":{\"coordinate\":\"ridges\",\"points\":[{\"location\":-1,\"derivative\":0.5,\"value\":-0.1},{\"location\":-0.4,\"derivative\":0,\"value\":0.01},{\"location\":0,\"derivative\":0,\"value\":0.01},{\"location\":0.4,\"derivative\":0.04,\"value\":0.03},{\"location\":1,\"derivative\":0.049,\"value\":0.1}]}},{\"location\":0,\"derivative\":0,\"value\":0.17}]}},{\"location\":0.58,\"derivative\":0,\"value\":{\"coordinate\":\"ridges\",\"points\":[{\"location\":-1,\"derivative\":0.5,\"value\":-0.1},{\"location\":-0.4,\"derivative\":0,\"value\":0.01},{\"location\":0,\"derivative\":0,\"value\":0.01},{\"location\":0.4,\"derivative\":0.04,\"value\":0.03},{\"location\":1,\"derivative\":0.049,\"value\":0.1}]}},{\"location\":0.7,\"derivative\":0,\"value\":{\"coordinate\":\"ridges\",\"points\":[{\"location\":-1,\"derivative\":0,\"value\":-0.02},{\"location\":-0.4,\"derivative\":0,\"value\":-0.03},{\"location\":0,\"derivative\":0,\"value\":-0.03},{\"location\":0.4,\"derivative\":0.12,\"value\":0.03},{\"location\":1,\"derivative\":0.049,\"value\":0.1}]}}]}},{\"location\":1,\"derivative\":0,\"value\":{\"coordinate\":\"erosion\",\"points\":[{\"location\":-0.85,\"derivative\":0,\"value\":{\"coordinate\":\"ridges\",\"points\":[{\"location\":-1,\"derivative\":0,\"value\":0.34792626},{\"location\":0,\"derivative\":0.5760369,\"value\":0.9239631},{\"location\":1,\"derivative\":0.5760369,\"value\":1.5}]}},{\"location\":-0.7,\"derivative\":0,\"value\":{\"coordinate\":\"ridges\",\"points\":[{\"location\":-1,\"derivative\":0,\"value\":0.2},{\"location\":0,\"derivative\":0.4608295,\"value\":0.5391705},{\"location\":1,\"derivative\":0.4608295,\"value\":1}]}},{\"location\":-0.4,\"derivative\":0,\"value\":{\"coordinate\":\"ridges\",\"points\":[{\"location\":-1,\"derivative\":0,\"value\":0.2},{\"location\":0,\"derivative\":0.4608295,\"value\":0.5391705},{\"location\":1,\"derivative\":0.4608295,\"value\":1}]}},{\"location\":-0.35,\"derivative\":0,\"value\":{\"coordinate\":\"ridges\",\"points\":[{\"location\":-1,\"derivative\":0.5,\"value\":-0.2},{\"location\":-0.4,\"derivative\":0,\"value\":0.5},{\"location\":0,\"derivative\":0,\"value\":0.5},{\"location\":0.4,\"derivative\":0,\"value\":0.5},{\"location\":1,\"derivative\":0.070000015,\"value\":0.6}]}},{\"location\":-0.1,\"derivative\":0,\"value\":{\"coordinate\":\"ridges\",\"points\":[{\"location\":-1,\"derivative\":0.5,\"value\":-0.05},{\"location\":-0.4,\"derivative\":0.099999994,\"value\":0.01},{\"location\":0,\"derivative\":0.099999994,\"value\":0.03},{\"location\":0.4,\"derivative\":0.94,\"value\":0.5},{\"location\":1,\"derivative\":0.070000015,\"value\":0.6}]}},{\"location\":0.2,\"derivative\":0,\"value\":{\"coordinate\":\"ridges\",\"points\":[{\"location\":-1,\"derivative\":0.5,\"value\":-0.05},{\"location\":-0.4,\"derivative\":0,\"value\":0.01},{\"location\":0,\"derivative\":0,\"value\":0.01},{\"location\":0.4,\"derivative\":0.04,\"value\":0.03},{\"location\":1,\"derivative\":0.049,\"value\":0.1}]}},{\"location\":0.4,\"derivative\":0,\"value\":{\"coordinate\":\"ridges\",\"points\":[{\"location\":-1,\"derivative\":0.5,\"value\":-0.05},{\"location\":-0.4,\"derivative\":0,\"value\":0.01},{\"location\":0,\"derivative\":0,\"value\":0.01},{\"location\":0.4,\"derivative\":0.04,\"value\":0.03},{\"location\":1,\"derivative\":0.049,\"value\":0.1}]}},{\"location\":0.45,\"derivative\":0,\"value\":{\"coordinate\":\"ridges\",\"points\":[{\"location\":-1,\"derivative\":0,\"value\":-0.05},{\"location\":-0.4,\"derivative\":0,\"value\":{\"coordinate\":\"ridges\",\"points\":[{\"location\":-1,\"derivative\":0.5,\"value\":-0.05},{\"location\":-0.4,\"derivative\":0,\"value\":0.01},{\"location\":0,\"derivative\":0,\"value\":0.01},{\"location\":0.4,\"derivative\":0.04,\"value\":0.03},{\"location\":1,\"derivative\":0.049,\"value\":0.1}]}},{\"location\":0,\"derivative\":0,\"value\":0.17}]}},{\"location\":0.55,\"derivative\":0,\"value\":{\"coordinate\":\"ridges\",\"points\":[{\"location\":-1,\"derivative\":0,\"value\":-0.05},{\"location\":-0.4,\"derivative\":0,\"value\":{\"coordinate\":\"ridges\",\"points\":[{\"location\":-1,\"derivative\":0.5,\"value\":-0.05},{\"location\":-0.4,\"derivative\":0,\"value\":0.01},{\"location\":0,\"derivative\":0,\"value\":0.01},{\"location\":0.4,\"derivative\":0.04,\"value\":0.03},{\"location\":1,\"derivative\":0.049,\"value\":0.1}]}},{\"location\":0,\"derivative\":0,\"value\":0.17}]}},{\"location\":0.58,\"derivative\":0,\"value\":{\"coordinate\":\"ridges\",\"points\":[{\"location\":-1,\"derivative\":0.5,\"value\":-0.05},{\"location\":-0.4,\"derivative\":0,\"value\":0.01},{\"location\":0,\"derivative\":0,\"value\":0.01},{\"location\":0.4,\"derivative\":0.04,\"value\":0.03},{\"location\":1,\"derivative\":0.049,\"value\":0.1}]}},{\"location\":0.7,\"derivative\":0,\"value\":{\"coordinate\":\"ridges\",\"points\":[{\"location\":-1,\"derivative\":0.015,\"value\":-0.02},{\"location\":-0.4,\"derivative\":0,\"value\":0.01},{\"location\":0,\"derivative\":0,\"value\":0.01},{\"location\":0.4,\"derivative\":0.04,\"value\":0.03},{\"location\":1,\"derivative\":0.049,\"value\":0.1}]}}]}}]},\"factor\":{\"coordinate\":\"continents\",\"points\":[{\"location\":-0.19,\"derivative\":0,\"value\":3.95},{\"location\":-0.15,\"derivative\":0,\"value\":{\"coordinate\":\"erosion\",\"points\":[{\"location\":-0.6,\"derivative\":0,\"value\":{\"coordinate\":\"weirdness\",\"points\":[{\"location\":-0.2,\"derivative\":0,\"value\":6.3},{\"location\":0.2,\"derivative\":0,\"value\":6.25}]}},{\"location\":-0.5,\"derivative\":0,\"value\":{\"coordinate\":\"weirdness\",\"points\":[{\"location\":-0.05,\"derivative\":0,\"value\":6.3},{\"location\":0.05,\"derivative\":0,\"value\":2.67}]}},{\"location\":-0.35,\"derivative\":0,\"value\":{\"coordinate\":\"weirdness\",\"points\":[{\"location\":-0.2,\"derivative\":0,\"value\":6.3},{\"location\":0.2,\"derivative\":0,\"value\":6.25}]}},{\"location\":-0.25,\"derivative\":0,\"value\":{\"coordinate\":\"weirdness\",\"points\":[{\"location\":-0.2,\"derivative\":0,\"value\":6.3},{\"location\":0.2,\"derivative\":0,\"value\":6.25}]}},{\"location\":-0.1,\"derivative\":0,\"value\":{\"coordinate\":\"weirdness\",\"points\":[{\"location\":-0.05,\"derivative\":0,\"value\":2.67},{\"location\":0.05,\"derivative\":0,\"value\":6.3}]}},{\"location\":0.03,\"derivative\":0,\"value\":{\"coordinate\":\"weirdness\",\"points\":[{\"location\":-0.2,\"derivative\":0,\"value\":6.3},{\"location\":0.2,\"derivative\":0,\"value\":6.25}]}},{\"location\":0.35,\"derivative\":0,\"value\":6.25},{\"location\":0.45,\"derivative\":0,\"value\":{\"coordinate\":\"ridges\",\"points\":[{\"location\":-0.9,\"derivative\":0,\"value\":6.25},{\"location\":-0.69,\"derivative\":0,\"value\":{\"coordinate\":\"weirdness\",\"points\":[{\"location\":0,\"derivative\":0,\"value\":6.25},{\"location\":0.1,\"derivative\":0,\"value\":0.625}]}}]}},{\"location\":0.55,\"derivative\":0,\"value\":{\"coordinate\":\"ridges\",\"points\":[{\"location\":-0.9,\"derivative\":0,\"value\":6.25},{\"location\":-0.69,\"derivative\":0,\"value\":{\"coordinate\":\"weirdness\",\"points\":[{\"location\":0,\"derivative\":0,\"value\":6.25},{\"location\":0.1,\"derivative\":0,\"value\":0.625}]}}]}},{\"location\":0.62,\"derivative\":0,\"value\":6.25}]}},{\"location\":-0.1,\"derivative\":0,\"value\":{\"coordinate\":\"erosion\",\"points\":[{\"location\":-0.6,\"derivative\":0,\"value\":{\"coordinate\":\"weirdness\",\"points\":[{\"location\":-0.2,\"derivative\":0,\"value\":6.3},{\"location\":0.2,\"derivative\":0,\"value\":5.47}]}},{\"location\":-0.5,\"derivative\":0,\"value\":{\"coordinate\":\"weirdness\",\"points\":[{\"location\":-0.05,\"derivative\":0,\"value\":6.3},{\"location\":0.05,\"derivative\":0,\"value\":2.67}]}},{\"location\":-0.35,\"derivative\":0,\"value\":{\"coordinate\":\"weirdness\",\"points\":[{\"location\":-0.2,\"derivative\":0,\"value\":6.3},{\"location\":0.2,\"derivative\":0,\"value\":5.47}]}},{\"location\":-0.25,\"derivative\":0,\"value\":{\"coordinate\":\"weirdness\",\"points\":[{\"location\":-0.2,\"derivative\":0,\"value\":6.3},{\"location\":0.2,\"derivative\":0,\"value\":5.47}]}},{\"location\":-0.1,\"derivative\":0,\"value\":{\"coordinate\":\"weirdness\",\"points\":[{\"location\":-0.05,\"derivative\":0,\"value\":2.67},{\"location\":0.05,\"derivative\":0,\"value\":6.3}]}},{\"location\":0.03,\"derivative\":0,\"value\":{\"coordinate\":\"weirdness\",\"points\":[{\"location\":-0.2,\"derivative\":0,\"value\":6.3},{\"location\":0.2,\"derivative\":0,\"value\":5.47}]}},{\"location\":0.35,\"derivative\":0,\"value\":5.47},{\"location\":0.45,\"derivative\":0,\"value\":{\"coordinate\":\"ridges\",\"points\":[{\"location\":-0.9,\"derivative\":0,\"value\":5.47},{\"location\":-0.69,\"derivative\":0,\"value\":{\"coordinate\":\"weirdness\",\"points\":[{\"location\":0,\"derivative\":0,\"value\":5.47},{\"location\":0.1,\"derivative\":0,\"value\":0.625}]}}]}},{\"location\":0.55,\"derivative\":0,\"value\":{\"coordinate\":\"ridges\",\"points\":[{\"location\":-0.9,\"derivative\":0,\"value\":5.47},{\"location\":-0.69,\"derivative\":0,\"value\":{\"coordinate\":\"weirdness\",\"points\":[{\"location\":0,\"derivative\":0,\"value\":5.47},{\"location\":0.1,\"derivative\":0,\"value\":0.625}]}}]}},{\"location\":0.62,\"derivative\":0,\"value\":5.47}]}},{\"location\":0.03,\"derivative\":0,\"value\":{\"coordinate\":\"erosion\",\"points\":[{\"location\":-0.6,\"derivative\":0,\"value\":{\"coordinate\":\"weirdness\",\"points\":[{\"location\":-0.2,\"derivative\":0,\"value\":6.3},{\"location\":0.2,\"derivative\":0,\"value\":5.08}]}},{\"location\":-0.5,\"derivative\":0,\"value\":{\"coordinate\":\"weirdness\",\"points\":[{\"location\":-0.05,\"derivative\":0,\"value\":6.3},{\"location\":0.05,\"derivative\":0,\"value\":2.67}]}},{\"location\":-0.35,\"derivative\":0,\"value\":{\"coordinate\":\"weirdness\",\"points\":[{\"location\":-0.2,\"derivative\":0,\"value\":6.3},{\"location\":0.2,\"derivative\":0,\"value\":5.08}]}},{\"location\":-0.25,\"derivative\":0,\"value\":{\"coordinate\":\"weirdness\",\"points\":[{\"location\":-0.2,\"derivative\":0,\"value\":6.3},{\"location\":0.2,\"derivative\":0,\"value\":5.08}]}},{\"location\":-0.1,\"derivative\":0,\"value\":{\"coordinate\":\"weirdness\",\"points\":[{\"location\":-0.05,\"derivative\":0,\"value\":2.67},{\"location\":0.05,\"derivative\":0,\"value\":6.3}]}},{\"location\":0.03,\"derivative\":0,\"value\":{\"coordinate\":\"weirdness\",\"points\":[{\"location\":-0.2,\"derivative\":0,\"value\":6.3},{\"location\":0.2,\"derivative\":0,\"value\":5.08}]}},{\"location\":0.35,\"derivative\":0,\"value\":5.08},{\"location\":0.45,\"derivative\":0,\"value\":{\"coordinate\":\"ridges\",\"points\":[{\"location\":-0.9,\"derivative\":0,\"value\":5.08},{\"location\":-0.69,\"derivative\":0,\"value\":{\"coordinate\":\"weirdness\",\"points\":[{\"location\":0,\"derivative\":0,\"value\":5.08},{\"location\":0.1,\"derivative\":0,\"value\":0.625}]}}]}},{\"location\":0.55,\"derivative\":0,\"value\":{\"coordinate\":\"ridges\",\"points\":[{\"location\":-0.9,\"derivative\":0,\"value\":5.08},{\"location\":-0.69,\"derivative\":0,\"value\":{\"coordinate\":\"weirdness\",\"points\":[{\"location\":0,\"derivative\":0,\"value\":5.08},{\"location\":0.1,\"derivative\":0,\"value\":0.625}]}}]}},{\"location\":0.62,\"derivative\":0,\"value\":5.08}]}},{\"location\":0.06,\"derivative\":0,\"value\":{\"coordinate\":\"erosion\",\"points\":[{\"location\":-0.6,\"derivative\":0,\"value\":{\"coordinate\":\"weirdness\",\"points\":[{\"location\":-0.2,\"derivative\":0,\"value\":6.3},{\"location\":0.2,\"derivative\":0,\"value\":4.69}]}},{\"location\":-0.5,\"derivative\":0,\"value\":{\"coordinate\":\"weirdness\",\"points\":[{\"location\":-0.05,\"derivative\":0,\"value\":6.3},{\"location\":0.05,\"derivative\":0,\"value\":2.67}]}},{\"location\":-0.35,\"derivative\":0,\"value\":{\"coordinate\":\"weirdness\",\"points\":[{\"location\":-0.2,\"derivative\":0,\"value\":6.3},{\"location\":0.2,\"derivative\":0,\"value\":4.69}]}},{\"location\":-0.25,\"derivative\":0,\"value\":{\"coordinate\":\"weirdness\",\"points\":[{\"location\":-0.2,\"derivative\":0,\"value\":6.3},{\"location\":0.2,\"derivative\":0,\"value\":4.69}]}},{\"location\":-0.1,\"derivative\":0,\"value\":{\"coordinate\":\"weirdness\",\"points\":[{\"location\":-0.05,\"derivative\":0,\"value\":2.67},{\"location\":0.05,\"derivative\":0,\"value\":6.3}]}},{\"location\":0.03,\"derivative\":0,\"value\":{\"coordinate\":\"weirdness\",\"points\":[{\"location\":-0.2,\"derivative\":0,\"value\":6.3},{\"location\":0.2,\"derivative\":0,\"value\":4.69}]}},{\"location\":0.05,\"derivative\":0,\"value\":{\"coordinate\":\"ridges\",\"points\":[{\"location\":0.45,\"derivative\":0,\"value\":{\"coordinate\":\"weirdness\",\"points\":[{\"location\":-0.2,\"derivative\":0,\"value\":6.3},{\"location\":0.2,\"derivative\":0,\"value\":4.69}]}},{\"location\":0.7,\"derivative\":0,\"value\":1.56}]}},{\"location\":0.4,\"derivative\":0,\"value\":{\"coordinate\":\"ridges\",\"points\":[{\"location\":0.45,\"derivative\":0,\"value\":{\"coordinate\":\"weirdness\",\"points\":[{\"location\":-0.2,\"derivative\":0,\"value\":6.3},{\"location\":0.2,\"derivative\":0,\"value\":4.69}]}},{\"location\":0.7,\"derivative\":0,\"value\":1.56}]}},{\"location\":0.45,\"derivative\":0,\"value\":{\"coordinate\":\"ridges\",\"points\":[{\"location\":-0.7,\"derivative\":0,\"value\":{\"coordinate\":\"weirdness\",\"points\":[{\"location\":-0.2,\"derivative\":0,\"value\":6.3},{\"location\":0.2,\"derivative\":0,\"value\":4.69}]}},{\"location\":-0.15,\"derivative\":0,\"value\":1.37}]}},{\"location\":0.55,\"derivative\":0,\"value\":{\"coordinate\":\"ridges\",\"points\":[{\"location\":-0.7,\"derivative\":0,\"value\":{\"coordinate\":\"weirdness\",\"points\":[{\"location\":-0.2,\"derivative\":0,\"value\":6.3},{\"location\":0.2,\"derivative\":0,\"value\":4.69}]}},{\"location\":-0.15,\"derivative\":0,\"value\":1.37}]}},{\"location\":0.58,\"derivative\":0,\"value\":4.69}]}}]},\"jaggedness\":{\"coordinate\":\"continents\",\"points\":[{\"location\":-0.11,\"derivative\":0,\"value\":0},{\"location\":0.03,\"derivative\":0,\"value\":{\"coordinate\":\"erosion\",\"points\":[{\"location\":-1,\"derivative\":0,\"value\":{\"coordinate\":\"ridges\",\"points\":[{\"location\":0.19999999,\"derivative\":0,\"value\":0},{\"location\":0.44999996,\"derivative\":0,\"value\":0},{\"location\":1,\"derivative\":0,\"value\":{\"coordinate\":\"weirdness\",\"points\":[{\"location\":-0.01,\"derivative\":0,\"value\":0.63},{\"location\":0.01,\"derivative\":0,\"value\":0.3}]}}]}},{\"location\":-0.78,\"derivative\":0,\"value\":{\"coordinate\":\"ridges\",\"points\":[{\"location\":0.19999999,\"derivative\":0,\"value\":0},{\"location\":0.44999996,\"derivative\":0,\"value\":0},{\"location\":1,\"derivative\":0,\"value\":{\"coordinate\":\"weirdness\",\"points\":[{\"location\":-0.01,\"derivative\":0,\"value\":0.315},{\"location\":0.01,\"derivative\":0,\"value\":0.15}]}}]}},{\"location\":-0.5775,\"derivative\":0,\"value\":{\"coordinate\":\"ridges\",\"points\":[{\"location\":0.19999999,\"derivative\":0,\"value\":0},{\"location\":0.44999996,\"derivative\":0,\"value\":0},{\"location\":1,\"derivative\":0,\"value\":{\"coordinate\":\"weirdness\",\"points\":[{\"location\":-0.01,\"derivative\":0,\"value\":0.315},{\"location\":0.01,\"derivative\":0,\"value\":0.15}]}}]}},{\"location\":-0.375,\"derivative\":0,\"value\":0}]}},{\"location\":0.65,\"derivative\":0,\"value\":{\"coordinate\":\"erosion\",\"points\":[{\"location\":-1,\"derivative\":0,\"value\":{\"coordinate\":\"ridges\",\"points\":[{\"location\":0.19999999,\"derivative\":0,\"value\":0},{\"location\":0.44999996,\"derivative\":0,\"value\":{\"coordinate\":\"weirdness\",\"points\":[{\"location\":-0.01,\"derivative\":0,\"value\":0.63},{\"location\":0.01,\"derivative\":0,\"value\":0.3}]}},{\"location\":1,\"derivative\":0,\"value\":{\"coordinate\":\"weirdness\",\"points\":[{\"location\":-0.01,\"derivative\":0,\"value\":0.63},{\"location\":0.01,\"derivative\":0,\"value\":0.3}]}}]}},{\"location\":-0.78,\"derivative\":0,\"value\":{\"coordinate\":\"ridges\",\"points\":[{\"location\":0.19999999,\"derivative\":0,\"value\":0},{\"location\":0.44999996,\"derivative\":0,\"value\":0},{\"location\":1,\"derivative\":0,\"value\":{\"coordinate\":\"weirdness\",\"points\":[{\"location\":-0.01,\"derivative\":0,\"value\":0.63},{\"location\":0.01,\"derivative\":0,\"value\":0.3}]}}]}},{\"location\":-0.5775,\"derivative\":0,\"value\":{\"coordinate\":\"ridges\",\"points\":[{\"location\":0.19999999,\"derivative\":0,\"value\":0},{\"location\":0.44999996,\"derivative\":0,\"value\":0},{\"location\":1,\"derivative\":0,\"value\":{\"coordinate\":\"weirdness\",\"points\":[{\"location\":-0.01,\"derivative\":0,\"value\":0.63},{\"location\":0.01,\"derivative\":0,\"value\":0.3}]}}]}},{\"location\":-0.375,\"derivative\":0,\"value\":0}]}}]}}}')\n","import type { FixContext } from '../../Fix'\nimport { Fix } from '../../Fix'\nimport { DEFAULT_NOISE } from './DefaultNoise'\n\nconst PROCESSED = new Set()\n\nexport const NoiseSettings = Fix.all(\n\tasync () => {\n\t\tPROCESSED.clear()\n\t},\n\tFix.onFile('worldgen/noise_settings', ({ data }, ctx) => fixNoiseSettings(data, ctx)),\n\tFix.onFile('dimension', ({ data }, ctx) => {\n\t\tif (data.generator?.type?.replace(/^minecraft:/, '') === 'noise') {\n\t\t\tfixNoiseSettings(data.generator.settings, ctx)\n\t\t}\n\t}),\n\tFix.onFile('worldgen/density_function', ({ name, data }, ctx) => {\n\t\tconst id = name.includes(':') ? name : 'minecraft:' + name\n\t\tif (!PROCESSED.has(id)) {\n\t\t\tconsole.debug(`Visiting ${id} with default noise`)\n\t\t\tPROCESSED.add(id)\n\t\t\tfixDensityFunction(data, ctx, DEFAULT_NOISE)\n\t\t}\n\t}),\n)\n\nfunction fixNoiseSettings(data: any, ctx: FixContext) {\n\tif (typeof data !== 'object') return\n\n\tObject.values(data.noise_router).forEach((d) => fixDensityFunction(d, ctx, data.noise))\n\n\tdelete data.noise.terrain_shaper\n\tdelete data.noise.sampling\n\tdelete data.noise.top_slide\n\tdelete data.noise.bottom_slide\n\n\tdata.spawn_target = DEFAULT_SPAWN_TARGET\n}\n\nfunction fixDensityFunction(data: any, ctx: FixContext, noise: any) {\n\tif (typeof data === 'string') {\n\t\tconst id = data.includes(':') ? data : 'minecraft:' + data\n\t\tif (!PROCESSED.has(id)) {\n\t\t\tconsole.debug(`Visiting ${id}`)\n\t\t\tPROCESSED.add(id)\n\t\t\tconst file = ctx.read('worldgen/density_function', id)\n\t\t\tif (file && !file.error && !file.deleted) {\n\t\t\t\tfixDensityFunction(file.data, ctx, noise)\n\t\t\t} else if (DF_DEFAULTS.has(id)) {\n\t\t\t\tconst contents = JSON.parse(DF_DEFAULTS.get(id)!)\n\t\t\t\tfixDensityFunction(contents, ctx, noise)\n\t\t\t\tctx.create('worldgen/density_function', id, contents)\n\t\t\t}\n\t\t} else {\n\t\t\tconsole.debug(`Already visited ${id}`)\n\t\t}\n\t\treturn\n\t}\n\n\tif (typeof data !== 'object') return\n\n\tconst type = data.type.replace(/^minecraft:/, '')\n\tswitch (type) {\n\t\tcase 'abs':\n\t\tcase 'blend_density':\n\t\tcase 'cache_2d':\n\t\tcase 'cache_all_in_cell':\n\t\tcase 'cache_once':\n\t\tcase 'cube':\n\t\tcase 'flat_cache':\n\t\tcase 'half_negative':\n\t\tcase 'interpolated':\n\t\tcase 'quarter_negative':\n\t\tcase 'square':\n\t\tcase 'squeeze':\n\t\t\tfixDensityFunction(data.argument, ctx, noise)\n\t\t\tbreak\n\t\tcase 'add':\n\t\tcase 'max':\n\t\tcase 'min':\n\t\tcase 'mul':\n\t\t\tfixDensityFunction(data.argument1, ctx, noise)\n\t\t\tfixDensityFunction(data.argument2, ctx, noise)\n\t\t\tbreak\n\t\tcase 'clamp':\n\t\tcase 'range_choice':\n\t\tcase 'weird_scaled_sampler':\n\t\t\tfixDensityFunction(data.input, ctx, noise)\n\t\t\tbreak\n\t\tcase 'shifted_noise':\n\t\t\tfixDensityFunction(data.shift_x, ctx, noise)\n\t\t\tfixDensityFunction(data.shift_y, ctx, noise)\n\t\t\tfixDensityFunction(data.shift_z, ctx, noise)\n\t\t\tbreak\n\t\tcase 'old_blended_noise':\n\t\t\tdata.xz_scale = noise.sampling.xz_scale\n\t\t\tdata.y_scale = noise.sampling.y_scale\n\t\t\tdata.xz_factor = noise.sampling.xz_factor\n\t\t\tdata.y_factor = noise.sampling.y_factor\n\t\t\tdata.smear_scale_multiplier = 8\n\t\t\tbreak\n\t\tcase 'slide':\n\t\t\tfixDensityFunction(data.argument, ctx, noise)\n\t\t\tconst slides = createSlides(data.argument, noise)\n\t\t\tdelete data.argument\n\t\t\tObject.assign(data, slides)\n\t\t\tbreak\n\t\tcase 'spline':\n\t\t\tfixSpline(data.spline, ctx, noise)\n\t\t\tdelete data.min_value\n\t\t\tdelete data.max_value\n\t\t\tbreak\n\t\tcase 'terrain_shaper_spline':\n\t\t\tdata.type = 'minecraft:spline'\n\t\t\tfixDensityFunction(data.continentalness, ctx, noise)\n\t\t\tfixDensityFunction(data.erosion, ctx, noise)\n\t\t\tfixDensityFunction(data.weirdness, ctx, noise)\n\t\t\tconst coordinates = {\n\t\t\t\tcontinents: data.continentalness,\n\t\t\t\terosion: data.erosion,\n\t\t\t\tweirdness: data.weirdness,\n\t\t\t\tridges: 'minecraft:overworld/ridges_folded',\n\t\t\t}\n\t\t\tconst splineType = data.spline\n\t\t\tlet spline = fixTerrainSpline(noise.terrain_shaper[splineType], ctx, coordinates)\n\t\t\tif (splineType === 'offset') {\n\t\t\t\tspline = {\n\t\t\t\t\ttype: 'minecraft:add',\n\t\t\t\t\targument1: -0.5037500262260437,\n\t\t\t\t\targument2: {\n\t\t\t\t\t\ttype: 'minecraft:spline',\n\t\t\t\t\t\tspline: data.spline,\n\t\t\t\t\t},\n\t\t\t\t}\n\t\t\t}\n\t\t\tdata.type = 'minecraft:clamp'\n\t\t\tdata.min = data.min_value\n\t\t\tdata.max = data.max_value\n\t\t\tdata.input = spline\n\t\t\tdelete data.spline\n\t\t\tdelete data.min_value\n\t\t\tdelete data.max_value\n\t\t\tdelete data.continentalness\n\t\t\tdelete data.erosion\n\t\t\tdelete data.weirdness\n\t\t\tbreak\n\t}\n}\n\nfunction fixSpline(data: any, ctx: FixContext, noise: any) {\n\tif (typeof data !== 'object') return\n\n\tfixDensityFunction(data.coordinate, ctx, noise)\n\n\tfor (const point of data.points) {\n\t\tfixSpline(point.value, ctx, noise)\n\t}\n}\n\nfunction fixTerrainSpline(data: any, ctx: FixContext, coordinates: Record<string, any>) {\n\tif (typeof data !== 'object') {\n\t\treturn data\n\t}\n\n\tlet coordinate = coordinates[data.coordinate]\n\tif (coordinate === undefined) {\n\t\tctx.warn(`Unknown coordinate ${data.coordinate}`)\n\t\tcoordinate = 0\n\t}\n\n\treturn {\n\t\tcoordinate,\n\t\tpoints: data.points.map((point: any) => ({\n\t\t\tlocation: point.location,\n\t\t\tvalue: fixTerrainSpline(point.value, ctx, coordinates),\n\t\t\tderivative: point.derivative,\n\t\t})),\n\t}\n}\n\nfunction createSlides(input: any, noise: any) {\n\tconst top = noise.top_slide\n\tif (top.size > 0) {\n\t\tconst fromY = noise.min_y + noise.height - (top.offset + top.size) * 4 * noise.size_vertical\n\t\tconst toY = noise.min_y + noise.height - top.offset * 4 * noise.size_vertical\n\t\tconst y = yClampedGradient(fromY, toY, 1, 0)\n\t\tinput = lerp(y, input, top.target)\n\t}\n\tconst bottom = noise.bottom_slide\n\tif (bottom.size > 0) {\n\t\tconst fromY = noise.min_y + bottom.offset * 4 * noise.size_vertical\n\t\tconst toY = noise.min_y + (bottom.offset + bottom.size) * 4 * noise.size_vertical\n\t\tconst y = yClampedGradient(fromY, toY, 0, 1)\n\t\tinput = lerp(y, input, bottom.target)\n\t}\n\treturn input\n}\n\nfunction lerp(a: any, b: any, t: number) {\n\treturn add(mul(a, add(b, -t)), t)\n}\n\nfunction add(a: any, b: any) {\n\treturn {\n\t\ttype: 'minecraft:add',\n\t\targument1: a,\n\t\targument2: b,\n\t}\n}\n\nfunction mul(a: any, b: any) {\n\treturn {\n\t\ttype: 'minecraft:mul',\n\t\targument1: a,\n\t\targument2: b,\n\t}\n}\n\nfunction yClampedGradient(from_y: number, to_y: number, from_value: number, to_value: number) {\n\treturn {\n\t\ttype: 'minecraft:y_clamped_gradient',\n\t\tfrom_y,\n\t\tto_y,\n\t\tfrom_value,\n\t\tto_value,\n\t}\n}\n\nconst DEFAULT_SPAWN_TARGET = JSON.parse('[{\"erosion\":[-1,1],\"depth\":0,\"weirdness\":[-1,-0.16],\"offset\":0,\"temperature\":[-1,1],\"humidity\":[-1,1],\"continentalness\":[-0.11,1]},{\"erosion\":[-1,1],\"depth\":0,\"weirdness\":[0.16,1],\"offset\":0,\"temperature\":[-1,1],\"humidity\":[-1,1],\"continentalness\":[-0.11,1]}]')\n\nconst DF_DEFAULTS = new Map(Object.entries({\n\t'minecraft:overworld/sloped_cheese': '{\"argument1\":{\"argument1\":4,\"argument2\":{\"argument\":{\"argument1\":{\"argument1\":\"minecraft:overworld/depth\",\"argument2\":{\"argument1\":{\"argument\":{\"argument\":{\"argument1\":{\"argument1\":0,\"argument2\":{\"argument1\":1,\"argument2\":{\"argument1\":-1,\"argument2\":{\"argument\":{\"type\":\"minecraft:blend_alpha\"},\"type\":\"minecraft:cache_once\"},\"type\":\"minecraft:mul\"},\"type\":\"minecraft:add\"},\"type\":\"minecraft:mul\"},\"argument2\":{\"argument1\":{\"spline\":\"jaggedness\",\"min_value\":0,\"max_value\":1.28,\"continentalness\":\"minecraft:overworld/continents\",\"erosion\":\"minecraft:overworld/erosion\",\"weirdness\":\"minecraft:overworld/ridges\",\"type\":\"minecraft:terrain_shaper_spline\"},\"argument2\":{\"argument\":{\"type\":\"minecraft:blend_alpha\"},\"type\":\"minecraft:cache_once\"},\"type\":\"minecraft:mul\"},\"type\":\"minecraft:add\"},\"type\":\"minecraft:cache_2d\"},\"type\":\"minecraft:flat_cache\"},\"argument2\":{\"argument\":{\"noise\":\"minecraft:jagged\",\"xz_scale\":1500,\"y_scale\":0,\"type\":\"minecraft:noise\"},\"type\":\"minecraft:half_negative\"},\"type\":\"minecraft:mul\"},\"type\":\"minecraft:add\"},\"argument2\":\"minecraft:overworld/factor\",\"type\":\"minecraft:mul\"},\"type\":\"minecraft:quarter_negative\"},\"type\":\"minecraft:mul\"},\"argument2\":\"minecraft:overworld/base_3d_noise\",\"type\":\"minecraft:add\"}',\n\t'minecraft:overworld/factor': '{\"argument\":{\"argument\":{\"argument1\":{\"argument1\":10,\"argument2\":{\"argument1\":1,\"argument2\":{\"argument1\":-1,\"argument2\":{\"argument\":{\"type\":\"minecraft:blend_alpha\"},\"type\":\"minecraft:cache_once\"},\"type\":\"minecraft:mul\"},\"type\":\"minecraft:add\"},\"type\":\"minecraft:mul\"},\"argument2\":{\"argument1\":{\"spline\":\"factor\",\"min_value\":0,\"max_value\":8,\"continentalness\":\"minecraft:overworld/continents\",\"erosion\":\"minecraft:overworld/erosion\",\"weirdness\":\"minecraft:overworld/ridges\",\"type\":\"minecraft:terrain_shaper_spline\"},\"argument2\":{\"argument\":{\"type\":\"minecraft:blend_alpha\"},\"type\":\"minecraft:cache_once\"},\"type\":\"minecraft:mul\"},\"type\":\"minecraft:add\"},\"type\":\"minecraft:cache_2d\"},\"type\":\"minecraft:flat_cache\"}',\n\t'minecraft:overworld/depth': '{\"argument\":{\"argument\":{\"argument1\":{\"argument1\":10,\"argument2\":{\"argument1\":1,\"argument2\":{\"argument1\":-1,\"argument2\":{\"argument\":{\"type\":\"minecraft:blend_alpha\"},\"type\":\"minecraft:cache_once\"},\"type\":\"minecraft:mul\"},\"type\":\"minecraft:add\"},\"type\":\"minecraft:mul\"},\"argument2\":{\"argument1\":{\"spline\":\"factor\",\"min_value\":0,\"max_value\":8,\"continentalness\":\"minecraft:overworld/continents\",\"erosion\":\"minecraft:overworld/erosion\",\"weirdness\":\"minecraft:overworld/ridges\",\"type\":\"minecraft:terrain_shaper_spline\"},\"argument2\":{\"argument\":{\"type\":\"minecraft:blend_alpha\"},\"type\":\"minecraft:cache_once\"},\"type\":\"minecraft:mul\"},\"type\":\"minecraft:add\"},\"type\":\"minecraft:cache_2d\"},\"type\":\"minecraft:flat_cache\"}',\n\t'minecraft:overworld/base_3d_noise': '{\"type\":\"minecraft:old_blended_noise\"}',\n\t'minecraft:overworld_large_biomes/sloped_cheese': '{\"argument1\":{\"argument1\":4,\"argument2\":{\"argument\":{\"argument1\":{\"argument1\":\"minecraft:overworld_large_biomes/depth\",\"argument2\":{\"argument1\":{\"argument\":{\"argument\":{\"argument1\":{\"argument1\":0,\"argument2\":{\"argument1\":1,\"argument2\":{\"argument1\":-1,\"argument2\":{\"argument\":{\"type\":\"minecraft:blend_alpha\"},\"type\":\"minecraft:cache_once\"},\"type\":\"minecraft:mul\"},\"type\":\"minecraft:add\"},\"type\":\"minecraft:mul\"},\"argument2\":{\"argument1\":{\"spline\":\"jaggedness\",\"min_value\":0,\"max_value\":1.28,\"continentalness\":\"minecraft:overworld_large_biomes/continents\",\"erosion\":\"minecraft:overworld_large_biomes/erosion\",\"weirdness\":\"minecraft:overworld/ridges\",\"type\":\"minecraft:terrain_shaper_spline\"},\"argument2\":{\"argument\":{\"type\":\"minecraft:blend_alpha\"},\"type\":\"minecraft:cache_once\"},\"type\":\"minecraft:mul\"},\"type\":\"minecraft:add\"},\"type\":\"minecraft:cache_2d\"},\"type\":\"minecraft:flat_cache\"},\"argument2\":{\"argument\":{\"noise\":\"minecraft:jagged\",\"xz_scale\":1500,\"y_scale\":0,\"type\":\"minecraft:noise\"},\"type\":\"minecraft:half_negative\"},\"type\":\"minecraft:mul\"},\"type\":\"minecraft:add\"},\"argument2\":\"minecraft:overworld_large_biomes/factor\",\"type\":\"minecraft:mul\"},\"type\":\"minecraft:quarter_negative\"},\"type\":\"minecraft:mul\"},\"argument2\":\"minecraft:overworld/base_3d_noise\",\"type\":\"minecraft:add\"}',\n\t'minecraft:overworld_large_biomes/depth': '{\"argument1\":{\"from_y\":-64,\"to_y\":320,\"from_value\":1.5,\"to_value\":-1.5,\"type\":\"minecraft:y_clamped_gradient\"},\"argument2\":{\"argument\":{\"argument\":{\"argument1\":{\"argument1\":{\"type\":\"minecraft:blend_offset\"},\"argument2\":{\"argument1\":1,\"argument2\":{\"argument1\":-1,\"argument2\":{\"argument\":{\"type\":\"minecraft:blend_alpha\"},\"type\":\"minecraft:cache_once\"},\"type\":\"minecraft:mul\"},\"type\":\"minecraft:add\"},\"type\":\"minecraft:mul\"},\"argument2\":{\"argument1\":{\"spline\":\"offset\",\"min_value\":-0.81,\"max_value\":2.5,\"continentalness\":\"minecraft:overworld_large_biomes/continents\",\"erosion\":\"minecraft:overworld_large_biomes/erosion\",\"weirdness\":\"minecraft:overworld/ridges\",\"type\":\"minecraft:terrain_shaper_spline\"},\"argument2\":{\"argument\":{\"type\":\"minecraft:blend_alpha\"},\"type\":\"minecraft:cache_once\"},\"type\":\"minecraft:mul\"},\"type\":\"minecraft:add\"},\"type\":\"minecraft:cache_2d\"},\"type\":\"minecraft:flat_cache\"},\"type\":\"minecraft:add\"}',\n\t'minecraft:overworld_large_biomes/factor': '{\"argument\":{\"argument\":{\"argument1\":{\"argument1\":10,\"argument2\":{\"argument1\":1,\"argument2\":{\"argument1\":-1,\"argument2\":{\"argument\":{\"type\":\"minecraft:blend_alpha\"},\"type\":\"minecraft:cache_once\"},\"type\":\"minecraft:mul\"},\"type\":\"minecraft:add\"},\"type\":\"minecraft:mul\"},\"argument2\":{\"argument1\":{\"spline\":\"factor\",\"min_value\":0,\"max_value\":8,\"continentalness\":\"minecraft:overworld_large_biomes/continents\",\"erosion\":\"minecraft:overworld_large_biomes/erosion\",\"weirdness\":\"minecraft:overworld/ridges\",\"type\":\"minecraft:terrain_shaper_spline\"},\"argument2\":{\"argument\":{\"type\":\"minecraft:blend_alpha\"},\"type\":\"minecraft:cache_once\"},\"type\":\"minecraft:mul\"},\"type\":\"minecraft:add\"},\"type\":\"minecraft:cache_2d\"},\"type\":\"minecraft:flat_cache\"}',\n}))\n","import { Fix } from '../../Fix'\n\nexport const Predicates = Fix.all(\n\tFix.onFile('predicates', ({ data }) => {\n\t\tif (Array.isArray(data)) {\n\t\t\tdata.forEach(fixCondition)\n\t\t} else {\n\t\t\tfixCondition(data)\n\t\t}\n\t}),\n\tFix.onFile('advancements', ({ data }) => {\n\t\tObject.values(data.criteria).forEach(fixCriterion)\n\t}),\n\tFix.onFile('loot_tables', ({ data }) => {\n\t\tdata.pools?.forEach(fixPool)\n\t}),\n)\n\nfunction fixCriterion(data: any) {\n\tif (typeof data.conditions !== 'object') return\n\n\tfixEntity(data.conditions.entity)\n\tfixEntity(data.conditions.player)\n\tfixEntity(data.conditions.parent)\n\tfixEntity(data.conditions.partner)\n\tfixEntity(data.conditions.child)\n\tfixEntity(data.conditions.villager)\n\tfixEntity(data.conditions.zombie)\n\tfixEntity(data.conditions.projectile)\n\tfixEntity(data.conditions.shooter)\n\tdata.conditions.victims?.forEach(fixEntity)\n\n\tfixDamage(data.conditions.damage)\n\tfixDamage(data.conditions.killing_blow)\n\t\n\tfixLocation(data.conditions.location)\n\tfixLocation(data.conditions.entered)\n\tfixLocation(data.conditions.exited)\n\n\tconst trigger = data.trigger.replace(/^minecraft:/, '')\n\tswitch (trigger) {\n\t\tcase 'location':\n\t\tcase 'slept_in_bed':\n\t\tcase 'hero_of_the_village':\n\t\tcase 'voluntary_exile':\n\t\t\tif (typeof data.conditions !== 'object') break\n\t\t\tconst location = data.conditions.location ? data.conditions.location : data.conditions.player ? undefined : data.conditions\n\t\t\tconst player = data.conditions.player\n\t\t\tdata.conditions = {\n\t\t\t\tplayer: mergePlayerLocation(player, location),\n\t\t\t}\n\t\t\tdelete data.conditions.location\n\t\t\tbreak\n\t}\n}\n\nfunction fixPool(data: any) {\n\tdata.entries?.forEach(fixEntry)\n\tdata.conditions?.forEach(fixCondition)\n}\n\nfunction fixEntry(data: any) {\n\tdata.children?.forEach(fixEntry)\n\tdata.conditions?.forEach(fixCondition)\n}\n\nfunction fixCondition(data: any) {\n\tconst condition = data.condition.replace(/^minecraft:/, '')\n\tswitch (condition) {\n\t\tcase 'entity_properties':\n\t\t\tfixEntity(data.predicate)\n\t\t\tbreak\n\t\tcase 'damage_source_properties':\n\t\t\tfixDamage(data.predicate)\n\t\t\tbreak\n\t\tcase 'location_check':\n\t\t\tfixLocation(data.predicate)\n\t\t\tbreak\n\t}\n}\n\nfunction fixDamage(data: any) {\n\tif (typeof data !== 'object') return\n\n\tfixEntity(data.source_entity)\n\tfixEntity(data.direct_entity)\n\tfixDamage(data.type)\n}\n\nfunction fixEntity(data: any) {\n\tif (typeof data !== 'object') return\n\n\tif (Array.isArray(data)) {\n\t\tdata.forEach(fixCondition)\n\t\treturn\n\t}\n\n\tfixEntity(data.vehicle)\n\tfixEntity(data.targeted_entity)\n\tfixLocation(data.location)\n\n\tif (data.player) {\n\t\tdata.type_specific = {\n\t\t\ttype: 'player',\n\t\t\t...data.player,\n\t\t}\n\t\tdelete data.player\n\t} else if (data.fishing_hook) {\n\t\tdata.type_specific = {\n\t\t\ttype: 'fishing_hook',\n\t\t\t...data.fishing_hook,\n\t\t}\n\t\tdelete data.fishing_hook\n\t} else if (data.lightning_bolt) {\n\t\tdata.type_specific = {\n\t\t\ttype: 'lightning',\n\t\t\t...data.lightning_bolt,\n\t\t}\n\t\tdelete data.lightning_bolt\n\t} else if (data.catType) {\n\t\tconst variant = data.catType.replace(/^textures\\/entity\\/cat\\/([a-z_]+).png/, '$1')\n\t\tdata.type_specific = {\n\t\t\ttype: 'cat',\n\t\t\tvariant,\n\t\t}\n\t\tdelete data.catType\n\t}\n}\n\nfunction fixLocation(data: any) {\n\tif (typeof data !== 'object') return\n\n\tif (typeof data.feature === 'string') {\n\t\tdata.structure = data.feature\n\t\tdelete data.feature\n\t}\n}\n\nfunction mergePlayerLocation(player: any, location: any) {\n\tif (player === undefined) return { location }\n\tif (location === undefined) return player\n\tif (Array.isArray(player) && player.length >= 1) {\n\t\treturn [...player, { condition: 'minecraft:entity_properties', entity: 'this', predicate: { location } }]\n\t}\n\treturn {\n\t\t...player,\n\t\tlocation: {\n\t\t\t...player.location,\n\t\t\t...location,\n\t\t},\n\t}\n}\n","import type { FixContext } from '../../Fix'\nimport { Fix } from '../../Fix'\n\nexport const Structure = Fix.all(\n\tFix.rename('worldgen/configured_structure_feature', 'worldgen/structure'),\n\tFix.rename('tags/worldgen/configured_structure_feature', 'tags/worldgen/structure'),\n\tFix.onFile('worldgen/structure_set', ({ data, name }, ctx) => fixStructureSet(data, name, ctx)),\n\tFix.onFile('worldgen/structure', ({ data }) => fixStructure(data)),\n)\n\nfunction fixStructure(data: any) {\n\tif (typeof data !== 'object') return\n\t\n\tconst type = data.type?.replace(/^minecraft:/, '')\n\tif (type === 'mineshaft') {\n\t\tdata.mineshaft_type = data.config.type\n\t}\n\n\tObject.assign(data, data.config)\n\tdelete data.config\n\tdata.step = 'surface_structures'\n\tdelete data.probability\n\n\tif (data.adapt_noise) {\n\t\tdata.terrain_adaptation = type === 'stronghold' ? 'bury' : 'beard_thin'\n\t\tdelete data.adapt_noise\n\t}\n\n\tswitch (type) {\n\t\tcase 'bastion_remnant':\n\t\t\tdata.type = 'minecraft:jigsaw'\n\t\t\tdata.start_height = { absolute: 33 }\n\t\t\tdata.max_distance_from_center = 80\n\t\t\tdata.use_expansion_hack = false\n\t\t\tbreak\n\t\tcase 'pillager_outpost':\n\t\tcase 'village':\n\t\t\tdata.type = 'minecraft:jigsaw'\n\t\t\tdata.start_height = { absolute: 0 },\n\t\t\tdata.project_start_to_heightmap = 'WORLD_SURFACE_WG'\n\t\t\tdata.max_distance_from_center = 80\n\t\t\tdata.use_expansion_hack = true\n\t\t\tbreak\n\t\tcase 'endcity':\n\t\t\tdata.type = 'minecraft:end_city'\n\t\t\tbreak\n\t\tcase 'jungle_pyramid':\n\t\t\tdata.type = 'minecraft:jungle_temple'\n\t\t\tbreak\n\t\tcase 'mansion':\n\t\t\tdata.type = 'minecraft:woodland_mansion'\n\t\t\tbreak\n\t\tcase 'monument':\n\t\t\tdata.type = 'minecraft:ocean_monument'\n\t\t\tbreak\n\t\tcase 'ruined_portal':\n\t\t\tconst Setups: Record<string, unknown[]> = {\n\t\t\t\tstandard: [\n\t\t\t\t\tsetup({ weight: 0.5, can_be_cold: true, air_pocket_probability: 1, mossiness: 0.2 }),\n\t\t\t\t\tsetup({ weight: 0.5, can_be_cold: true, air_pocket_probability: 0.5, mossiness: 0.2, placement: 'on_land_surface'  }),\n\t\t\t\t],\n\t\t\t\tdesert: [setup({ placement: 'partly_buried' })],\n\t\t\t\tjungle: [setup({ vines: true, overgrown: true, air_pocket_probability: 0.5, mossiness: 0.8, placement: 'on_land_surface' })],\n\t\t\t\tmountain: [\n\t\t\t\t\tsetup({ weight: 0.5, can_be_cold: true, air_pocket_probability: 0.1, mossiness: 0.2, placement: 'in_mountain' }),\n\t\t\t\t\tsetup({ weight: 0.5, can_be_cold: true, air_pocket_probability: 0.5, mossiness: 0.2, placement: 'on_land_surface' }),\n\t\t\t\t],\n\t\t\t\tnether: [setup({ replace_with_blackstone: true, air_pocket_probability: 0.5, placement: 'in_nether' })],\n\t\t\t\tocean: [setup({ can_be_cold: true, mossiness: 0.8, placement: 'on_ocean_floor' })],\n\t\t\t\tswamp: [setup({ vines: true, mossiness: 0.5, placement: 'on_ocean_floor' })],\n\t\t\t}\n\t\t\tdata.setups = Setups[data.portal_type] ?? []\n\t\t\tdelete data.portal_type\n\t}\n}\n\nfunction setup(setup: { weight?: number, vines?: boolean, can_be_cold?: boolean, replace_with_blackstone?: boolean, overgrown?: boolean, air_pocket_probability?: number, mossiness?: number, placement?: string } = {}) {\n\treturn {\n\t\tweight: 1,\n\t\tvines: false,\n\t\tcan_be_cold: false,\n\t\treplace_with_blackstone: false,\n\t\tplacement: 'underground',\n\t\tair_pocket_probability: 0,\n\t\tmossiness: 0,\n\t\tovergrown: false,\n\t\t...setup,\n\t}\n}\n\nfunction fixStructureSet(data: any, name: string, ctx: FixContext) {\n\tif (typeof data !== 'object') return\n\n\tconst structure = ctx.read('worldgen/structure', data.structures[0].structure)?.data\n\tif (!structure) return\n\n\tconst structureType = structure.type?.replace(/^minecraft:/, '')\n\tswitch (structureType) {\n\t\tcase 'mineshaft':\n\t\t\tdata.placement.frequency_reduction_method = 'legacy_type_3'\n\t\t\tdata.placement.frequency = structure.config.probability\n\t\t\tbreak\n\t}\n\n\tif (name === 'minecraft:pillager_outposts') {\n\t\tdata.placement.exclusion_zone ={\n\t\t\tother_set: 'minecraft:villages',\n\t\t\tchunk_count: 10,\n\t\t}\n\t\tdata.placement.frequency_reduction_method = 'legacy_type_1'\n\t\tdata.placement.frequency = 0.2\n\t}\n\n\tconst placementType = data.placement.type?.replace(/^minecraft:/, '')\n\tswitch (placementType) {\n\t\tcase 'concentric_rings':\n\t\t\tdata.placement.salt = 0\n\t\t\tdata.placement.preferred_biomes = '#minecraft:stronghold_biased_to'\n\t\t\tbreak\n\t}\n}\n","import { Fix } from '../../Fix'\nimport { Biome } from './Biome'\nimport { Carver } from './Carver'\nimport { Dimension } from './Dimension'\nimport { Feature } from './Feature'\nimport { Function } from './Function'\nimport { NoiseSettings } from './NoiseSettings'\nimport { Predicates } from './Predicates'\nimport { Structure } from './Structure'\n\nexport const Fixes19 = Fix.version('1.18.2', '1.19', Fix.groupProblems(\n\tFix.debug('1.19 fixes'),\n\tFix.when('worldgen',\n\t\tBiome,\n\t\tCarver,\n\t\tDimension,\n\t\tNoiseSettings,\n\t\tStructure,\n\t\tFeature,\n\t),\n\tFix.when('predicates',\n\t\tPredicates,\n\t),\n\tFix.when('functions',\n\t\tFunction,\n\t),\n\tFix.packFormat(10),\n))\n","import { Fix } from '../../Fix'\n\nexport const Advancement = Fix.all(\n\tFix.onFile('advancements', ({ data }) => {\n\t\tObject.values(data.criteria).forEach(fixCriterion)\n\t}),\n)\n\nfunction fixCriterion(data: any) {\n\tconst trigger = data.trigger.replace(/^minecraft:/, '')\n\tswitch (trigger) {\n\t\tcase 'nether_travel':\n\t\t\tif (typeof data.conditions !== 'object') break\n\t\t\tconst { distance, entered, exited, player } = data.conditions\n\t\t\tdata.conditions = {\n\t\t\t\tplayer: mergePlayerLocation(player, exited),\n\t\t\t\tstart_position: entered,\n\t\t\t\tdistance: distance,\n\t\t\t}\n\t\t\tbreak\n\t}\n}\n\nfunction mergePlayerLocation(player: any, location: any) {\n\tif (player === undefined) return { location }\n\tif (Array.isArray(player) && player.length >= 1) {\n\t\treturn [player, { type: 'minecraft:entity_properties', predicate: { location } }]\n\t}\n\treturn {\n\t\t...player,\n\t\tlocation: {\n\t\t\t...player.location,\n\t\t\t...location,\n\t\t},\n\t}\n}\n","import type { FixContext } from '../../Fix'\nimport { Fix } from '../../Fix'\nimport type { PackFile } from '../../Pack'\n\nexport const Biome = Fix.all(\n\tFix.onFile('worldgen/biome', fixBiome),\n)\n\nfunction fixBiome({ data }: PackFile, ctx: FixContext) {\n\tctx.warn('Biome \"depth\" and \"scale\" were removed and replaced with a more powerful terrain shaper option in noise settings. No automatic upgrade possible.')\n\tdata.depth = undefined\n\tdata.scale = undefined\n\n\tctx.warn('Biome \"surface_builder\" was removed and replaced with a more powerful surface_rule option in noise settings. No automatic upgrade possible.')\n\tdata.surface_builder = undefined\n\n\tif (Array.isArray(data.starts) && data.starts.length > 0) {\n\t\tctx.warn('Biome \"starts\" was removed, custom structures are not supported in 1.18.')\n\t}\n\tdata.starts = undefined\n\n\tif (Array.isArray(data.features) && data.features.length >= 9) {\n\t\t(data.features as any[]).splice(8, 0, [])\n\t}\n\n\t// Particle fix (should've been in 1.16 -> 1.17)\n\tconst particle = data.effects.particle?.options\n\tif (particle?.type?.replace(/minecraft:/, '') === 'dust' && particle.r) {\n\t\tdata.effects.particle.options = {\n\t\t\ttype: 'minecraft:dust',\n\t\t\tcolor: [particle.r, particle.g, particle.b],\n\t\t\tscale: particle.scale,\n\t\t}\n\t}\n}\n","import type { FixContext } from '../../Fix'\nimport { Fix } from '../../Fix'\n\nexport const Dimension = Fix.all(\n\tFix.onFile('dimension', ({ data }, ctx) => {\n\t\tif (data.generator?.type?.replace(/^minecraft:/, '') === 'noise') {\n\t\t\tconst biomes = fixBiomeSource(data.generator.biome_source, ctx)\n\t\t\tfixNoiseSettings(data.generator.settings, ctx, biomes)\n\t\t}\n\t}),\n\tFix.onFile('worldgen/noise_settings', ({ data }, ctx) => {\n\t\tfixNoiseSettings(data, ctx)\n\t}),\n)\n\n// Returns a list of biome IDs\nfunction fixBiomeSource(data: any, ctx: FixContext) {\n\tif (typeof data !== 'object') return []\n\n\tconst type = data.type.replace(/^minecraft:/, '')\n\tswitch (type) {\n\t\tcase 'fixed':\n\t\t\treturn [data.biome]\n\t\tcase 'checkerboard':\n\t\t\treturn [...new Set<string>(data.biomes)]\n\t\tcase 'multi_noise':\n\t\t\tdata.seed = undefined\n\t\t\tif (data.preset?.replace(/^minecraft:/, '') === 'nether') {\n\t\t\t\treturn ['nether_wastes', 'soul_sand_valley', 'crimson_forest', 'warped_forest', 'basalt_deltas']\n\t\t\t}\n\t\t\tdata.altitude_noise = undefined\n\t\t\tdata.temperature_noise = undefined\n\t\t\tdata.humidity_noise = undefined\n\t\t\tdata.weirdness_noise = undefined\n\t\t\tdata.biomes.forEach((b: any) => {\n\t\t\t\tb.parameters = {\n\t\t\t\t\ttemperature: b.parameters.temperature,\n\t\t\t\t\thumidity: b.parameters.humidity,\n\t\t\t\t\tcontinentalness: b.parameters.altitude,\n\t\t\t\t\terosion: 0,\n\t\t\t\t\tweirdness: b.parameters.weirdness,\n\t\t\t\t\tdepth: 0,\n\t\t\t\t\toffset: b.parameters.offset,\n\t\t\t\t}\n\t\t\t})\n\t\t\treturn [...new Set<string>(data.biomes.map((b: any) => b.biome))]\n\t\tcase 'vanilla_layered':\n\t\t\tctx.warn('Removed biome source \"vanilla_layered\", replaced with the multi noise overworld preset.')\n\t\t\tdata.type = 'multi_noise'\n\t\t\tdata.preset = 'minecraft:overworld'\n\t\t\treturn []\n\t}\n\treturn []\n}\n\nfunction fixNoiseSettings(data: any, ctx: FixContext, biomes: string[] = []) {\n\tif (typeof data === 'string') {\n\t\tconst file = ctx.read('worldgen/noise_settings', data)\n\t\tif (file) {\n\t\t\tfixNoiseSettings(file.data, ctx, biomes)\n\t\t}\n\t\treturn\n\t}\n\tif (typeof data !== 'object') return\n\n\tif (data.surface_rule !== undefined) return\n\n\tdata.legacy_random_source = false\n\n\tdata.noise.top_slide.target /= 128\n\tdata.noise.bottom_slide.target /= 128\n\t\n\tdata.min_surface_level = undefined\n\tdata.noise.simplex_surface_noise = undefined\n\tdata.noise.random_density_offset = undefined\n\n\tdata.noise.terrain_shaper = {\n\t\toffset: 0,\n\t\tfactor: 0,\n\t\tjaggedness: 0,\n\t}\n\n\tdata.noise.density_offset = undefined\n\tdata.noise.density_factor = undefined\n\n\tconst rules = []\n\n\tif (data.bedrock_floor_position > -10) {\n\t\trules.push(ifTrue('vertical_gradient', {\n\t\t\trandom_name: 'minecraft:bedrock_floor',\n\t\t\ttrue_at_and_below: { above_bottom: data.bedrock_floor_position + 5 },\n\t\t\tfalse_at_and_above: { above_bottom: data.bedrock_floor_position },\n\t\t}).thenRun('block', {\n\t\t\tresult_state: { Name: 'minecraft:bedrock' },\n\t\t}))\n\t}\n\tif (data.bedrock_roof_position > -10) {\n\t\trules.push(ifNotTrue('vertical_gradient', {\n\t\t\trandom_name: 'minecraft:bedrock_roof',\n\t\t\ttrue_at_and_below: { below_top: data.bedrock_roof_position + 5 },\n\t\t\tfalse_at_and_above: { below_top: data.bedrock_roof_position },\n\t\t}).thenRun('block', {\n\t\t\tresult_state: { Name: 'minecraft:bedrock' },\n\t\t}))\n\t}\n\t// TODO: add surface rules for the biomes\n\tif (data.deepslate_enabled) {\n\t\trules.push(ifTrue('vertical_gradient', {\n\t\t\trandom_name: 'minecraft:deepslate',\n\t\t\ttrue_at_and_below: { absolute: 0 },\n\t\t\tfalse_at_and_above: { absolute: 8 },\n\t\t}).thenRun('block', {\n\t\t\tresult_state: { Name: 'minecraft:deepslate', Properties: { axis: 'y' } },\n\t\t}))\n\t}\n\n\tdata.surface_rule = {\n\t\ttype: 'minecraft:sequence',\n\t\tsequence: rules,\n\t}\n}\n\nfunction ifTrue(conditionType: string, conditionData: any) {\n\treturn {\n\t\tthenRun: (ruleType: string, ruleData: any) => ({\n\t\t\ttype: 'minecraft:condition',\n\t\t\tif_true: { type: `minecraft:${conditionType}`, ...conditionData },\n\t\t\tthen_run: { type: `minecraft:${ruleType}`, ...ruleData },\n\t\t}),\n\t}\n}\n\nfunction ifNotTrue(conditionType: string, conditionData: any) {\n\treturn ifTrue('not', {\n\t\tinvert: { type: `minecraft:${conditionType}`, ...conditionData },\n\t})\n}\n","import type { FixContext } from '../../Fix'\nimport { Fix } from '../../Fix'\n\nexport const Feature = Fix.all(\n\tFix.onFile('worldgen/configured_feature', ({ data }, ctx) => fixFeature(data, ctx)),\n)\n\nfunction fixFeature(data: any, ctx: FixContext) {\n\tif (typeof data !== 'object') return\n\n\tconst type = data.type.replace(/^minecraft:/, '')\n\tswitch (type) {\n\t\tcase 'decorated':\n\t\t\tfixDecorator(data.config.decorator, ctx)\n\t\t\tfixFeature(data.config.feature, ctx)\n\t\t\tbreak\n\t\tcase 'random_boolean_selector':\n\t\t\tfixFeature(data.config.feature_false, ctx)\n\t\t\tfixFeature(data.config.feature_true, ctx)\n\t\t\tbreak\n\t\tcase 'random_selector':\n\t\t\tdata.config.features.forEach((e: any) => fixFeature(e.feature, ctx))\n\t\t\tfixFeature(data.config.default, ctx)\n\t\t\tbreak\n\t\tcase 'simple_random_selector':\n\t\t\tdata.config.features.forEach((feature: any) => fixFeature(feature, ctx))\n\t\t\tbreak\n\t\tcase 'flower':\n\t\tcase 'no_bonemeal_flower':\n\t\tcase 'random_patch':\n\t\t\tif (data.config.xspread !== data.config.zspread) {\n\t\t\t\tctx.warn('Random patch xspread and zspread can no longer be different. Using xspread.')\n\t\t\t}\n\t\t\tconst filters: any[] = []\n\t\t\tif (data.config.can_replace !== true) {\n\t\t\t\tfilters.push({\n\t\t\t\t\ttype: 'minecraft:matching_blocks',\n\t\t\t\t\tblocks: ['minecraft:air'],\n\t\t\t\t})\n\t\t\t}\n\t\t\tif (isNonEmptyList(data.config.whitelist)) {\n\t\t\t\tfilters.push({\n\t\t\t\t\ttype: 'minecraft:matching_blocks',\n\t\t\t\t\toffset: [0, -1, 0],\n\t\t\t\t\tblocks: getBlockIds(data.config.whitelist),\n\t\t\t\t})\n\t\t\t}\n\t\t\tif (isNonEmptyList(data.config.blacklist)) {\n\t\t\t\tfilters.push({\n\t\t\t\t\ttype: 'minecraft:not',\n\t\t\t\t\tpredicate: {\n\t\t\t\t\t\ttype: 'minecraft:matching_blocks',\n\t\t\t\t\t\toffset: [0, -1, 0],\n\t\t\t\t\t\tblocks: getBlockIds(data.config.blacklist),\n\t\t\t\t\t},\n\t\t\t\t})\n\t\t\t}\n\t\t\tconst placer = data.config.block_placer.type.replace(/^minecraft:/, '')\n\t\t\tconst feature = placer === 'column_placer' ? {\n\t\t\t\ttype: 'minecraft:block_column',\n\t\t\t\tconfig: {\n\t\t\t\t\tdirection: 'up',\n\t\t\t\t\tallowed_placement: data.config.can_replace !== true ? {\n\t\t\t\t\t\ttype: 'minecraft:matching_blocks',\n\t\t\t\t\t\tblocks: ['minecraft:air'],\n\t\t\t\t\t} : { type: 'minecraft:true' },\n\t\t\t\t\tprioritize_tip: false,\n\t\t\t\t\tlayers: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\theight: data.config.block_placer.size,\n\t\t\t\t\t\t\tprovider: data.config.state_provider,\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t} : {\n\t\t\t\ttype: 'minecraft:simple_block',\n\t\t\t\tconfig: {\n\t\t\t\t\tto_place: data.config.state_provider,\n\t\t\t\t},\n\t\t\t}\n\t\t\tdata.config = {\n\t\t\t\ttries: data.config.tries,\n\t\t\t\txz_spread: data.config.xspread,\n\t\t\t\ty_spread: data.config.yspread,\n\t\t\t\tfeature: decorated(feature, [\n\t\t\t\t\t{\n\t\t\t\t\t\ttype: 'minecraft:block_filter',\n\t\t\t\t\t\tconfig: {\n\t\t\t\t\t\t\tpredicate: {\n\t\t\t\t\t\t\t\ttype: 'minecraft:all_of',\n\t\t\t\t\t\t\t\tpredicates: filters,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t]),\n\t\t\t}\n\t\t\tif (data.config.project === true) {\n\t\t\t\tdata.config = {\n\t\t\t\t\tdecorator: {\n\t\t\t\t\t\ttype: 'heightmap',\n\t\t\t\t\t\tconfig: {\n\t\t\t\t\t\t\theightmap: 'OCEAN_FLOOR',\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\tfeature: {\n\t\t\t\t\t\ttype: data.type,\n\t\t\t\t\t\tconfig: data.config,\n\t\t\t\t\t},\n\t\t\t\t}\n\t\t\t\tdata.type = 'minecraft:decorated'\n\t\t\t}\n\t\t\tbreak\n\t\tcase 'growing_plant':\n\t\t\tdata.type = 'minecraft:block_column'\n\t\t\tdata.config = {\n\t\t\t\tdirection: data.config.direction,\n\t\t\t\tallowed_placement: data.config.allow_water !== true ? {\n\t\t\t\t\ttype: 'minecraft:matching_blocks',\n\t\t\t\t\tblocks: ['minecraft:air'],\n\t\t\t\t} : { type: 'minecraft:true' },\n\t\t\t\tprioritize_tip: true,\n\t\t\t\tlayers: [\n\t\t\t\t\t{\n\t\t\t\t\t\theight: {\n\t\t\t\t\t\t\ttype: 'minecraft:weighted_list',\n\t\t\t\t\t\t\tdistribution: data.config.height_distribution.map((e: any) => ({\n\t\t\t\t\t\t\t\tweight: e.weight,\n\t\t\t\t\t\t\t\tdata: deltaIntProvider(e.data, -1, 0, Infinity),\n\t\t\t\t\t\t\t})),\n\t\t\t\t\t\t},\n\t\t\t\t\t\tprovider: data.config.body_provider,\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\theight: 1,\n\t\t\t\t\t\tprovider: data.config.head_provider,\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t}\n\t\t\tbreak\n\t\tcase 'root_system':\n\t\t\tfixFeature(data.config.feature, ctx)\n\t\t\tbreak\n\t\tcase 'simple_block':\n\t\t\tconst filters2 = []\n\t\t\tif (isNonEmptyList(data.config.place_on)) {\n\t\t\t\tfilters2.push({\n\t\t\t\t\ttype: 'minecraft:matching_blocks',\n\t\t\t\t\toffset: [0, -1, 0],\n\t\t\t\t\tblocks: getBlockIds(data.config.place_on),\n\t\t\t\t})\n\t\t\t}\n\t\t\tif (isNonEmptyList(data.config.place_in)) {\n\t\t\t\tfilters2.push({\n\t\t\t\t\ttype: 'minecraft:matching_blocks',\n\t\t\t\t\tblocks: getBlockIds(data.config.place_in),\n\t\t\t\t})\n\t\t\t}\n\t\t\tif (isNonEmptyList(data.config.place_under)) {\n\t\t\t\tfilters2.push({\n\t\t\t\t\ttype: 'minecraft:matching_blocks',\n\t\t\t\t\toffset: [0, 1, 0],\n\t\t\t\t\tblocks: getBlockIds(data.config.place_under),\n\t\t\t\t})\n\t\t\t}\n\t\t\tdata.config.place_on = undefined\n\t\t\tdata.config.place_in = undefined\n\t\t\tdata.config.place_under = undefined\n\t\t\tif (filters2.length > 0) {\n\t\t\t\tdata.type = 'minecraft:decorated',\n\t\t\t\tdata.config = {\n\t\t\t\t\tdecorator: {\n\t\t\t\t\t\ttype: 'minecraft:block_filter',\n\t\t\t\t\t\tconfig: {\n\t\t\t\t\t\t\tpredicate: filters2.length == 1 ? filters2[0] : {\n\t\t\t\t\t\t\t\ttype: 'minecraft:all_of',\n\t\t\t\t\t\t\t\tpredicates: filters2,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\tfeature: {\n\t\t\t\t\t\ttype: 'minecraft:simple_block',\n\t\t\t\t\t\tconfig: data.config,\n\t\t\t\t\t},\n\t\t\t\t}\n\t\t\t}\n\t\t\tbreak\n\t\tcase 'small_dripstone':\n\t\t\tconst pointed_dripstone = (surface: string) => decorated({\n\t\t\t\ttype: 'minecraft:pointed_dripstone',\n\t\t\t\tconfig: {\n\t\t\t\t\tchance_of_taller_dripstone: data.config.chance_of_taller_dripstone,\n\t\t\t\t\tchance_of_directional_spread: 0.7,\n\t\t\t\t\tchance_of_spread_radius2: 0.5,\n\t\t\t\t\tchance_of_spread_radius3: 0.5,\n\t\t\t\t},\n\t\t\t}, [{\n\t\t\t\ttype: 'minecraft:cave_surface',\n\t\t\t\tconfig: {\n\t\t\t\t\tsurface,\n\t\t\t\t\tfloor_to_ceiling_search_range: 12,\n\t\t\t\t\tallow_water: true,\n\t\t\t\t},\n\t\t\t}])\n\t\t\tdata.type = 'minecraft:decorated'\n\t\t\tdata.config = decorated({\n\t\t\t\ttype: 'minecraft:simple_random_selector',\n\t\t\t\tconfig: {\n\t\t\t\t\tfeatures: [\n\t\t\t\t\t\tpointed_dripstone('floor'),\n\t\t\t\t\t\tpointed_dripstone('ceiling'),\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t}, [\n\t\t\t\t{\n\t\t\t\t\ttype: 'count',\n\t\t\t\t\tconfig: {\n\t\t\t\t\t\tcount: {\n\t\t\t\t\t\t\ttype: 'minecraft:uniform',\n\t\t\t\t\t\t\tvalue: { min_inclusive: 1, max_inclusive: data.config.max_placements },\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttype: 'minecraft:scatter',\n\t\t\t\t\tconfig: {\n\t\t\t\t\t\txz_spread: {\n\t\t\t\t\t\t\ttype: 'minecraft:clamped_normal',\n\t\t\t\t\t\t\tvalue: { mean: 0.0, deviation: 3.0, min_inclusive: -10, max_inclusive: 10 },\n\t\t\t\t\t\t},\n\t\t\t\t\t\ty_spread: {\n\t\t\t\t\t\t\ttype: 'minecraft:clamped_normal',\n\t\t\t\t\t\t\tvalue: { mean: 0.0, deviation: 0.6, min_inclusive: -2, max_inclusive: 2 },\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t]).config\n\t\t\tbreak\n\t\tcase 'vegetation_patch':\n\t\tcase 'waterlogged_vegetation_patch':\n\t\t\tfixFeature(data.config.vegetation_feature, ctx)\n\t}\n}\n\nfunction deltaIntProvider(data: any, delta: number, min: number, max: number): any {\n\tif (typeof data === 'number') return data + delta\n\n\tconst type = data.type.replace(/^minecraft:/, '')\n\tswitch (type) {\n\t\tcase 'constant':\n\t\t\treturn {\n\t\t\t\ttype: data.type,\n\t\t\t\tvalue: Math.max(min, Math.min(max, data.value + delta)),\n\t\t\t}\n\t\tcase 'uniform':\n\t\tcase 'biased_to_bottom':\n\t\t\treturn {\n\t\t\t\ttype: data.type,\n\t\t\t\tvalue: {\n\t\t\t\t\tmin_inclusive: Math.max(min, Math.min(max, data.value.min_inclusive + delta)),\n\t\t\t\t\tmax_inclusive: Math.max(min, Math.min(max, data.value.max_inclusive + delta)),\n\t\t\t\t},\n\t\t\t}\n\t\tcase 'clamped':\n\t\t\treturn {\n\t\t\t\ttype: data.type,\n\t\t\t\tvalue: {\n\t\t\t\t\tmin_inclusive: Math.max(min, Math.min(max, data.value.min_inclusive + delta)),\n\t\t\t\t\tmax_inclusive: Math.max(min, Math.min(max, data.value.max_inclusive + delta)),\n\t\t\t\t\tsource: deltaIntProvider(data.value.source, delta, min, max),\n\t\t\t\t},\n\t\t\t}\n\t}\n\tthrow new Error(`Unknown int provider \"${type}\"`)\n}\n\nfunction fixDecorator(data: any, ctx: FixContext) {\n\tif (typeof data !== 'object') return\n\n\tconst type = data.type.replace(/^minecraft:/, '')\n\tswitch (type) {\n\t\tcase 'decorated':\n\t\t\tfixDecorator(data.config.outer, ctx)\n\t\t\tfixDecorator(data.config.inner, ctx)\n\t\t\tbreak\n\t\tcase 'cave_surface':\n\t\t\tdata.config.allow_water = false\n\t\t\tbreak\n\t\tcase 'heightmap_spread_double':\n\t\t\tctx.warn('Removed decorator \"heightmap_spread_double\" was replaced with \"heightmap\". You likely need to make this feature rarer.')\n\t\t\tdata.type = 'minecraft:heightmap'\n\t\t\tbreak\n\t\tcase 'spread_32_above':\n\t\t\tctx.warn('Removed decorator \"spread_32_above\". You likely need to make this feature rarer.')\n\t\t\tdata.type = 'minecraft:nope'\n\t\t\tbreak\n\t}\n}\n\nfunction decorated(feature: any, decorators: any[] = []): any {\n\tif (decorators.length == 0) {\n\t\treturn feature\n\t}\n\treturn {\n\t\ttype: 'minecraft:decorated',\n\t\tconfig: {\n\t\t\tdecorator: decorators[0],\n\t\t\tfeature: decorated(feature, decorators.slice(1)),\n\t\t},\n\t}\n}\n\nfunction isNonEmptyList(obj: unknown): obj is unknown[] {\n\treturn Array.isArray(obj) && obj.length > 0\n}\n\nfunction getBlockIds(states: any[]) {\n\treturn [...new Set(states.map((state: any) => state.Name))]\n}\n","import { Fix } from '../../Fix'\nimport { Advancement } from './Advancement'\nimport { Biome } from './Biome'\nimport { Dimension } from './Dimension'\nimport { Feature } from './Feature'\n\nexport const Fixes21w44a = Fix.version('1.17.1', '21w44a', Fix.groupProblems(\n\tFix.debug('21w44a fixes'),\n\tFix.when('predicates', Advancement),\n\tFix.when('worldgen',\n\t\tDimension,\n\t\tFeature,\n\t\tBiome,\n\t),\n\tFix.packFormat(8),\n))\n","import type { Fix } from '../Fix'\nimport { categories } from '../Pack'\n\nexport const ParseErrors: Fix = async (pack, ctx) => {\n\tcategories.forEach(category => {\n\t\tpack.data[category].filter(file => file.error).forEach(file => {\n\t\t\tctx.warn(`!${file.error}`)\n\t\t})\n\t})\n}\n","import { Fix } from '../Fix'\nimport { Fixes17 } from './1.17'\nimport { Fixes18 } from './1.18'\nimport { Fixes182 } from './1.18.2'\nimport { Fixes19 } from './1.19'\nimport { Fixes21w44a } from './21w44a'\nimport { ParseErrors } from './ParseErrors'\n\nexport const Fixes = Fix.all(\n\tParseErrors,\n\tFixes17,\n\tFixes21w44a,\n\tFixes18,\n\tFixes182,\n\tFixes19,\n)\n","import detectIndent from 'detect-indent'\nimport type { JSZipObject } from 'jszip'\nimport JSZip from 'jszip'\nimport stripJsonComments from 'strip-json-comments'\nimport type { FixConfig, FixContext } from './Fix'\nimport { Fixes } from './fixes'\nimport type { Version } from './Version'\n\nexport const categories = [\n\t'advancements',\n\t'dimension',\n\t'dimension_type',\n\t'loot_tables',\n\t'predicates',\n\t'tags/blocks',\n\t'tags/entity_types',\n\t'tags/fluids',\n\t'tags/game_events',\n\t'tags/items',\n\t'tags/worldgen/biome',\n\t'tags/worldgen/configured_structure_feature',\n\t'tags/worldgen/flat_level_generator_preset',\n\t'tags/worldgen/structure',\n\t'tags/worldgen/world_preset',\n\t'worldgen/biome',\n\t'worldgen/configured_carver',\n\t'worldgen/configured_feature',\n\t'worldgen/configured_structure_feature',\n\t'worldgen/configured_surface_builder',\n\t'worldgen/density_function',\n\t'worldgen/noise_settings',\n\t'worldgen/noise',\n\t'worldgen/placed_feature',\n\t'worldgen/processor_list',\n\t'worldgen/structure',\n\t'worldgen/structure_set',\n\t'worldgen/template_pool',\n] as const\n\nexport type PackFile = {\n\tname: string,\n\tdata: any,\n\tindent?: string,\n\terror?: string,\n\tdeleted?: boolean,\n}\n\nexport type PackStatus = 'loaded' | 'upgrading' | 'upgraded' | 'writing' | 'done' | 'error'\n\nexport type PackError = {\n\tmessage: string,\n\tfiles: string[],\n}\n\nexport type Pack = {\n\tid: string,\n\tname: string,\n\troot: JSZip,\n\tstatus: PackStatus,\n\tmeta: PackFile,\n\tdata: {\n\t\t[category: string]: PackFile[],\n\t},\n}\n\nexport namespace Pack {\n\texport async function fromZip(file: File): Promise<Pack[]> {\n\t\tconst buffer = await file.arrayBuffer()\n\t\tconst zip = await JSZip.loadAsync(buffer)\n\n\t\tconst metaFiles = zip.filter(path => path.endsWith('pack.mcmeta') && !path.startsWith('__MACOSX/'))\n\t\tif (metaFiles.length === 0) {\n\t\t\tthrow new Error('Cannot find any \"pack.mcmeta\" files.')\n\t\t}\n\t\treturn Promise.all(metaFiles.map(metaFile => {\n\t\t\tconst rootPath = metaFile.name.replace(/\\/?pack.mcmeta$/, '')\n\t\t\tconst name = rootPath.length === 0\n\t\t\t\t? file.name.replace(/\\.zip$/, '')\n\t\t\t\t: rootPath.split('/').pop()!\n\t\t\treturn loadPack(name, zip.folder(rootPath)!)\n\t\t}))\n\t}\n\n\tasync function loadPack(name: string, root: JSZip): Promise<Pack> {\n\t\tconst pack: Pack = {\n\t\t\tid: hexId(),\n\t\t\tname: name,\n\t\t\troot,\n\t\t\tstatus: 'loaded',\n\t\t\tdata: {},\n\t\t\tmeta: {\n\t\t\t\tname: 'pack',\n\t\t\t\t...await loadJson(root.file('pack.mcmeta')!),\n\t\t\t},\n\t\t}\n\t\tawait Promise.all(categories.map(async category => {\n\t\t\tpack.data[category] = await loadCategory(root.folder('data')!, category)\n\t\t}))\n\t\tpack.data.functions = await loadFunctions(root.folder('data')!)\n\t\tconsole.log(pack)\n\t\treturn pack\n\t}\n\n\tasync function loadCategory(root: JSZip, category: string): Promise<PackFile[]> {\n\t\tconst matcher = new RegExp(`^([^\\/]+)\\/${category}\\/(.*)\\.json$`)\n\t\tconst files: { name: string, file: JSZipObject }[] = []\n\t\troot.forEach((path, file) => {\n\t\t\tconst match = path.match(matcher)\n\t\t\tif (match && match[1] && match[2]) {\n\t\t\t\tfiles.push({ name: `${match[1]}:${match[2]}`, file })\n\t\t\t}\n\t\t})\n\t\treturn Promise.all(files.map(async ({ name, file }) => {\n\t\t\ttry {\n\t\t\t\tconst data = await loadJson(file)\n\t\t\t\treturn { name, ...data }\n\t\t\t} catch (e: any) {\n\t\t\t\treturn { name, data: undefined, error: e.message }\n\t\t\t}\n\t\t}))\n\t}\n\n\tasync function loadJson(file: JSZipObject) {\n\t\tlet text = await loadText(file)\n\t\tconst indent = detectIndent(text).indent\n\t\ttry {\n\t\t\ttext = text.replaceAll('\\u200B', '').replaceAll('\\u200C', '').replaceAll('\\u200D', '').replaceAll('\\uFEFF', '')\n\t\t\ttext = text.split('\\n').map(l => l.replace(/^([^\"\\/]+)\\/\\/.*/, '$1')).join('\\n')\n\t\t\treturn { data: JSON.parse(stripJsonComments(text)), indent }\n\t\t} catch (e: any) {\n\t\t\tthrow new Error(`Cannot parse file \"${file.name}\": ${e.message}.`)\n\t\t}\n\t}\n\n\tasync function loadFunctions(root: JSZip): Promise<PackFile[]> {\n\t\tconst matcher = /([^\\/]+)\\/functions\\/(.*)\\.mcfunction$/\n\t\treturn Promise.all(root.filter((path) => path.match(matcher) !== null)\n\t\t\t.map(async file => {\n\t\t\t\tconst m = file.name.match(matcher)\n\t\t\t\treturn {\n\t\t\t\t\tname: `${m![1]}:${m![2]}`,\n\t\t\t\t\tdata: (await loadText(file)).split('\\n'),\n\t\t\t\t}\n\t\t\t})\n\t\t)\n\t}\n\n\tasync function loadText(file: JSZipObject) {\n\t\treturn await file.async('text')\n\t}\n\n\texport async function toZip(pack: Pack) {\n\t\tif (pack.status !== 'upgraded') {\n\t\t\tthrow new Error(`Cannot download pack with status ${pack.status}.`)\n\t\t}\n\t\tcategories.forEach(category => {\n\t\t\twriteCategory(pack.root.folder('data')!, category, pack.data[category] ?? [])\n\t\t})\n\t\twriteFunctions(pack.root.folder('data')!, pack.data.functions ?? [])\n\t\twriteJson(pack.root, 'pack.mcmeta', pack.meta.data, pack.meta.indent)\n\t\tconst blob = await pack.root.generateAsync({ type: 'blob', compression: 'DEFLATE' })\n\t\tconst url = URL.createObjectURL(blob)\n\t\tpack.status = 'done'\n\t\treturn url\n\t}\n\n\tfunction writeCategory(root: JSZip, category: string, data: PackFile[]) {\n\t\tdata.forEach(({ name, data, indent, error, deleted }) => {\n\t\t\tconst [namespace, id] = name.split(':')\n\t\t\tconst path = `${namespace}/${category}/${id}.json`\n\t\t\tif (deleted) {\n\t\t\t\troot.remove(path)\n\t\t\t} else if (!error) {\n\t\t\t\twriteJson(root, path, data, indent)\n\t\t\t}\n\t\t})\n\t}\n\n\tfunction writeFunctions(root: JSZip, functions: PackFile[]) {\n\t\tfunctions.forEach(({ name, data, error, deleted }) => {\n\t\t\tconst [namespace, id] = name.split(':')\n\t\t\tconst path = `${namespace}/functions/${id}.mcfunction`\n\t\t\tif (deleted) {\n\t\t\t\troot.remove(path)\n\t\t\t} else if (!error) {\n\t\t\t\twriteText(root, path, data.join('\\n'))\n\t\t\t}\n\t\t})\n\t}\n\n\tfunction writeJson(zip: JSZip, path: string, data: any, indent?: string) {\n\t\tconst text = JSON.stringify(data, null, indent) + '\\n'\n\t\twriteText(zip, path, text)\n\t}\n\n\tfunction writeText(zip: JSZip, path: string, data: any) {\n\t\tzip.file(path, data)\n\t}\n\n\texport async function upgrade(pack: Pack, config: UpgradeConfig) {\n\t\tif (pack.status !== 'loaded') {\n\t\t\tthrow new Error(`Cannot upgrade pack with status '${pack.status}'.`)\n\t\t}\n\t\tconst ctx: FixContext = {\n\t\t\twarn: config.onWarning,\n\t\t\tprompt: config.onPrompt,\n\t\t\tsource: () => config.source,\n\t\t\ttarget: () => config.target,\n\t\t\tconfig: (key: keyof FixConfig) => config.features[key],\n\t\t\tread: (category: string, name: string) => {\n\t\t\t\treturn pack.data[category].find(f =>\n\t\t\t\t\tf.error === undefined &&\n\t\t\t\t\tf.name.replace(/^minecraft:/, '') === name.replace(/^minecraft:/, ''))\n\t\t\t},\n\t\t\tcreate: (category: string, name: string, data: any) => {\n\t\t\t\tpack.data[category].push({\n\t\t\t\t\tname: name,\n\t\t\t\t\tindent: pack.meta.indent,\n\t\t\t\t\tdata,\n\t\t\t\t})\n\t\t\t},\n\t\t}\n\t\tawait Fixes(pack, ctx)\n\t\tpack.status = 'upgraded'\n\t}\n}\n\ntype UpgradeConfig = {\n\tfeatures: FixConfig,\n\tsource: Version,\n\ttarget: Version,\n\tonPrompt: FixContext['prompt'],\n\tonWarning: (message: string, files?: string[]) => unknown,\n}\n\nconst dec2hex = (dec: number) => ('0' + dec.toString(16)).substr(-2)\n\nexport function hexId(length = 12) {\n\tvar arr = new Uint8Array(length / 2)\n\twindow.crypto.getRandomValues(arr)\n\treturn Array.from(arr, dec2hex).join('')\n}\n\nexport function MockPack(): Pack {\n\tconst id = hexId()\n\treturn {\n\t\tid,\n\t\tname: `Pack${id}`,\n\t\troot: new JSZip(),\n\t\tstatus: 'loaded',\n\t\tmeta: {\n\t\t\tname: 'pack.mcmeta',\n\t\t\tdata: { pack: { pack_format: 8, description: '' } },\n\t\t},\n\t\tdata: {\n\t\t\t'worldgen/biome': [\n\t\t\t\t{\n\t\t\t\t\tname: 'test:plains',\n\t\t\t\t\tdata: { features: [ ['red'] ] },\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tname: 'test:desert',\n\t\t\t\t\tdata: { features: [ ['black', 'red', 'yellow', 'green'] ] },\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tname: 'test:jungle',\n\t\t\t\t\tdata: { features: [ ['green', 'yellow', 'red'] ] },\n\t\t\t\t},\n\t\t\t],\n\t\t},\n\t}\n}\n","import { useEffect, useRef, useState } from 'preact/hooks'\nimport type { FixConfig } from '../Fix'\nimport { Pack } from '../Pack'\nimport type { Version } from '../Version'\nimport { Octicon } from './Octicon'\n\ntype AlertData = {\n\tmessage: string,\n\tfiles?: string[],\n\tinfo?: string[],\n}\n\ntype PromptData = {\n\ttitle: string,\n\tmessage?: string,\n\tactions: string[],\n\tinfo?: string[],\n}\n\ntype PackCardProps = {\n\tpack: Pack,\n\tconfig: FixConfig,\n\tsource: Version,\n\ttarget: Version,\n\tdoDownload: number,\n\tonError: (error: Error) => unknown,\n\tonRemove: () => unknown,\n\tonDone: () => unknown,\n}\nexport function PackCard({ pack, config, source, target, onError, onRemove, onDone, doDownload }: PackCardProps) {\n\tconst [status, setStatus] = useState('Loading...')\n\tconst [download, setDownload] = useState<string | null>(null)\n\tconst [alerts, setAlerts] = useState<AlertData[]>([])\n\tconst [error, setError] = useState<string | null>(null)\n\tconst [alertsHidden, setAlertsHidden] = useState(false)\n\tconst [prompt, setPrompt] = useState<PromptData | null>(null)\n\tconst downloadRef = useRef<HTMLAnchorElement>(null)\n\tconst promptDone = useRef<(value: string) => void>(() => {})\n\n\tconst downloadName = `${pack.name}_${target}.zip`\n\n\tconst onPrompt = (title: string, message?: string, actions?: string[], info?: string[]) => {\n\t\tsetPrompt({ title, message, actions: actions ?? ['Confirm'], info })\n\t\treturn new Promise<string>((res) => {\n\t\t\tpromptDone.current = (value) => {\n\t\t\t\tsetPrompt(null)\n\t\t\t\tres(value)\n\t\t\t}\n\t\t})\n\t}\n\n\tconst onWarning = (message: string, files?: string[], info?: string[]) => {\n\t\tsetTimeout(() => setAlerts(alerts => [...alerts, { message, files, info }]))\n\t}\n\n\tuseEffect(() => {\n\t\t(async () => {\n\t\t\ttry {\n\t\t\t\tsetStatus('Upgrading...')\n\t\t\t\tawait Pack.upgrade(pack, { features: config, source, target, onPrompt, onWarning })\n\t\t\t\tsetStatus('Zipping...')\n\t\t\t\tconst download = await Pack.toZip(pack)\n\t\t\t\tsetDownload(download)\n\t\t\t\tonDone()\n\t\t\t} catch (e: any) {\n\t\t\t\tonError(e)\n\t\t\t\tsetError('Error during upgrading')\n\t\t\t}\n\t\t})()\n\t}, [pack])\n\n\tconst toggleAlerts = () => {\n\t\tsetAlertsHidden(!alertsHidden)\n\t}\n\n\tuseEffect(() => {\n\t\tif (doDownload) {\n\t\t\tdownloadRef.current.click()\n\t\t}\n\t}, [doDownload])\n\n\treturn <div class=\"pack\">\n\t\t<div class=\"pack-head\">\n\t\t\t{download && <a class=\"pack-status download\" ref={downloadRef} href={download} download={downloadName} data-hover={`Download data pack for ${target}`}>\n\t\t\t\t{Octicon.download}\n\t\t\t</a>}\n\t\t\t{(!download && !error && !prompt) && <div class=\"pack-status loading\" data-hover={status}>\n\t\t\t\t{Octicon.sync}\n\t\t\t</div>}\n\t\t\t{!download && !error && prompt && <div class=\"pack-status prompt\" data-hover=\"Manual action required\">\n\t\t\t\t{Octicon.report}\n\t\t\t</div>}\n\t\t\t{(alerts.length > 0 || error) && <div class={`pack-status alert${error ? ' error' : ''}`} onClick={toggleAlerts} data-hover={error ?? 'There were issues upgrading'}>\n\t\t\t\t{Octicon.alert}\n\t\t\t</div>}\n\t\t\t<span class=\"pack-name\">{pack.name.replace(/\\.zip$/, '')}</span>\n\t\t\t<div class=\"pack-status remove\" onClick={onRemove}>\n\t\t\t\t{Octicon.x}\n\t\t\t</div>\n\t\t</div>\n\t\t{(prompt || (alerts.length > 0 && !alertsHidden)) && <div class=\"pack-body\">\n\t\t\t{prompt && <div class=\"pack-prompt\">\n\t\t\t\t<p class=\"prompt-title\">{prompt.title}</p>\n\t\t\t\t{prompt.message && <p class=\"prompt-message\">{prompt.message}</p>}\n\t\t\t\t<p>\n\t\t\t\t\t{prompt.actions.map(action => (\n\t\t\t\t\t\t<button onClick={() => promptDone.current(action)}>{action}</button>\n\t\t\t\t\t))}\n\t\t\t\t</p>\n\t\t\t\t{prompt.info?.map(line => <p class=\"prompt-info\">{line}</p>)}\n\t\t\t</div>}\n\t\t\t{(alerts.length > 0 && !alertsHidden) && alerts.map(({ message, files, info }) => <div class=\"pack-alert\">\n\t\t\t\t<div class={`alert-message ${message.startsWith('!') ? 'alert-error' : ''}`}>{message.replace(/\\!/, '')}</div>\n\t\t\t\t{files && files.length > 0 && <>\n\t\t\t\t\t<p>Affected files:</p>\n\t\t\t\t\t<div class=\"alert-files\">{files.map(file => <p>{file}</p>)}</div>\n\t\t\t\t</>}\n\t\t\t\t{info?.map(line => <p class=\"alert-info\">{line}</p>)}\n\t\t\t</div>)}\n\t\t</div>}\n\t</div>\n}\n","import { useRef } from 'preact/hooks'\nimport type { Version } from '../Version'\nimport { Versions } from '../Version'\n\ntype VersionPickerProps = {\n\tvalue: Version,\n\tonChange: (version: Version) => unknown,\n}\nexport function VersionPicker({ value, onChange }: VersionPickerProps) {\n\tconst select = useRef<HTMLSelectElement>(null)\n\tconst change = () => {\n\t\tonChange(select.current.value as Version)\n\t}\n\treturn <select class=\"version-picker\" ref={select} value={value} onChange={change}>\n\t\t{Versions.map(v => <option value={v}>{v}</option>)}\n\t</select>\n}\n","import { Version, Versions } from './Version'\n\ntype Config = {\n\tsource?: string,\n\ttarget?: string,\n}\n\nexport namespace Store {\n\tconst KEY = 'misode_upgrader_config'\n\n\tfunction get(): Config {\n\t\treturn JSON.parse(localStorage.getItem(KEY) ?? '{}')\n\t}\n\n\tfunction set(config: Partial<Config>) {\n\t\tconst data = { ...get(), ...config }\n\t\tlocalStorage.setItem(KEY, JSON.stringify(data))\n\t}\n\n\texport function getSource(): Version {\n\t\tconst sourceOverride = new URLSearchParams(location.search).get('from')\n\t\tif (sourceOverride && Versions.includes(sourceOverride as Version)) {\n\t\t\treturn sourceOverride as Version\n\t\t}\n\t\tconst source = get().source\n\t\tif (source && Versions.includes(source as Version)) {\n\t\t\treturn source as Version\n\t\t}\n\t\treturn Version.DEFAULT_SOURCE\n\t}\n\n\texport function setSource(source: Version) {\n\t\tset({ source })\n\t}\n\n\texport function getTarget(): Version {\n\t\tconst targetOverride = new URLSearchParams(location.search).get('to')\n\t\tif (targetOverride && Versions.includes(targetOverride as Version)) {\n\t\t\treturn targetOverride as Version\n\t\t}\n\t\tconst target = get().target\n\t\tif (target && Versions.includes(target as Version)) {\n\t\t\treturn target as Version\n\t\t}\n\t\treturn Version.DEFAULT_TARGET\n\t}\n\n\texport function setTarget(target: Version) {\n\t\tset({ target })\n\t}\n}\n","import { useState } from 'preact/hooks'\nimport { mapStackTrace } from 'sourcemapped-stacktrace'\nimport { Config } from './components/Config'\nimport { Octicon } from './components/Octicon'\nimport { PackCard } from './components/PackCard'\nimport { VersionPicker } from './components/VersionPicker'\nimport type { FixConfig } from './Fix'\nimport { hexId, Pack } from './Pack'\nimport { Store } from './Store'\nimport { Version } from './Version'\n\nexport type AppError = {\n\tid: string,\n\tprocess: 'loading' | 'upgrading',\n\terror: Error,\n\tstacktrace?: string,\n}\n\nexport function App() {\n\tconst [packs, setPacks] = useState<Pack[]>([])\n\tconst [errors, setErrors] = useState<AppError[]>([])\n\tconst [source, setSource] = useState<Version>(Store.getSource())\n\tconst [target, setTarget] = useState<Version>(Store.getTarget())\n\tconst [config, setConfig] = useState<FixConfig>({\n\t\tfunctions: true,\n\t\tids: true,\n\t\tpredicates: true,\n\t\tworldgen: true,\n\t\tpackFormat: true,\n\t\tfeatureCycles: true,\n\t})\n\tconst changeSource = (source: Version) => {\n\t\tStore.setSource(source)\n\t\tsetSource(source)\n\t}\n\tconst changeTarget = (target: Version) => {\n\t\tStore.setTarget(target)\n\t\tsetTarget(target)\n\t}\n\n\tconst addError = (process: 'loading' | 'upgrading', error: Error) => {\n\t\tconst id = hexId()\n\t\tconst stack = error.stack!.split('\\n').map(line => {\n\t\t\treturn line.replace(/^(\\s+)at (?:async )?(https?:.*)/, '$1at ($2)')\n\t\t})\n\t\tmapStackTrace(stack.join('\\n'), (mapped) => {\n\t\t\tconst stacktrace = stack[0] + '\\n' + mapped.map(line => {\n\t\t\t\treturn line.replace(/..\\/..\\/src\\//, 'src/')\n\t\t\t}).join('\\n')\n\t\t\tsetErrors(errors => errors.map(e => e.id === id ? { ...e, stacktrace } : e))\n\t\t})\n\t\tsetErrors([...errors, { id, process, error }])\n\t}\n\n\tconst onDrop = async (e: DragEvent) => {\n\t\te.preventDefault()\n\t\tif(!e.dataTransfer) return\n\n\t\tconst promises = []\n\t\tfor (let i = 0; i < e.dataTransfer.files.length; i++) {\n\t\t\tconst file = e.dataTransfer.files[i]\n\t\t\tif (file.type.match(/^application\\/(x-)?zip(-compressed)?$/)) {\n\t\t\t\tpromises.push(Pack.fromZip(file))\n\t\t\t}\n\t\t}\n\t\tif (promises.length === 0) {\n\t\t\taddError('loading', new Error('The dropped files contain no zip files. Please zip the data pack first.'))\n\t\t} else {\n\t\t\tconst newPacks = await Promise.all(promises.map(async promise => {\n\t\t\t\ttry {\n\t\t\t\t\treturn await promise\n\t\t\t\t} catch (error: any) {\n\t\t\t\t\taddError('loading', error)\n\t\t\t\t\tconsole.error(error)\n\t\t\t\t\treturn\n\t\t\t\t}\n\t\t\t}))\n\t\t\tsetPacks([...packs, ...newPacks.flat().filter((p): p is Pack => p !== undefined)])\n\t\t}\n\t}\n\n\tconst onUpgradeError = (error: Error) => {\n\t\tconsole.error(error)\n\t\taddError('upgrading', error)\n\t}\n\n\tconst removePack = (id: string) => {\n\t\tsetPacks(packs => packs.filter(p => p.id !== id))\n\t}\n\n\tconst [doDownload, setDownload] = useState(0)\n\n\treturn <main onDrop={onDrop} onDragOver={e => e.preventDefault()}>\n\t\t{packs.length > 0 && <>\n\t\t\t<div class=\"packs\">\n\t\t\t\t{packs.map(pack => <PackCard key={pack.id} {...{pack, config, source, target, doDownload}} onError={onUpgradeError} onRemove={() => removePack(pack.id)} onDone={() => setPacks([...packs])} />)}\n\t\t\t\t{packs.filter(p => p.status === 'done').length > 1 &&\n\t\t\t\t\t<button class=\"download-all\" onClick={() => setDownload(doDownload + 1)}>\n\t\t\t\t\t\t{Octicon.download}\n\t\t\t\t\t\t<span>Download all</span>\n\t\t\t\t\t</button>}\n\t\t\t</div>\n\t\t</>}\n\t\t<div class=\"drop\">\n\t\t\t<h1>Drop data pack here</h1>\n\t\t\t<p>Convert from <VersionPicker value={source} onChange={changeSource}/> to <VersionPicker value={target} onChange={changeTarget}/></p>\n\t\t\t{Version.order(target, source)\n\t\t\t\t? <p class=\"error-message\">Invalid version range</p>\n\t\t\t\t: Version.isWorkInProgress(source, target)\n\t\t\t\t\t? <p class=\"warning-message\">This upgrade is still being worked on</p>\n\t\t\t\t\t: null}\n\t\t</div>\n\t\t<div class=\"configs\">\n\t\t\t<Config name=\"Upgrade functions\" value={config.functions} onChange={v => setConfig({ ...config, functions: v })} />\n\t\t\t<Config name=\"Upgrade IDs\" value={config.ids} onChange={v => setConfig({ ...config, ids: v })} />\n\t\t\t<Config name=\"Upgrade JSON files\" value={config.predicates} onChange={v => setConfig({ ...config, predicates: v })} />\n\t\t\t<Config name=\"Upgrade worldgen\" value={config.worldgen} onChange={v => setConfig({ ...config, worldgen: v })} />\n\t\t\t<Config name=\"Upgrade pack_format\" value={config.packFormat} onChange={v => setConfig({ ...config, packFormat: v })} />\n\t\t\t<Config name=\"Detect feature cycles\" value={config.featureCycles} onChange={v => setConfig({ ...config, featureCycles: v })} />\n\t\t</div>\n\t\t<div class=\"footer\">\n\t\t\t<p>Developed by Misode</p>\n\t\t\t<p>Source code on <a href=\"https://github.com/misode/upgrader\" target=\"_blank\">GitHub</a></p>\n\t\t\t<p class=\"donate\">\n\t\t\t\t{Octicon.heart}\n\t\t\t\t<a href=\"https://ko-fi.com/misode\" target=\"_blank\">Donate</a>\n\t\t\t</p>\n\t\t</div>\n\t\t<div class=\"main-errors\">\n\t\t\t{errors.map(e => {\n\t\t\t\tconst title = `${e.error.name}: ${e.error.message}`\n\t\t\t\tconst body = `An error occurred while ${e.process} a data pack.\\nData Pack: <!-- ATTACH YOUR DATAPACK HERE -->\\n\\n\\`\\`\\`\\n${e.stacktrace ?? e.error.stack}\\n\\`\\`\\`\\n`\n\t\t\t\tconst url = `https://github.com/misode/upgrader/issues/new?title=${encodeURIComponent(title)}&body=${encodeURIComponent(body)}\\n`\n\t\t\t\treturn <div class=\"main-error\">\n\t\t\t\t\t<p>Something went wrong {e.process} the data pack:</p>\n\t\t\t\t\t<p class=\"error-message\">{e.error.message}</p>\n\t\t\t\t\t<p>You can report this as a bug <a href={url} target=\"_blank\">on GitHub</a> and upload the data pack</p>\n\t\t\t\t\t<div class=\"error-close\" onClick={() => setErrors(errors.filter(f => f.id !== e.id))}>{Octicon.x}</div>\n\t\t\t\t</div>})}\n\t\t</div>\n\t</main>\n}\n","import { render } from 'preact'\nimport { App } from './App'\nimport './style.css'\n\nrender(<App/>, document.body)\n"],"names":["Carver","fixCarver","DimensionType","fixDimensionType","Feature","fixFeature","Function","NoiseSettings","fixNoiseSettings","Predicates","fixCondition","fixCriterion","fixPool","fixEntity","fixEntry","StructureFeature","fixStructureFeature","fixDecorator","fixSurfaceRule","Dimension","fixGenerator","fixConfiguredFeature","fixPlacedFeature","Biome","fixBiome","getBlockIds","mergePlayerLocation","useState","useRef","render"],"mappings":"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"}