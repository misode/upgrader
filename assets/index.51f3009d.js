import{a as e,J as a,l as n,y as t,b as r,N as o}from"./vendor.ff4f6c89.js";const i={alert:e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:"16",height:"16"},e("path",{"fill-rule":"evenodd",d:"M8.22 1.754a.25.25 0 00-.44 0L1.698 13.132a.25.25 0 00.22.368h12.164a.25.25 0 00.22-.368L8.22 1.754zm-1.763-.707c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0114.082 15H1.918a1.75 1.75 0 01-1.543-2.575L6.457 1.047zM9 11a1 1 0 11-2 0 1 1 0 012 0zm-.25-5.25a.75.75 0 00-1.5 0v2.5a.75.75 0 001.5 0v-2.5z"})),download:e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:"16",height:"16"},e("path",{"fill-rule":"evenodd",d:"M7.47 10.78a.75.75 0 001.06 0l3.75-3.75a.75.75 0 00-1.06-1.06L8.75 8.44V1.75a.75.75 0 00-1.5 0v6.69L4.78 5.97a.75.75 0 00-1.06 1.06l3.75 3.75zM3.75 13a.75.75 0 000 1.5h8.5a.75.75 0 000-1.5h-8.5z"})),sync:e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:"16",height:"16"},e("path",{"fill-rule":"evenodd",d:"M8 2.5a5.487 5.487 0 00-4.131 1.869l1.204 1.204A.25.25 0 014.896 6H1.25A.25.25 0 011 5.75V2.104a.25.25 0 01.427-.177l1.38 1.38A7.001 7.001 0 0114.95 7.16a.75.75 0 11-1.49.178A5.501 5.501 0 008 2.5zM1.705 8.005a.75.75 0 01.834.656 5.501 5.501 0 009.592 2.97l-1.204-1.204a.25.25 0 01.177-.427h3.646a.25.25 0 01.25.25v3.646a.25.25 0 01-.427.177l-1.38-1.38A7.001 7.001 0 011.05 8.84a.75.75 0 01.656-.834z"})),x:e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:"16",height:"16"},e("path",{"fill-rule":"evenodd",d:"M3.72 3.72a.75.75 0 011.06 0L8 6.94l3.22-3.22a.75.75 0 111.06 1.06L9.06 8l3.22 3.22a.75.75 0 11-1.06 1.06L8 9.06l-3.22 3.22a.75.75 0 01-1.06-1.06L6.94 8 3.72 4.78a.75.75 0 010-1.06z"}))};var l,s;(s=l||(l={})).all=function(e){return a=>{e.forEach((e=>e(a)))}},s.onFile=function(e,a){return n=>{for(const[t,r]of Object.entries(n.data[e]))a(r)}};const c=l.all([l.onFile("worldgen/configured_carver",u),l.onFile("worldgen/biome",(e=>{var a,n;"object"==typeof e.carvers&&(null==(a=e.carvers.air)||a.forEach(u),null==(n=e.carvers.liquid)||n.forEach(u))}))]);function u(e){if("object"!=typeof e)return;const a=e.type.replace(/^minecraft:/,"");e.config.lava_level={above_bottom:10},e.config.aquifers_enabled=!1,"cave"===a||"underwater_cave"===a||"nether_cave"===a?(e.config.y="nether_cave"===a?{type:"minecraft:uniform",min_inclusive:{absolute:0},max_inclusive:{below_top:1}}:{type:"minecraft:biased_to_bottom",min_inclusive:{absolute:0},max_inclusive:{absolute:127},inner:8},e.config.yScale=.5,e.config.horizontal_radius_multiplier=1,e.config.vertical_radius_multiplier=1,e.config.floor_level=-.7):(e.config.y={type:"minecraft:biased_to_bottom",min_inclusive:{absolute:20},max_inclusive:{absolute:67},inner:8},e.config.yScale=3,"canyon"===a&&(e.config.vertical_rotation={type:"minecraft:uniform",value:{min_inclusive:-.125,max_exclusive:.125}},e.config.shape={distance_factor:{type:"minecraft:uniform",value:{min_inclusive:.75,max_exclusive:1}},thickness:{type:"minecraft:trapezoid",value:{min:0,max:6,plateau:2}},width_smoothness:3,horizontal_radius_factor:{type:"minecraft:uniform",value:{min_inclusive:.75,max_exclusive:1}},vertical_radius_default_factor:1,vertical_radius_center_factor:0}))}function d(e){e.min_y=0,e.height=256}function f(e){"object"==typeof e&&(e.min_surface_level=0,e.noise_caves_enabled=!1,e.noodle_caves_enabled=!1,e.aquifers_enabled=!1,e.deepslate_enabled=!1,e.ore_veins_enabled=!1,e.noise.min_y=0)}function p(e){if("object"!=typeof e)return;"nether_fossil"===e.type.replace(/^minecraft:/,"")&&(e.config||(e.config={}),e.config.height={type:"minecraft:uniform",min_inclusive:{absolute:32},max_inclusive:{below_top:2}})}const m=[l.all([l.onFile("dimension_type",d),l.onFile("dimension",(e=>{"object"==typeof e.type&&d(e.type)}))]),l.all([l.onFile("worldgen/noise_settings",f),l.onFile("dimension",(e=>{var a,n;"noise"===(null==(n=null==(a=e.generator)?void 0:a.type)?void 0:n.replace(/^minecraft:/,""))&&f(e.generator.settings)}))]),l.all([l.onFile("worldgen/configured_structure_feature",p),l.onFile("worldgen/biome",(e=>{Array.isArray(e.starts)&&e.starts.forEach(p)}))]),c,e=>{e.meta.pack.pack_format=7}],g=["dimension","dimension_type","worldgen/biome","worldgen/configured_carver","worldgen/configured_feature","worldgen/configured_structure_feature","worldgen/configured_surface_builder","worldgen/noise_settings","worldgen/processor_list","worldgen/template_pool"];var v;function _({pack:a,onError:r}){const[o,l]=n(null),[s,c]=n(null),u=`${a.name.replace(/\.zip$/,"")}_1_17.zip`;return t((()=>{(async()=>{try{await v.upgrade(a);const e=await v.toZip(a);l(e)}catch(e){r(e),c(["Error during upgrading"])}})()}),[a]),e("div",{class:"pack"},o&&e("a",{class:"pack-status download",href:o,download:u},i.download),s&&e("div",{class:"pack-status alert"},i.alert),!o&&!s&&e("div",{class:"pack-status loading"},i.sync),e("span",null,a.name.replace(/\.zip$/,"")))}function h(){const[a,t]=n([]),[o,l]=n([]),s=e=>{l([...o,{process:"upgrading",error:e}])};return e("main",{onDrop:async e=>{if(e.preventDefault(),!e.dataTransfer)return;const n=[];for(let a=0;a<e.dataTransfer.files.length;a++){const t=e.dataTransfer.files[a];t.type.match(/^application\/(x-)?zip(-compressed)?$/)&&n.push(v.fromZip(t))}if(n.length>0){const e=await Promise.all(n.map((async e=>{try{return await e}catch(a){return l([...o,{process:"loading",error:a}]),void console.error(a)}})));t([...a,...e.filter((e=>void 0!==e))])}},onDragOver:e=>e.preventDefault()},0===a.length?e(r,null,e("div",{class:"drop"},e("h1",null,"Drop data pack here"),e("p",null,"Converts from 1.16.5 to 1.17"))):e(r,null,e("div",{class:"packs"},a.map((a=>e(_,{pack:a,onError:s})))),e("div",{class:"footer"},e("p",null,"Developed by Misode"),e("p",null,"Source code on ",e("a",{href:"https://github.com/misode/upgrader",target:"_blank"},"GitHub")))),o.map((a=>{const n=`${a.error.name}: ${a.error.message}`,t=`An error occurred while ${a.process} a data pack.\nData Pack: \x3c!-- ATTACH YOUR DATAPACK HERE --\x3e\n\n\`\`\`\n${a.error.stack}\n\`\`\`\n`,r=`https://github.com/misode/upgrader/issues/new?title=${encodeURIComponent(n)}&body=${encodeURIComponent(t)}\n`;return e("div",{class:"error"},e("p",null,"Something went wrong ",a.process," the data pack:"),e("p",{class:"error-message"},a.error.message),e("p",null,"You can report this as a bug ",e("a",{href:r,target:"_blank"},"on GitHub")," and upload the data pack"),e("div",{class:"error-close",onClick:()=>l(o.filter((e=>e.error.message!==a.error.message||e.process!==a.process)))},i.x))})))}!function(e){async function n(e,a){const n=e.files[a];if(!n)throw new Error(`Cannot find "${a}"`);const t=await n.async("text");return JSON.parse(t)}function t(e,a,n){const t=JSON.stringify(n,null,2)+"\n";e.file(a,t)}e.fromZip=async function(e){const t=await e.arrayBuffer(),r=await a.loadAsync(t),o={name:e.name,data:{}};return await Promise.all(g.map((async e=>{o.data[e]=await async function(e,a){const t=new RegExp(`^data/([^/]+)/${a}/(.*).json$`);return Object.fromEntries(await Promise.all(Object.keys(e.files).map((e=>e.match(t))).filter((e=>e)).map((async a=>[`${a[1]}:${a[2]}`,await n(e,a[0])]))))}(r,e)}))),o.meta=await n(r,"pack.mcmeta"),o},e.toZip=async function(e){const n=new a;g.forEach((a=>{!function(e,a,n){Object.entries(n).forEach((([n,r])=>{const[o,i]=n.split(":");t(e,`data/${o}/${a}/${i}.json`,r)}))}(n,a,e.data[a])})),t(n,"pack.mcmeta",e.meta);const r=await n.generateAsync({type:"blob"});return URL.createObjectURL(r)},e.upgrade=async function(e){for(const a of m)a(e)}}(v||(v={}));o(e(h,null),document.body);
