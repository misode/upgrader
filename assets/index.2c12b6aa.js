import{a,J as e,l as n,y as r,b as t,N as o}from"./vendor.ff4f6c89.js";const s={alert:a("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:"16",height:"16"},a("path",{"fill-rule":"evenodd",d:"M8.22 1.754a.25.25 0 00-.44 0L1.698 13.132a.25.25 0 00.22.368h12.164a.25.25 0 00.22-.368L8.22 1.754zm-1.763-.707c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0114.082 15H1.918a1.75 1.75 0 01-1.543-2.575L6.457 1.047zM9 11a1 1 0 11-2 0 1 1 0 012 0zm-.25-5.25a.75.75 0 00-1.5 0v2.5a.75.75 0 001.5 0v-2.5z"})),download:a("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:"16",height:"16"},a("path",{"fill-rule":"evenodd",d:"M7.47 10.78a.75.75 0 001.06 0l3.75-3.75a.75.75 0 00-1.06-1.06L8.75 8.44V1.75a.75.75 0 00-1.5 0v6.69L4.78 5.97a.75.75 0 00-1.06 1.06l3.75 3.75zM3.75 13a.75.75 0 000 1.5h8.5a.75.75 0 000-1.5h-8.5z"})),sync:a("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:"16",height:"16"},a("path",{"fill-rule":"evenodd",d:"M8 2.5a5.487 5.487 0 00-4.131 1.869l1.204 1.204A.25.25 0 014.896 6H1.25A.25.25 0 011 5.75V2.104a.25.25 0 01.427-.177l1.38 1.38A7.001 7.001 0 0114.95 7.16a.75.75 0 11-1.49.178A5.501 5.501 0 008 2.5zM1.705 8.005a.75.75 0 01.834.656 5.501 5.501 0 009.592 2.97l-1.204-1.204a.25.25 0 01.177-.427h3.646a.25.25 0 01.25.25v3.646a.25.25 0 01-.427.177l-1.38-1.38A7.001 7.001 0 011.05 8.84a.75.75 0 01.656-.834z"})),x:a("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:"16",height:"16"},a("path",{"fill-rule":"evenodd",d:"M3.72 3.72a.75.75 0 011.06 0L8 6.94l3.22-3.22a.75.75 0 111.06 1.06L9.06 8l3.22 3.22a.75.75 0 11-1.06 1.06L8 9.06l-3.22 3.22a.75.75 0 01-1.06-1.06L6.94 8 3.72 4.78a.75.75 0 010-1.06z"}))};var c,i;(i=c||(c={})).all=function(a){return e=>{a.forEach((a=>a(e)))}},i.onFile=function(a,e){return n=>{for(const[r,t]of Object.entries(n.data[a]))e(t)}};function l(a){a.min_y=0,a.height=256}const d=[c.all([c.onFile("dimension_type",l),c.onFile("dimension",(a=>{"object"==typeof a.type&&l(a.type)}))]),a=>{a.meta.pack.pack_format=7}],p=["dimension","dimension_type","worldgen/biome","worldgen/configured_carver","worldgen/configured_feature","worldgen/configured_structure_feature","worldgen/configured_surface_builder","worldgen/noise_settings","worldgen/processor_list","worldgen/template_pool"];var u;function f({pack:e,onError:t}){const[o,c]=n(null),[i,l]=n(null),d=`${e.name.replace(/\.zip$/,"")}_1_17.zip`;return r((()=>{(async()=>{try{await u.upgrade(e);const a=await u.toZip(e);c(a)}catch(a){t(a),l(["Error during upgrading"])}})()}),[e]),a("div",{class:"pack"},o&&a("a",{class:"pack-status download",href:o,download:d},s.download),i&&a("div",{class:"pack-status alert"},s.alert),!o&&!i&&a("div",{class:"pack-status loading"},s.sync),a("span",null,e.name.replace(/\.zip$/,"")))}function g(){const[e,r]=n([]),[o,c]=n([]),i=a=>{c([...o,{process:"upgrading",error:a}])};return a("main",{onDrop:async a=>{if(a.preventDefault(),!a.dataTransfer)return;const n=[];for(let e=0;e<a.dataTransfer.files.length;e++){const r=a.dataTransfer.files[e];r.type.match(/^application\/(x-)?zip(-compressed)?$/)&&n.push(u.fromZip(r))}if(n.length>0){const a=await Promise.all(n.map((async a=>{try{return await a}catch(e){return c([...o,{process:"loading",error:e}]),void console.error(e)}})));r([...e,...a.filter((a=>void 0!==a))])}},onDragOver:a=>a.preventDefault()},0===e.length?a(t,null,a("div",{class:"drop"},a("h1",null,"Drop data pack here"),a("p",null,"Converts from 1.16.5 to 1.17"))):a(t,null,a("div",{class:"packs"},e.map((e=>a(f,{pack:e,onError:i})))),a("div",{class:"footer"},a("p",null,"Developed by Misode"),a("p",null,"Source code on ",a("a",{href:"https://github.com/misode/upgrader",target:"_blank"},"GitHub")))),o.map((e=>{const n=`${e.error.name}: ${e.error.message}`,r=`An error occurred while ${e.process} a data pack.\nData Pack: \x3c!-- ATTACH YOUR DATAPACK HERE --\x3e\n\n\`\`\`\n${e.error.stack}\n\`\`\`\n`,t=`https://github.com/misode/upgrader/issues/new?title=${encodeURIComponent(n)}&body=${encodeURIComponent(r)}\n`;return a("div",{class:"error"},a("p",null,"Something went wrong ",e.process," the data pack:"),a("p",{class:"error-message"},e.error.message),a("p",null,"You can report this as a bug ",a("a",{href:t,target:"_blank"},"on GitHub")," and upload the data pack"),a("div",{class:"error-close",onClick:()=>c(o.filter((a=>a.error.message!==e.error.message||a.process!==e.process)))},s.x))})))}!function(a){async function n(a,e){const n=a.files[e];if(!n)throw new Error(`Cannot find "${e}"`);const r=await n.async("text");return JSON.parse(r)}function r(a,e,n){const r=JSON.stringify(n,null,2)+"\n";a.file(e,r)}a.fromZip=async function(a){const r=await a.arrayBuffer(),t=await e.loadAsync(r),o={name:a.name,data:{}};return await Promise.all(p.map((async a=>{o.data[a]=await async function(a,e){const r=new RegExp(`^data/([^/]+)/${e}/(.*).json$`);return Object.fromEntries(await Promise.all(Object.keys(a.files).map((a=>a.match(r))).filter((a=>a)).map((async e=>[`${e[1]}:${e[2]}`,await n(a,e[0])]))))}(t,a)}))),o.meta=await n(t,"pack.mcmeta"),o},a.toZip=async function(a){const n=new e;p.forEach((e=>{!function(a,e,n){Object.entries(n).forEach((([n,t])=>{const[o,s]=n.split(":");r(a,`data/${o}/${e}/${s}.json`,t)}))}(n,e,a.data[e])})),r(n,"pack.mcmeta",a.meta);const t=await n.generateAsync({type:"blob"});return URL.createObjectURL(t)},a.upgrade=async function(a){for(const e of d)e(a)}}(u||(u={}));o(a(g,null),document.body);
